---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<CenterLayout>
<span class="title">Knowledge Base</span>
<h1>Reference Architecture - Can we use a different primary region per environment?</h1>
<GitHub json={{"id":"D_kwDOF8slf84AO2_z","number":216,"author":{"login":"zackproser"},"title":"Reference Architecture - Can we use a different primary region per environment?","body":"A customer asked: \r\n> We'd like our logs, security and shared accounts to use `us-east-1` as their primary region. However, dev, stage and prod should be deployed in `sa-east-1`. How can we define the different regions for use in different accounts? \r\n\r\n","bodyHTML":"<p dir=\"auto\">A customer asked:</p>\n<blockquote>\n<p dir=\"auto\">We'd like our logs, security and shared accounts to use <code class=\"notranslate\">us-east-1</code> as their primary region. However, dev, stage and prod should be deployed in <code class=\"notranslate\">sa-east-1</code>. How can we define the different regions for use in different accounts?</p>\n</blockquote>","answer":{"body":"Unfortunately, we don’t currently support a mixed region Reference Architecture deployment. We’re able to provide the Ref Arch at a flat fee with a quick turnaround due to our standardization, which means the limited options in the form are the only things we can support in deployment.\r\n\r\nGiven your use case, I recommend deploying the Ref Arch in the us-east-1 region, and then migrating the app setup to sa-east-1 post deploy. \r\n\r\nThe steps to do this are:\r\n\r\n- Copy paste the us-east-1 folder into a new sa-east-1 folder in each of the environments dev, stage, and prod.\r\n- Update the region.hcl file to point to sa-east-1\r\n- Copy all secrets manager entries in us-east-1 into sa-east-1\r\n- Update ARN references to secrets manager entries in the code to point to the newly copied secrets manager entries in sa-east-1.\r\n- Run terragrunt run-all apply in the sa-east-1 folder.\r\n\r\nNote that Gruntwork is happy to help out in support if you run into any issues going through this process.\r\n","bodyHTML":"<p dir=\"auto\">Unfortunately, we don’t currently support a mixed region Reference Architecture deployment. We’re able to provide the Ref Arch at a flat fee with a quick turnaround due to our standardization, which means the limited options in the form are the only things we can support in deployment.</p>\n<p dir=\"auto\">Given your use case, I recommend deploying the Ref Arch in the us-east-1 region, and then migrating the app setup to sa-east-1 post deploy.</p>\n<p dir=\"auto\">The steps to do this are:</p>\n<ul dir=\"auto\">\n<li>Copy paste the us-east-1 folder into a new sa-east-1 folder in each of the environments dev, stage, and prod.</li>\n<li>Update the region.hcl file to point to sa-east-1</li>\n<li>Copy all secrets manager entries in us-east-1 into sa-east-1</li>\n<li>Update ARN references to secrets manager entries in the code to point to the newly copied secrets manager entries in sa-east-1.</li>\n<li>Run terragrunt run-all apply in the sa-east-1 folder.</li>\n</ul>\n<p dir=\"auto\">Note that Gruntwork is happy to help out in support if you run into any issues going through this process.</p>"},"comments":{"edges":[{"node":{"author":{"login":"zackproser"},"body":"Unfortunately, we don’t currently support a mixed region Reference Architecture deployment. We’re able to provide the Ref Arch at a flat fee with a quick turnaround due to our standardization, which means the limited options in the form are the only things we can support in deployment.\r\n\r\nGiven your use case, I recommend deploying the Ref Arch in the us-east-1 region, and then migrating the app setup to sa-east-1 post deploy. \r\n\r\nThe steps to do this are:\r\n\r\n- Copy paste the us-east-1 folder into a new sa-east-1 folder in each of the environments dev, stage, and prod.\r\n- Update the region.hcl file to point to sa-east-1\r\n- Copy all secrets manager entries in us-east-1 into sa-east-1\r\n- Update ARN references to secrets manager entries in the code to point to the newly copied secrets manager entries in sa-east-1.\r\n- Run terragrunt run-all apply in the sa-east-1 folder.\r\n\r\nNote that Gruntwork is happy to help out in support if you run into any issues going through this process.\r\n"}},{"node":{"author":{"login":"zackproser"},"body":"Credit for this solution goes to @yorinasub17 "}},{"node":{"author":{"login":"moos3"},"body":"How are you suppose to run the terragrunt run-all apply locally? I dont believe iam admin users have the same permissions as the `ci-machine-user`.  @zackproser @yorinasub17 @pete0emerson can one of you chime in on this?"}}]}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "0c3dfcf404356ae3885031d8ebeb4b18"
}
##DOCS-SOURCER-END -->
