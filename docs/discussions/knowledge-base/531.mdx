---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/531" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Issue with terragrunt run-all destory</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AQXX-","number":531,"author":{"login":"Aman1994"},"title":"Issue with terragrunt run-all destory","body":"\nHi, We install argocd using oboukili/argocd source and our code has something like \r\n\r\n```terraform\r\nresource \"helm_release\" \"argocd\" {\r\n  name             = \"argo-cd\"\r\n  chart            = \"argo-cd\"\r\n  repository       = \"https://argoproj.github.io/argo-helm\"\r\n  create_namespace = true\r\n  namespace        = \"argocd\"\r\n  version          = \"3.29.5\"\r\n  values           = [\r\n    file(\"argocd.yaml\")\r\n  ]\r\n  depends_on       = [\r\n    sealedsecret_local.argocd_repos,\r\n  ]\r\n}\r\n\r\nresource \"kubectl_manifest\" \"argocd_secret\" {\r\n  yaml_body         = sealedsecret_local.argocd_repos.yaml_content\r\n  force_new         = true\r\n  server_side_apply = true\r\n  wait              = true\r\n}\r\n\r\nresource \"argocd_repository\" \"argocd_repos\" {\r\n  for_each        = var.argocd_repos\r\n  ssh_private_key = file(each.value.ssh_private_key)\r\n  repo            = each.value.url\r\n  depends_on      = [\r\n    helm_release.argocd\r\n  ]\r\n}\r\n```\r\n\r\nWe deployed the infra using terragrunt and then went fine. Now, when we try to destroy using `terragrunt run-all destroy` we get \r\n\r\n\r\n```\r\n│ Error: Failed to init clients\r\n│ \r\n│   with argocd_repository.argocd_repos[\"k8id\"],\r\n│   on argocd.tf line 49, in resource \"argocd_repository\" \"argocd_repos\":\r\n│   49: resource \"argocd_repository\" \"argocd_repos\" {\r\n│ \r\n│ EOF\r\n╵\r\n╷\r\n│ Error: Failed to init clients\r\n│ \r\n│   with argocd_repository.argocd_repos[\"k8id-config\"],\r\n│   on argocd.tf line 49, in resource \"argocd_repository\" \"argocd_repos\":\r\n│   49: resource \"argocd_repository\" \"argocd_repos\" {\r\n│ \r\n│ EOF\r\n\r\n```\r\nAny idea what the issue is ?\n\n---\n\n<ins datetime=\"2022-08-09T07:25:15Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109113\">Tracked in ticket #109113</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Hi, We install argocd using oboukili/argocd source and our code has something like</p>\n<div class=\"highlight highlight-source-hcl notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"resource &quot;helm_release&quot; &quot;argocd&quot; {\n  name             = &quot;argo-cd&quot;\n  chart            = &quot;argo-cd&quot;\n  repository       = &quot;https://argoproj.github.io/argo-helm&quot;\n  create_namespace = true\n  namespace        = &quot;argocd&quot;\n  version          = &quot;3.29.5&quot;\n  values           = [\n    file(&quot;argocd.yaml&quot;)\n  ]\n  depends_on       = [\n    sealedsecret_local.argocd_repos,\n  ]\n}\n\nresource &quot;kubectl_manifest&quot; &quot;argocd_secret&quot; {\n  yaml_body         = sealedsecret_local.argocd_repos.yaml_content\n  force_new         = true\n  server_side_apply = true\n  wait              = true\n}\n\nresource &quot;argocd_repository&quot; &quot;argocd_repos&quot; {\n  for_each        = var.argocd_repos\n  ssh_private_key = file(each.value.ssh_private_key)\n  repo            = each.value.url\n  depends_on      = [\n    helm_release.argocd\n  ]\n}\"><pre class=\"notranslate\"><span class=\"pl-en\">resource</span> <span class=\"pl-smi\">\"helm_release\"</span> <span class=\"pl-smi\">\"argocd\"</span> {\n  <span class=\"pl-v\"><span class=\"pl-smi\">name</span>             <span class=\"pl-k\">=</span> </span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>argo-cd<span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">chart</span>            <span class=\"pl-k\">=</span> </span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>argo-cd<span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">repository</span>       <span class=\"pl-k\">=</span> </span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://argoproj.github.io/argo-helm<span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">create_namespace</span> <span class=\"pl-k\">=</span> </span><span class=\"pl-c1\">true</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">namespace</span>        <span class=\"pl-k\">=</span> </span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>argocd<span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">version</span>          <span class=\"pl-k\">=</span> </span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>3.29.5<span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">values</span>           <span class=\"pl-k\">=</span> </span>[\n    <span class=\"pl-c1\">file</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>argocd.yaml<span class=\"pl-pds\">\"</span></span>)\n  ]\n  <span class=\"pl-v\"><span class=\"pl-smi\">depends_on</span>       <span class=\"pl-k\">=</span> </span>[\n    <span class=\"pl-smi\">sealedsecret_local</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">argocd_repos</span>,\n  ]\n}\n\n<span class=\"pl-en\">resource</span> <span class=\"pl-smi\">\"kubectl_manifest\"</span> <span class=\"pl-smi\">\"argocd_secret\"</span> {\n  <span class=\"pl-v\"><span class=\"pl-smi\">yaml_body</span>         <span class=\"pl-k\">=</span> </span>sealedsecret_local<span class=\"pl-k\">.</span><span class=\"pl-smi\">argocd_repos</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">yaml_content</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">force_new</span>         <span class=\"pl-k\">=</span> </span><span class=\"pl-c1\">true</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">server_side_apply</span> <span class=\"pl-k\">=</span> </span><span class=\"pl-c1\">true</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">wait</span>              <span class=\"pl-k\">=</span> </span><span class=\"pl-c1\">true</span>\n}\n\n<span class=\"pl-en\">resource</span> <span class=\"pl-smi\">\"argocd_repository\"</span> <span class=\"pl-smi\">\"argocd_repos\"</span> {\n  <span class=\"pl-v\"><span class=\"pl-smi\">for_each</span>        <span class=\"pl-k\">=</span> </span>var<span class=\"pl-k\">.</span><span class=\"pl-smi\">argocd_repos</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">ssh_private_key</span> <span class=\"pl-k\">=</span> </span><span class=\"pl-c1\">file</span>(each<span class=\"pl-k\">.</span><span class=\"pl-smi\">value</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">ssh_private_key</span>)\n  <span class=\"pl-v\"><span class=\"pl-smi\">repo</span>            <span class=\"pl-k\">=</span> </span>each<span class=\"pl-k\">.</span><span class=\"pl-smi\">value</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">url</span>\n  <span class=\"pl-v\"><span class=\"pl-smi\">depends_on</span>      <span class=\"pl-k\">=</span> </span>[\n    <span class=\"pl-smi\">helm_release</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">argocd</span>\n  ]\n}</pre></div>\n<p dir=\"auto\">We deployed the infra using terragrunt and then went fine. Now, when we try to destroy using <code class=\"notranslate\">terragrunt run-all destroy</code> we get</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"│ Error: Failed to init clients\n│ \n│   with argocd_repository.argocd_repos[&quot;k8id&quot;],\n│   on argocd.tf line 49, in resource &quot;argocd_repository&quot; &quot;argocd_repos&quot;:\n│   49: resource &quot;argocd_repository&quot; &quot;argocd_repos&quot; {\n│ \n│ EOF\n╵\n╷\n│ Error: Failed to init clients\n│ \n│   with argocd_repository.argocd_repos[&quot;k8id-config&quot;],\n│   on argocd.tf line 49, in resource &quot;argocd_repository&quot; &quot;argocd_repos&quot;:\n│   49: resource &quot;argocd_repository&quot; &quot;argocd_repos&quot; {\n│ \n│ EOF\n\"><pre class=\"notranslate\"><code class=\"notranslate\">│ Error: Failed to init clients\n│ \n│   with argocd_repository.argocd_repos[\"k8id\"],\n│   on argocd.tf line 49, in resource \"argocd_repository\" \"argocd_repos\":\n│   49: resource \"argocd_repository\" \"argocd_repos\" {\n│ \n│ EOF\n╵\n╷\n│ Error: Failed to init clients\n│ \n│   with argocd_repository.argocd_repos[\"k8id-config\"],\n│   on argocd.tf line 49, in resource \"argocd_repository\" \"argocd_repos\":\n│   49: resource \"argocd_repository\" \"argocd_repos\" {\n│ \n│ EOF\n\n</code></pre></div>\n<p dir=\"auto\">Any idea what the issue is ?</p>\n<hr>\n<ins datetime=\"2022-08-09T07:25:15Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109113\" rel=\"nofollow\">Tracked in ticket #109113</a></p>\n</ins>","answer":{"body":"It looks like this was resolved in https://github.com/oboukili/terraform-provider-argocd/issues/196, so closing this out.","bodyHTML":"<p dir=\"auto\">It looks like this was resolved in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1332859514\" data-permission-text=\"Title is private\" data-url=\"https://github.com/argoproj-labs/terraform-provider-argocd/issues/196\" data-hovercard-type=\"issue\" data-hovercard-url=\"/argoproj-labs/terraform-provider-argocd/issues/196/hovercard\" href=\"https://github.com/argoproj-labs/terraform-provider-argocd/issues/196\">argoproj-labs/terraform-provider-argocd#196</a>, so closing this out.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "b9abd81a8a1e12f088f21a4d85857bdf"
}
##DOCS-SOURCER-END -->
