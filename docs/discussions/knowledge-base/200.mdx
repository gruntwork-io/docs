---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/200" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Why does `terraform-update-variable` default to skipping CI?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOycs","number":200,"author":{"login":"yorinasub17"},"title":"Why does `terraform-update-variable` default to skipping CI?","body":"Specifically, the `--skip-ci-flag` defaults to `[skip ci]`, causing the underlying pipeline to be skipped. What is the intended flow with this script?","bodyHTML":"<p dir=\"auto\">Specifically, the <code class=\"notranslate\">--skip-ci-flag</code> defaults to <code class=\"notranslate\">[skip ci]</code>, causing the underlying pipeline to be skipped. What is the intended flow with this script?</p>","answer":{"body":"This script predates the `ecs-deploy-runner` pipeline scripts, and thus the script defaults are currently optimized for and adapted to a workflow that predates the pipeline scripts. In this flow, the intended workflow for deploying a new image version was:\r\n\r\n- Build a new image\r\n- Use `terraform-update-variable` to update the image tag to the new version in the relevant `terragrunt.hcl` script\r\n- Run `terragrunt apply`\r\n- Push and commit the code, _without running the pipeline since the code is already deployed in a manual `terragrunt apply` call_.\r\n\r\nWith `ecs-deploy-runner`, the intention is to run the script with `--skip-ci-flag \"\"` so that the skip ci flag is not injected into the commit and the main `infrastructure-live` pipeline is run. Note that if you are using the template from the Reference Architecture, this should already be included in the args when calling the `terraform-update-variable` script: https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_ci/app-templates/scripts/deploy-docker-image.sh#L50","bodyHTML":"<p dir=\"auto\">This script predates the <code class=\"notranslate\">ecs-deploy-runner</code> pipeline scripts, and thus the script defaults are currently optimized for and adapted to a workflow that predates the pipeline scripts. In this flow, the intended workflow for deploying a new image version was:</p>\n<ul dir=\"auto\">\n<li>Build a new image</li>\n<li>Use <code class=\"notranslate\">terraform-update-variable</code> to update the image tag to the new version in the relevant <code class=\"notranslate\">terragrunt.hcl</code> script</li>\n<li>Run <code class=\"notranslate\">terragrunt apply</code></li>\n<li>Push and commit the code, <em>without running the pipeline since the code is already deployed in a manual <code class=\"notranslate\">terragrunt apply</code> call</em>.</li>\n</ul>\n<p dir=\"auto\">With <code class=\"notranslate\">ecs-deploy-runner</code>, the intention is to run the script with <code class=\"notranslate\">--skip-ci-flag \"\"</code> so that the skip ci flag is not injected into the commit and the main <code class=\"notranslate\">infrastructure-live</code> pipeline is run. Note that if you are using the template from the Reference Architecture, this should already be included in the args when calling the <code class=\"notranslate\">terraform-update-variable</code> script: <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_ci/app-templates/scripts/deploy-docker-image.sh#L50\">https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_ci/app-templates/scripts/deploy-docker-image.sh#L50</a></p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "1c09c918cd47c98c557346f6be845d3b"
}
##DOCS-SOURCER-END -->
