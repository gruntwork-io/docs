---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/410" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Persistent Volume</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84APftf","number":410,"author":{"login":"andrew-thyng-akido"},"title":"Persistent Volume","body":"\nHello, \r\nWe’re using the reference infrastructure here and I am a little bit lost regarding PersistentVolumes and where I would create one.\r\n\r\nWhen I create a k8s-service within our EKS cluster I am using the following block to create a PVC, which seems like it will work fine (I have only run `terragrunt plan` to check output).\r\n```\r\n  override_chart_inputs = {\r\n    persistentVolumes = {\r\n      somepvname-pv = {\r\n        mountPath = \"/var/data\"\r\n        claimName = \"myservice-pvc\"\r\n      }\r\n    }\r\n  }\r\n```\r\n\r\nWe have the `aws-ebs` storage class installed \r\n\r\n```\r\nNAME            PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\r\ngp2 (default)   kubernetes.io/aws-ebs   Delete          WaitForFirstConsumer   false                  216d\r\n```\r\n\r\nMy questions are:\r\n1. Where do I actually make a `PersistentVolume` in my cluster?\r\n2. How do I either a) size my PVC manually or b) allow the PVC to size up automatically?\r\n\r\nI feel like I must be missing the place in the documentation this exists, so any help pointing that out would be great. Thanks!\n\n---\n\n<ins datetime=\"2022-05-09T16:20:57Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/108571\">Tracked in ticket #108571</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Hello,<br>\nWe’re using the reference infrastructure here and I am a little bit lost regarding PersistentVolumes and where I would create one.</p>\n<p dir=\"auto\">When I create a k8s-service within our EKS cluster I am using the following block to create a PVC, which seems like it will work fine (I have only run <code class=\"notranslate\">terragrunt plan</code> to check output).</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  override_chart_inputs = {\n    persistentVolumes = {\n      somepvname-pv = {\n        mountPath = &quot;/var/data&quot;\n        claimName = &quot;myservice-pvc&quot;\n      }\n    }\n  }\"><pre class=\"notranslate\"><code class=\"notranslate\">  override_chart_inputs = {\n    persistentVolumes = {\n      somepvname-pv = {\n        mountPath = \"/var/data\"\n        claimName = \"myservice-pvc\"\n      }\n    }\n  }\n</code></pre></div>\n<p dir=\"auto\">We have the <code class=\"notranslate\">aws-ebs</code> storage class installed</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"NAME            PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\ngp2 (default)   kubernetes.io/aws-ebs   Delete          WaitForFirstConsumer   false                  216d\"><pre class=\"notranslate\"><code class=\"notranslate\">NAME            PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\ngp2 (default)   kubernetes.io/aws-ebs   Delete          WaitForFirstConsumer   false                  216d\n</code></pre></div>\n<p dir=\"auto\">My questions are:</p>\n<ol dir=\"auto\">\n<li>Where do I actually make a <code class=\"notranslate\">PersistentVolume</code> in my cluster?</li>\n<li>How do I either a) size my PVC manually or b) allow the PVC to size up automatically?</li>\n</ol>\n<p dir=\"auto\">I feel like I must be missing the place in the documentation this exists, so any help pointing that out would be great. Thanks!</p>\n<hr>\n<ins datetime=\"2022-05-09T16:20:57Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/108571\" rel=\"nofollow\">Tracked in ticket #108571</a></p>\n</ins>","answer":{"body":"Unfortunately, we don't have a lot of support for running stateful workloads on Kubernetes in our IaC library. This is why you haven't found any documentation on it - we don't have modules that support deploying the necessary resources to manage volumes. It is on our roadmap to add support for PVCs and PVs, but as of this writing (May 2022), we haven't implemented anything yet.\r\n\r\nGiven that, you will have to either [create your own terraform modules](https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog) that use the [kubernetes resources](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs) to manage the volumes (if you would like to use the existing ref arch pipeline and `terragrunt`).\r\n\r\nAlternatively, consider using `kubectl` manifests directly in combination with a Kubernetes native CI/CD solution, such as [flux-cd](https://fluxcd.io/) or [argo-cd](https://argoproj.github.io/cd/). In this world, the approach would be to store the manifests in the `infrastructure-live` repository under a separate top level directory, and point `flux` or `argo-cd` to read those manifests for apply.","bodyHTML":"<p dir=\"auto\">Unfortunately, we don't have a lot of support for running stateful workloads on Kubernetes in our IaC library. This is why you haven't found any documentation on it - we don't have modules that support deploying the necessary resources to manage volumes. It is on our roadmap to add support for PVCs and PVs, but as of this writing (May 2022), we haven't implemented anything yet.</p>\n<p dir=\"auto\">Given that, you will have to either <a href=\"https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog\" rel=\"nofollow\">create your own terraform modules</a> that use the <a href=\"https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs\" rel=\"nofollow\">kubernetes resources</a> to manage the volumes (if you would like to use the existing ref arch pipeline and <code class=\"notranslate\">terragrunt</code>).</p>\n<p dir=\"auto\">Alternatively, consider using <code class=\"notranslate\">kubectl</code> manifests directly in combination with a Kubernetes native CI/CD solution, such as <a href=\"https://fluxcd.io/\" rel=\"nofollow\">flux-cd</a> or <a href=\"https://argoproj.github.io/cd/\" rel=\"nofollow\">argo-cd</a>. In this world, the approach would be to store the manifests in the <code class=\"notranslate\">infrastructure-live</code> repository under a separate top level directory, and point <code class=\"notranslate\">flux</code> or <code class=\"notranslate\">argo-cd</code> to read those manifests for apply.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "22519e8facb353747239d36e7358d12b"
}
##DOCS-SOURCER-END -->
