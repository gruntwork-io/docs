---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/146" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Error when running terragrunt run-all plan</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOiob","number":146,"author":{"login":"drey0143143"},"title":"Error when running terragrunt run-all plan","body":"I have multiple environment Testing and Production ,I want to verify terragrunt run-all plan(plan) with checkov when GitHubActions workflow is triggered.I want the plan saved in tfplan.binary then converted to json so checkov can scan it.I am getting error message after the terraform run-all plan is called.Below is my code snippet and the error messages.\r\n~~~\r\nTerragrunt.hcl\r\n\r\nterraform {\r\n  extra_arguments \"plan_file\" {\r\n    commands = [\"plan\"]\r\n    arguments = [\"-out=${get_terragrunt_dir()}/tfplan.binary\"]\r\n  }\r\n\r\n  after_hook \"after_hook_plan\" {\r\n      commands     = [\"plan\"]\r\n      execute      = [\"sh\", \"-c\", \"terraform show -json tfplan.binary > ${get_parent_terragrunt_dir()}/plan.json\"]\r\n  }\r\n}\r\n\r\n\r\nActions Workflow\r\n\r\n- name: Plan\r\n        id: plan\r\n        run: |\r\n          terragrunt run-all plan  -no-color --terragrunt-non-interactive\r\n          \r\n      -  run: |\r\n           pip install checkov\r\n           checkov -d ../../\r\n     \r\n          \r\n      - name: 'Test Plan (Checkov)'\r\n        uses: bridgecrewio/checkov-action@master\r\n        with:\r\n          directory: ../../\r\n          quiet: false # optional: display only failed checks\r\n          framework: terraform # optional: run only on a specific infrastructure {cloudformation,terraform,kubernetes,all}\r\n          output_format: json # optional: the output format, one of: cli, json, junitxml, github_failed_only\r\n\r\n\r\nerror message\r\nSaved the plan to: /home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary\r\n\r\nTo perform exactly these actions, run the following command to apply:\r\n    terraform apply \"/home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary\"\r\ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/testing/global has finished with an error: 1 error occurred:\r\n\t* exit status 1\r\n\r\n prefix=[/home/runner/work/identity/identity/applied/accounts/testing/global] \r\ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/production/global has finished with an error: 1 error occurred:\r\n\t* exit status 1\r\ntime=2022-01-17T15:26:42Z level=info msg=Executing hook: after_hook_plan prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \r\ntime=2022-01-17T15:26:44Z level=error msg=Error running hook after_hook_plan with message: exit status 1 prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \r\n\r\n```\r\n","bodyHTML":"<p dir=\"auto\">I have multiple environment Testing and Production ,I want to verify terragrunt run-all plan(plan) with checkov when GitHubActions workflow is triggered.I want the plan saved in tfplan.binary then converted to json so checkov can scan it.I am getting error message after the terraform run-all plan is called.Below is my code snippet and the error messages.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Terragrunt.hcl\n\nterraform {\n  extra_arguments &quot;plan_file&quot; {\n    commands = [&quot;plan&quot;]\n    arguments = [&quot;-out=${get_terragrunt_dir()}/tfplan.binary&quot;]\n  }\n\n  after_hook &quot;after_hook_plan&quot; {\n      commands     = [&quot;plan&quot;]\n      execute      = [&quot;sh&quot;, &quot;-c&quot;, &quot;terraform show -json tfplan.binary &gt; ${get_parent_terragrunt_dir()}/plan.json&quot;]\n  }\n}\n\n\nActions Workflow\n\n- name: Plan\n        id: plan\n        run: |\n          terragrunt run-all plan  -no-color --terragrunt-non-interactive\n          \n      -  run: |\n           pip install checkov\n           checkov -d ../../\n     \n          \n      - name: 'Test Plan (Checkov)'\n        uses: bridgecrewio/checkov-action@master\n        with:\n          directory: ../../\n          quiet: false # optional: display only failed checks\n          framework: terraform # optional: run only on a specific infrastructure {cloudformation,terraform,kubernetes,all}\n          output_format: json # optional: the output format, one of: cli, json, junitxml, github_failed_only\n\n\nerror message\nSaved the plan to: /home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary\n\nTo perform exactly these actions, run the following command to apply:\n    terraform apply &quot;/home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary&quot;\ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/testing/global has finished with an error: 1 error occurred:\n\t* exit status 1\n\n prefix=[/home/runner/work/identity/identity/applied/accounts/testing/global] \ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/production/global has finished with an error: 1 error occurred:\n\t* exit status 1\ntime=2022-01-17T15:26:42Z level=info msg=Executing hook: after_hook_plan prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \ntime=2022-01-17T15:26:44Z level=error msg=Error running hook after_hook_plan with message: exit status 1 prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \n\n```\"><pre class=\"notranslate\"><code class=\"notranslate\">Terragrunt.hcl\n\nterraform {\n  extra_arguments \"plan_file\" {\n    commands = [\"plan\"]\n    arguments = [\"-out=${get_terragrunt_dir()}/tfplan.binary\"]\n  }\n\n  after_hook \"after_hook_plan\" {\n      commands     = [\"plan\"]\n      execute      = [\"sh\", \"-c\", \"terraform show -json tfplan.binary &gt; ${get_parent_terragrunt_dir()}/plan.json\"]\n  }\n}\n\n\nActions Workflow\n\n- name: Plan\n        id: plan\n        run: |\n          terragrunt run-all plan  -no-color --terragrunt-non-interactive\n          \n      -  run: |\n           pip install checkov\n           checkov -d ../../\n     \n          \n      - name: 'Test Plan (Checkov)'\n        uses: bridgecrewio/checkov-action@master\n        with:\n          directory: ../../\n          quiet: false # optional: display only failed checks\n          framework: terraform # optional: run only on a specific infrastructure {cloudformation,terraform,kubernetes,all}\n          output_format: json # optional: the output format, one of: cli, json, junitxml, github_failed_only\n\n\nerror message\nSaved the plan to: /home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary\n\nTo perform exactly these actions, run the following command to apply:\n    terraform apply \"/home/runner/work/identity/identity/applied/accounts/production/global/tfplan.binary\"\ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/testing/global has finished with an error: 1 error occurred:\n\t* exit status 1\n\n prefix=[/home/runner/work/identity/identity/applied/accounts/testing/global] \ntime=2022-01-17T15:26:44Z level=error msg=Module /home/runner/work/identity/identity/applied/accounts/production/global has finished with an error: 1 error occurred:\n\t* exit status 1\ntime=2022-01-17T15:26:42Z level=info msg=Executing hook: after_hook_plan prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \ntime=2022-01-17T15:26:44Z level=error msg=Error running hook after_hook_plan with message: exit status 1 prefix=[/home/runner/work/identity/identity/applied/accounts/production/global] \n\n```\n</code></pre></div>","answer":{"body":"Looks like a duplicate of https://github.com/gruntwork-io/terragrunt/issues/1989 replied there ","bodyHTML":"<p dir=\"auto\">Looks like a duplicate of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1108709618\" data-permission-text=\"Title is private\" data-url=\"https://github.com/gruntwork-io/terragrunt/issues/1989\" data-hovercard-type=\"issue\" data-hovercard-url=\"/gruntwork-io/terragrunt/issues/1989/hovercard\" href=\"https://github.com/gruntwork-io/terragrunt/issues/1989\">gruntwork-io/terragrunt#1989</a> replied there</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "eb95523ac39e66f17c783e35dc9a29cc"
}
##DOCS-SOURCER-END -->
