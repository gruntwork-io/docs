---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/151" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Error when trying to use network_configuration for FARGATE tasks</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOoRR","number":151,"author":{"login":"fsanzdev"},"title":"Error when trying to use network_configuration for FARGATE tasks","body":"Hi, \r\n\r\nI'm having some issues when trying to use network_configuration for FARGATE tasks. This is the code I have:\r\n```\r\n  desired_number_of_tasks = \"1\"\r\n  launch_type             = \"FARGATE\"\r\n  network_mode            = \"awsvpc\"\r\n  task_cpu                = 512\r\n  task_memory             = 1024\r\n  network_configuration   = {\r\n    subnets                       = dependency.vpc.outputs.private_app_subnet_ids\r\n    vpc_id                        = dependency.vpc.outputs.vpc_id\r\n    security_group_rules          = {\r\n      sg-service-name-port = {\r\n        type                     = \"ingress\"\r\n        from_port                = local.container_port\r\n        to_port                  = local.container_port\r\n        protocol                 = \"tcp\"\r\n        # source_security_group_id = \"sg-${local.service_name}\"\r\n        cidr_blocks              = [dependency.vpc.outputs.vpc_cidr_block]\r\n      }\r\n    }\r\n    additional_security_group_ids = []\r\n    assign_public_ip              = false\r\n```\r\n\r\nBut it looks like both, `source_security_group_id` and `cidr_blocks` attributes are required by the module, when according to the SG rule documentation you can't have both, having an `Error: Conflicting configuration arguments` message when applying the plan.\r\n\r\nCould you please confirm if I'm doing something wrong?","bodyHTML":"<p dir=\"auto\">Hi,</p>\n<p dir=\"auto\">I'm having some issues when trying to use network_configuration for FARGATE tasks. This is the code I have:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  desired_number_of_tasks = &quot;1&quot;\n  launch_type             = &quot;FARGATE&quot;\n  network_mode            = &quot;awsvpc&quot;\n  task_cpu                = 512\n  task_memory             = 1024\n  network_configuration   = {\n    subnets                       = dependency.vpc.outputs.private_app_subnet_ids\n    vpc_id                        = dependency.vpc.outputs.vpc_id\n    security_group_rules          = {\n      sg-service-name-port = {\n        type                     = &quot;ingress&quot;\n        from_port                = local.container_port\n        to_port                  = local.container_port\n        protocol                 = &quot;tcp&quot;\n        # source_security_group_id = &quot;sg-${local.service_name}&quot;\n        cidr_blocks              = [dependency.vpc.outputs.vpc_cidr_block]\n      }\n    }\n    additional_security_group_ids = []\n    assign_public_ip              = false\"><pre class=\"notranslate\"><code class=\"notranslate\">  desired_number_of_tasks = \"1\"\n  launch_type             = \"FARGATE\"\n  network_mode            = \"awsvpc\"\n  task_cpu                = 512\n  task_memory             = 1024\n  network_configuration   = {\n    subnets                       = dependency.vpc.outputs.private_app_subnet_ids\n    vpc_id                        = dependency.vpc.outputs.vpc_id\n    security_group_rules          = {\n      sg-service-name-port = {\n        type                     = \"ingress\"\n        from_port                = local.container_port\n        to_port                  = local.container_port\n        protocol                 = \"tcp\"\n        # source_security_group_id = \"sg-${local.service_name}\"\n        cidr_blocks              = [dependency.vpc.outputs.vpc_cidr_block]\n      }\n    }\n    additional_security_group_ids = []\n    assign_public_ip              = false\n</code></pre></div>\n<p dir=\"auto\">But it looks like both, <code class=\"notranslate\">source_security_group_id</code> and <code class=\"notranslate\">cidr_blocks</code> attributes are required by the module, when according to the SG rule documentation you can't have both, having an <code class=\"notranslate\">Error: Conflicting configuration arguments</code> message when applying the plan.</p>\n<p dir=\"auto\">Could you please confirm if I'm doing something wrong?</p>","answer":{"body":"It was not quite clear looking at the code or the documentation, but all made sense after looking at this example https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-learning-and-testing/services/ecs-service/main.tf\r\n\r\nOne of those fields has to be set to null (not just remove it)","bodyHTML":"<p dir=\"auto\">It was not quite clear looking at the code or the documentation, but all made sense after looking at this example <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-learning-and-testing/services/ecs-service/main.tf\">https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-learning-and-testing/services/ecs-service/main.tf</a></p>\n<p dir=\"auto\">One of those fields has to be set to null (not just remove it)</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "b5790131fb4a99f16ee26fa26efa3e6e"
}
##DOCS-SOURCER-END -->
