---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/29" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Inaccessible Jenkins Server</h1>
<GitHub discussion={{"id":"MDEwOkRpc2N1c3Npb24zNTYzOTg2","number":29,"author":{"login":"gruntwork-support"},"title":"Inaccessible Jenkins Server","body":"_This message was extracted from a discussion that originally took place in Gruntwork Community Slack. Names and URLs have been removed where appropriate_\n\n**From a customer**\n\nWe've built Jenkins AMI using [terragrunt module](terraform-aws-service-catalog.git//modules/mgmt/jenkins) with ref `v0.44.7` using `packer`.\nWhen we try to create Jenkins server using terragrunt module, after creating LB and EC2 instance, health check was keep failing. Hence EC2 keep getting restarted. If we manually start the Jenkins server from the EC2 instance then it is working. But if reboot the instance then getting same problem i.e jenkins server not automatically starting up within the EC2 instance. The same behavior occurred both versions `terraform-aws-service-catalog.git//modules/mgmt/jenkins?ref=v0.34.1` and `terraform-aws-service-catalog.git//modules/mgmt/jenkins?ref=v0.44.7`.\nAny idea why Jenkins server not starting up automatically once EC2 instance is successfully launched?","bodyHTML":"<p dir=\"auto\"><em>This message was extracted from a discussion that originally took place in Gruntwork Community Slack. Names and URLs have been removed where appropriate</em></p>\n<p dir=\"auto\"><strong>From a customer</strong></p>\n<p dir=\"auto\">We've built Jenkins AMI using <a href=\"terraform-aws-service-catalog.git//modules/mgmt/jenkins\">terragrunt module</a> with ref <code class=\"notranslate\">v0.44.7</code> using <code class=\"notranslate\">packer</code>.<br>\nWhen we try to create Jenkins server using terragrunt module, after creating LB and EC2 instance, health check was keep failing. Hence EC2 keep getting restarted. If we manually start the Jenkins server from the EC2 instance then it is working. But if reboot the instance then getting same problem i.e jenkins server not automatically starting up within the EC2 instance. The same behavior occurred both versions <code class=\"notranslate\">terraform-aws-service-catalog.git//modules/mgmt/jenkins?ref=v0.34.1</code> and <code class=\"notranslate\">terraform-aws-service-catalog.git//modules/mgmt/jenkins?ref=v0.44.7</code>.<br>\nAny idea why Jenkins server not starting up automatically once EC2 instance is successfully launched?</p>","answer":{"body":"**From a grunt**\n\nOk after investigation, what person said is correct. The main issue here is that you have `ssh-grunt` configured for the server, but it looks like your environment is not setup to support it.\n\nBecause the boot script fails to start up `ssh-grunt`, everything after that step fails, including mounting the data volume. The reason directly starting the jenkins service works is because the default location for the jenkins volume is `/var/lib`, which exists in the file system. When you call `run-jenkins`, you are configuring the jenkins data volume to be `/jenkins`, which does not exist by default - this materializes when the boot script runs [attach_volume](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/mgmt/jenkins/user-data.sh#L40), which isn’t called if it halts when it tries to start `ssh-grunt`.\n\nYou can workaround this by disabling `ssh-grunt`. This can be done by setting the following terraform input vars:\n\n```\nenable_ssh_grunt = false\nssh_grunt_iam_group = \"\"\nssh_grunt_iam_group_sudo = \"\"\n```","bodyHTML":"<p dir=\"auto\"><strong>From a grunt</strong></p>\n<p dir=\"auto\">Ok after investigation, what person said is correct. The main issue here is that you have <code class=\"notranslate\">ssh-grunt</code> configured for the server, but it looks like your environment is not setup to support it.</p>\n<p dir=\"auto\">Because the boot script fails to start up <code class=\"notranslate\">ssh-grunt</code>, everything after that step fails, including mounting the data volume. The reason directly starting the jenkins service works is because the default location for the jenkins volume is <code class=\"notranslate\">/var/lib</code>, which exists in the file system. When you call <code class=\"notranslate\">run-jenkins</code>, you are configuring the jenkins data volume to be <code class=\"notranslate\">/jenkins</code>, which does not exist by default - this materializes when the boot script runs <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/mgmt/jenkins/user-data.sh#L40\">attach_volume</a>, which isn’t called if it halts when it tries to start <code class=\"notranslate\">ssh-grunt</code>.</p>\n<p dir=\"auto\">You can workaround this by disabling <code class=\"notranslate\">ssh-grunt</code>. This can be done by setting the following terraform input vars:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"enable_ssh_grunt = false\nssh_grunt_iam_group = &quot;&quot;\nssh_grunt_iam_group_sudo = &quot;&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">enable_ssh_grunt = false\nssh_grunt_iam_group = \"\"\nssh_grunt_iam_group_sudo = \"\"\n</code></pre></div>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "7e6d8e1c97ff789d02804d646817a40e"
}
##DOCS-SOURCER-END -->
