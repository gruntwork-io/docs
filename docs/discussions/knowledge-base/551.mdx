---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/551" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How do I import existing security group rules using terragrunt</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AQmDU","number":551,"author":{"login":"sewmiuraj"},"title":"How do I import existing security group rules using terragrunt","body":"\r\nHello,\r\n\r\nI am currently attempting to import existing security group rules using terragrunt import command. This worked without an issue when I did the same for a cloudwatch log group.\r\n\r\nHowever, with security group rules I am not able to do this. Can you please let me know what I am doing wrong here.\r\n\r\nOUTPUT OF TERRAGRUNT PLAN:\r\n\r\n```\r\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\r\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\r\n      ~ cidr_blocks              = [ # forces replacement\r\n            # (2 unchanged elements hidden)\r\n            \"10.2.96.0/21\",\r\n          + \"10.8.80.0/21\",\r\n          + \"10.8.88.0/21\",\r\n          + \"10.8.96.0/21\",\r\n        ]\r\n      ~ id                       = \"sgrule-3614096971\" -> (known after apply)\r\n      - ipv6_cidr_blocks         = [] -> null\r\n      - prefix_list_ids          = [] -> null\r\n      + source_security_group_id = (known after apply)\r\n        # (6 unchanged attributes hidden)\r\n    }\r\n```\r\n\r\nThe IPs  \"10.8.80.0/21\", \"10.8.88.0/21\", \"10.8.96.0/21\" are already added manually from the console. When I applied, the security group lost all the ingress rules. When I planned next time it showed the ingress rules ready to be applied. Running apply one more time recreated the rules properly, but I don't want to do that in my production environment - therefore trying the import option.\r\n\r\nCOMMAND:\r\n```\r\naws-vault exec stage -- terragrunt import aws_security_group_rule.ingress sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21\r\n```\r\n\r\n--------------------------------------------------------------------------------\r\n\r\nERROR:\r\n\r\n```\r\nError: resource address \"aws_security_group_rule.ingress\" does not exist in the configuration.\r\n\r\nBefore importing this resource, please create its configuration in the root module. For example:\r\n\r\nresource \"aws_security_group_rule\" \"ingress\" {\r\n   (resource arguments)\r\n}\r\n\r\nERRO[0025] 1 error occurred:\r\n\t* exit status 1\r\n```     \r\n\r\n\r\n---\r\n\r\n<ins datetime=\"2022-08-31T12:33:20Z\">\r\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109192\">Tracked in ticket #109192</a></p>\r\n</ins>\r\n","bodyHTML":"<p dir=\"auto\">Hello,</p>\n<p dir=\"auto\">I am currently attempting to import existing security group rules using terragrunt import command. This worked without an issue when I did the same for a cloudwatch log group.</p>\n<p dir=\"auto\">However, with security group rules I am not able to do this. Can you please let me know what I am doing wrong here.</p>\n<p dir=\"auto\">OUTPUT OF TERRAGRUNT PLAN:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource &quot;aws_security_group_rule&quot; &quot;allow_connections_from_cidr_blocks&quot; {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            &quot;10.2.96.0/21&quot;,\n          + &quot;10.8.80.0/21&quot;,\n          + &quot;10.8.88.0/21&quot;,\n          + &quot;10.8.96.0/21&quot;,\n        ]\n      ~ id                       = &quot;sgrule-3614096971&quot; -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\"><pre class=\"notranslate\"><code class=\"notranslate\">module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            \"10.2.96.0/21\",\n          + \"10.8.80.0/21\",\n          + \"10.8.88.0/21\",\n          + \"10.8.96.0/21\",\n        ]\n      ~ id                       = \"sgrule-3614096971\" -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\n</code></pre></div>\n<p dir=\"auto\">The IPs  \"10.8.80.0/21\", \"10.8.88.0/21\", \"10.8.96.0/21\" are already added manually from the console. When I applied, the security group lost all the ingress rules. When I planned next time it showed the ingress rules ready to be applied. Running apply one more time recreated the rules properly, but I don't want to do that in my production environment - therefore trying the import option.</p>\n<p dir=\"auto\">COMMAND:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"aws-vault exec stage -- terragrunt import aws_security_group_rule.ingress sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21\"><pre class=\"notranslate\"><code class=\"notranslate\">aws-vault exec stage -- terragrunt import aws_security_group_rule.ingress sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21\n</code></pre></div>\n<hr>\n<p dir=\"auto\">ERROR:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Error: resource address &quot;aws_security_group_rule.ingress&quot; does not exist in the configuration.\n\nBefore importing this resource, please create its configuration in the root module. For example:\n\nresource &quot;aws_security_group_rule&quot; &quot;ingress&quot; {\n   (resource arguments)\n}\n\nERRO[0025] 1 error occurred:\n\t* exit status 1\"><pre class=\"notranslate\"><code class=\"notranslate\">Error: resource address \"aws_security_group_rule.ingress\" does not exist in the configuration.\n\nBefore importing this resource, please create its configuration in the root module. For example:\n\nresource \"aws_security_group_rule\" \"ingress\" {\n   (resource arguments)\n}\n\nERRO[0025] 1 error occurred:\n\t* exit status 1\n</code></pre></div>\n<hr>\n<ins datetime=\"2022-08-31T12:33:20Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109192\" rel=\"nofollow\">Tracked in ticket #109192</a></p>\n</ins>","answer":{"body":"Hi @zackproser,\r\n\r\nI was able to use terragrunt state list to find the address. It returned:\r\n`module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0]`, but the command only worked without [0].\r\n\r\n**PLAN BEFORE IMPORT**\r\n```\r\n  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\r\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\r\n      ~ cidr_blocks              = [ # forces replacement\r\n            # (2 unchanged elements hidden)\r\n            \"10.2.96.0/21\",\r\n          + \"10.8.80.0/21\",\r\n          + \"10.8.88.0/21\",\r\n          + \"10.8.96.0/21\",\r\n        ]\r\n      ~ id                       = \"sgrule-3614096971\" -> (known after apply)\r\n      - ipv6_cidr_blocks         = [] -> null\r\n      - prefix_list_ids          = [] -> null\r\n      + source_security_group_id = (known after apply)\r\n        # (6 unchanged attributes hidden)\r\n    }\r\n```\r\n**IMPORT COMMAND THAT WORKE**D\r\n` aws-vault exec stage -- terragrunt import module.database.aws_security_group_rule.allow_connections_from_cidr_blocks sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21`\r\n\r\n```\r\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Importing from ID \"sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21\"...\r\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Import prepared!\r\n  Prepared aws_security_group_rule for import\r\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Refreshing state... [id=sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21]\r\n\r\nImport successful!\r\n```\r\n\r\n**PLAN AFTER IMPORT**\r\nFrom the looks of it, it is trying to delete my import.\r\n\r\n```\r\n# module.database.aws_security_group_rule.allow_connections_from_cidr_blocks will be destroyed\r\n  # (because resource uses count or for_each)\r\n  - resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\r\n      - cidr_blocks       = [\r\n          - \"10.8.80.0/21\",\r\n        ] -> null\r\n      - from_port         = 5432 -> null\r\n      - id                = \"sgrule-3185997217\" -> null\r\n      - ipv6_cidr_blocks  = [] -> null\r\n      - prefix_list_ids   = [] -> null\r\n      - protocol          = \"tcp\" -> null\r\n      - security_group_id = \"sg-01e69230e5c0f1169\" -> null\r\n      - self              = false -> null\r\n      - to_port           = 5432 -> null\r\n      - type              = \"ingress\" -> null\r\n    }\r\n\r\n  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\r\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\r\n      ~ cidr_blocks              = [ # forces replacement\r\n            # (2 unchanged elements hidden)\r\n            \"10.2.96.0/21\",\r\n          + \"10.8.80.0/21\",\r\n          + \"10.8.88.0/21\",\r\n          + \"10.8.96.0/21\",\r\n        ]\r\n      ~ id                       = \"sgrule-3614096971\" -> (known after apply)\r\n      - ipv6_cidr_blocks         = [] -> null\r\n      - prefix_list_ids          = [] -> null\r\n      + source_security_group_id = (known after apply)\r\n        # (6 unchanged attributes hidden)\r\n    }\r\n\r\n```\r\n","bodyHTML":"<p dir=\"auto\">Hi <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zackproser/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zackproser\">@zackproser</a>,</p>\n<p dir=\"auto\">I was able to use terragrunt state list to find the address. It returned:<br>\n<code class=\"notranslate\">module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0]</code>, but the command only worked without [0].</p>\n<p dir=\"auto\"><strong>PLAN BEFORE IMPORT</strong></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource &quot;aws_security_group_rule&quot; &quot;allow_connections_from_cidr_blocks&quot; {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            &quot;10.2.96.0/21&quot;,\n          + &quot;10.8.80.0/21&quot;,\n          + &quot;10.8.88.0/21&quot;,\n          + &quot;10.8.96.0/21&quot;,\n        ]\n      ~ id                       = &quot;sgrule-3614096971&quot; -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\"><pre class=\"notranslate\"><code class=\"notranslate\">  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            \"10.2.96.0/21\",\n          + \"10.8.80.0/21\",\n          + \"10.8.88.0/21\",\n          + \"10.8.96.0/21\",\n        ]\n      ~ id                       = \"sgrule-3614096971\" -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\n</code></pre></div>\n<p dir=\"auto\"><strong>IMPORT COMMAND THAT WORKE</strong>D<br>\n<code class=\"notranslate\"> aws-vault exec stage -- terragrunt import module.database.aws_security_group_rule.allow_connections_from_cidr_blocks sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Importing from ID &quot;sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21&quot;...\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Import prepared!\n  Prepared aws_security_group_rule for import\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Refreshing state... [id=sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21]\n\nImport successful!\"><pre class=\"notranslate\"><code class=\"notranslate\">module.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Importing from ID \"sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21\"...\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Import prepared!\n  Prepared aws_security_group_rule for import\nmodule.database.aws_security_group_rule.allow_connections_from_cidr_blocks: Refreshing state... [id=sg-01e69230e5c0f1169_ingress_tcp_5432_5432_10.8.80.0/21]\n\nImport successful!\n</code></pre></div>\n<p dir=\"auto\"><strong>PLAN AFTER IMPORT</strong><br>\nFrom the looks of it, it is trying to delete my import.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# module.database.aws_security_group_rule.allow_connections_from_cidr_blocks will be destroyed\n  # (because resource uses count or for_each)\n  - resource &quot;aws_security_group_rule&quot; &quot;allow_connections_from_cidr_blocks&quot; {\n      - cidr_blocks       = [\n          - &quot;10.8.80.0/21&quot;,\n        ] -&gt; null\n      - from_port         = 5432 -&gt; null\n      - id                = &quot;sgrule-3185997217&quot; -&gt; null\n      - ipv6_cidr_blocks  = [] -&gt; null\n      - prefix_list_ids   = [] -&gt; null\n      - protocol          = &quot;tcp&quot; -&gt; null\n      - security_group_id = &quot;sg-01e69230e5c0f1169&quot; -&gt; null\n      - self              = false -&gt; null\n      - to_port           = 5432 -&gt; null\n      - type              = &quot;ingress&quot; -&gt; null\n    }\n\n  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource &quot;aws_security_group_rule&quot; &quot;allow_connections_from_cidr_blocks&quot; {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            &quot;10.2.96.0/21&quot;,\n          + &quot;10.8.80.0/21&quot;,\n          + &quot;10.8.88.0/21&quot;,\n          + &quot;10.8.96.0/21&quot;,\n        ]\n      ~ id                       = &quot;sgrule-3614096971&quot; -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\n\"><pre class=\"notranslate\"><code class=\"notranslate\"># module.database.aws_security_group_rule.allow_connections_from_cidr_blocks will be destroyed\n  # (because resource uses count or for_each)\n  - resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\n      - cidr_blocks       = [\n          - \"10.8.80.0/21\",\n        ] -&gt; null\n      - from_port         = 5432 -&gt; null\n      - id                = \"sgrule-3185997217\" -&gt; null\n      - ipv6_cidr_blocks  = [] -&gt; null\n      - prefix_list_ids   = [] -&gt; null\n      - protocol          = \"tcp\" -&gt; null\n      - security_group_id = \"sg-01e69230e5c0f1169\" -&gt; null\n      - self              = false -&gt; null\n      - to_port           = 5432 -&gt; null\n      - type              = \"ingress\" -&gt; null\n    }\n\n  # module.database.aws_security_group_rule.allow_connections_from_cidr_blocks[0] must be replaced\n-/+ resource \"aws_security_group_rule\" \"allow_connections_from_cidr_blocks\" {\n      ~ cidr_blocks              = [ # forces replacement\n            # (2 unchanged elements hidden)\n            \"10.2.96.0/21\",\n          + \"10.8.80.0/21\",\n          + \"10.8.88.0/21\",\n          + \"10.8.96.0/21\",\n        ]\n      ~ id                       = \"sgrule-3614096971\" -&gt; (known after apply)\n      - ipv6_cidr_blocks         = [] -&gt; null\n      - prefix_list_ids          = [] -&gt; null\n      + source_security_group_id = (known after apply)\n        # (6 unchanged attributes hidden)\n    }\n\n</code></pre></div>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "e42a930b7053bad7b0672a28e7f1411f"
}
##DOCS-SOURCER-END -->
