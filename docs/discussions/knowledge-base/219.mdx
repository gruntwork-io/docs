---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How to handle &quot;Provided value for option repo does not match regex&quot; in GW Pipelines?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AO3Zp","number":219,"author":{"login":"yorinasub17"},"title":"How to handle \"Provided value for option repo does not match regex\" in GW Pipelines?","body":"When running a `plan` on the Reference Architecture, I'm getting the following error:\r\n\r\n```\r\n[INFO] [aws-auth] Success!\r\nRunning infrastructure-deployer with args: --aws-region us-east-1 -- terraform-planner infrastructure-deploy-script --ref e052cd6495ca55ad03cc918a86de9fa3d78cce0a --binary terragrunt --command plan --command-args  --deploy-path dev/us-east-1/dev/ec2-test --repo https://github.com/gruntwork-io/infrastructure-live --force-https true\r\n[infrastructure-deployer] time=\"2022-02-23T10:02:05Z\" level=info msg=\"Invoking Lambda function ecs-deploy-runner-invoker to trigger deployment.\"\r\nERROR: OptionRegexRestrictedError: Provided value for option repo (https://github.com/gruntwork-io/infrastructure-live) does not match regex (^((git@github\\.com:gruntwork-io/infrastructure-live\\.git)|(https://github/\\.com/gruntwork-clients/infrastructure-live\\.git))$)\r\nError: Process completed with exit code 123.\r\n```\r\n\r\nHow do I fix this?","bodyHTML":"<p dir=\"auto\">When running a <code class=\"notranslate\">plan</code> on the Reference Architecture, I'm getting the following error:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"[INFO] [aws-auth] Success!\nRunning infrastructure-deployer with args: --aws-region us-east-1 -- terraform-planner infrastructure-deploy-script --ref e052cd6495ca55ad03cc918a86de9fa3d78cce0a --binary terragrunt --command plan --command-args  --deploy-path dev/us-east-1/dev/ec2-test --repo https://github.com/gruntwork-io/infrastructure-live --force-https true\n[infrastructure-deployer] time=&quot;2022-02-23T10:02:05Z&quot; level=info msg=&quot;Invoking Lambda function ecs-deploy-runner-invoker to trigger deployment.&quot;\nERROR: OptionRegexRestrictedError: Provided value for option repo (https://github.com/gruntwork-io/infrastructure-live) does not match regex (^((git@github\\.com:gruntwork-io/infrastructure-live\\.git)|(https://github/\\.com/gruntwork-clients/infrastructure-live\\.git))$)\nError: Process completed with exit code 123.\"><pre class=\"notranslate\"><code>[INFO] [aws-auth] Success!\nRunning infrastructure-deployer with args: --aws-region us-east-1 -- terraform-planner infrastructure-deploy-script --ref e052cd6495ca55ad03cc918a86de9fa3d78cce0a --binary terragrunt --command plan --command-args  --deploy-path dev/us-east-1/dev/ec2-test --repo https://github.com/gruntwork-io/infrastructure-live --force-https true\n[infrastructure-deployer] time=\"2022-02-23T10:02:05Z\" level=info msg=\"Invoking Lambda function ecs-deploy-runner-invoker to trigger deployment.\"\nERROR: OptionRegexRestrictedError: Provided value for option repo (https://github.com/gruntwork-io/infrastructure-live) does not match regex (^((git@github\\.com:gruntwork-io/infrastructure-live\\.git)|(https://github/\\.com/gruntwork-clients/infrastructure-live\\.git))$)\nError: Process completed with exit code 123.\n</code></pre></div>\n<p dir=\"auto\">How do I fix this?</p>","answer":{"body":"This is because the ECS Deploy Runner has been configured to restrict your repo to the ssh URL instead of https, but your script is trying to deploy using the https URL. The easiest way to resolve this would be to update the CI scripts so that it uses the SSH url instead of the HTTPS url for the `--repo` call (e.g., you can try hardcoding the `repo_url` var [here](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_ci/scripts/deploy-infra.sh#L58))\r\n\r\nAlternatively, you can update the `ecs-deploy-runner` to allow using the https URL. This setting is configured using the `terraform_applier_config.infrastructure_live_repositories` setting for the `ecs-deploy-runner` module.\r\n\r\nIn the ref arch, it’s managed [here](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L161), which points to [this local](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L110-L113). You can add the https URL to that local and redeploy the `ecs-deploy-runner` in each account, which should update the regex to allow the https URL.","bodyHTML":"<p dir=\"auto\">This is because the ECS Deploy Runner has been configured to restrict your repo to the ssh URL instead of https, but your script is trying to deploy using the https URL. The easiest way to resolve this would be to update the CI scripts so that it uses the SSH url instead of the HTTPS url for the <code class=\"notranslate\">--repo</code> call (e.g., you can try hardcoding the <code class=\"notranslate\">repo_url</code> var <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_ci/scripts/deploy-infra.sh#L58\">here</a>)</p>\n<p dir=\"auto\">Alternatively, you can update the <code class=\"notranslate\">ecs-deploy-runner</code> to allow using the https URL. This setting is configured using the <code class=\"notranslate\">terraform_applier_config.infrastructure_live_repositories</code> setting for the <code class=\"notranslate\">ecs-deploy-runner</code> module.</p>\n<p dir=\"auto\">In the ref arch, it’s managed <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L161\">here</a>, which points to <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L110-L113\">this local</a>. You can add the https URL to that local and redeploy the <code class=\"notranslate\">ecs-deploy-runner</code> in each account, which should update the regex to allow the https URL.</p>"}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "f97b1934aa7c3ba7adc40b6842ff9e67"
}
##DOCS-SOURCER-END -->
