---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/250" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Preserve data volume when destroying single-server module?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AO78t","number":250,"author":{"login":"rhoboat"},"title":"Preserve data volume when destroying single-server module?","body":"When using the single-server module. Why does the `delete_on_termination` parameter work for the root device but not work for an `ebs_block_device`? Trying to preserve a data volume in case of destroy.","bodyHTML":"<p dir=\"auto\">When using the single-server module. Why does the <code class=\"notranslate\">delete_on_termination</code> parameter work for the root device but not work for an <code class=\"notranslate\">ebs_block_device</code>? Trying to preserve a data volume in case of destroy.</p>","answer":{"body":"The single-server module only manages the root block device, and doesn’t provision/manage additional EBS block devices.\r\n\r\nOne way you can avoid the destroy of block devices is by managing the EBS volume in a separate state file. E.g., create a module that manages the lifecycle of the EBS volume (these two blocks: https://github.com/gruntwork-io/terraform-aws-server/blob/master/examples/persistent-ebs-volume/main.tf#L62-L83), and then use the [persistent-ebs-volume](https://github.com/gruntwork-io/terraform-aws-server/tree/master/modules/persistent-ebs-volume) script to manage mounting that volume on the EC2 instance.\r\n\r\nSince the EBS volume is mounted via the `user_data` script, it should ensure that the volume is preserved even if you destroy the EC2 instance, and will remain until you destroy the other module that is managing the actual volume.\r\n\r\ncredit to @yorinasub17 ","bodyHTML":"<p dir=\"auto\">The single-server module only manages the root block device, and doesn’t provision/manage additional EBS block devices.</p>\n<p dir=\"auto\">One way you can avoid the destroy of block devices is by managing the EBS volume in a separate state file. E.g., create a module that manages the lifecycle of the EBS volume (these two blocks: <a href=\"https://github.com/gruntwork-io/terraform-aws-server/blob/master/examples/persistent-ebs-volume/main.tf#L62-L83\">https://github.com/gruntwork-io/terraform-aws-server/blob/master/examples/persistent-ebs-volume/main.tf#L62-L83</a>), and then use the <a href=\"https://github.com/gruntwork-io/terraform-aws-server/tree/master/modules/persistent-ebs-volume\">persistent-ebs-volume</a> script to manage mounting that volume on the EC2 instance.</p>\n<p dir=\"auto\">Since the EBS volume is mounted via the <code class=\"notranslate\">user_data</code> script, it should ensure that the volume is preserved even if you destroy the EC2 instance, and will remain until you destroy the other module that is managing the actual volume.</p>\n<p dir=\"auto\">credit to <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/yorinasub17/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yorinasub17\">@yorinasub17</a></p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "2a955fef6385a357387c29637b790577"
}
##DOCS-SOURCER-END -->
