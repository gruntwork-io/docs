---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/388" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How are the secrets generated in the Reference Architecture?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84APWvZ","number":388,"author":{"login":"yorinasub17"},"title":"How are the secrets generated in the Reference Architecture?","body":"I’m recreating one of the accounts. I see that secret names are hardcoded in `var/autogen/dev_vars.yaml`. But I don’t see how these secrets are created. It is said that value files generated from template. Is there a simple way to regenerate secrets?","bodyHTML":"<p dir=\"auto\">I’m recreating one of the accounts. I see that secret names are hardcoded in <code class=\"notranslate\">var/autogen/dev_vars.yaml</code>. But I don’t see how these secrets are created. It is said that value files generated from template. Is there a simple way to regenerate secrets?</p>","answer":{"body":"The Reference Architecture generates the following secrets, all of which are specific to the sample app:\r\n\r\n**RDS Database config**: a JSON structure containing the database engine, port, username, and password information. The password is a random 32 character string. You can use any process to generate this. Once the password is generated, you can encode the information in the following JSON, and then upload it to Secrets Manager:\r\n\r\n```\r\n{\r\n    \"engine\": \"mysql\",\r\n    \"port\": 3306,\r\n    \"username\": \"USERNAME\",\r\n    \"password\": \"PASSWORD\",\r\n    \"dbname\": \"DATABASE\"\r\n}\r\n```\r\n\r\n**TLS secrets**: a JSON structure containing a self-signed TLS certificate. You can use any process to generate the self-signed TLS certificates. If you would like a streamlined process, you can use the [tls-scripts](https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/tls-scripts) module in the Service Catalog. Note that the sample app expects two sets of self-signed certificates: one for the backend, and another for the frontend.\r\n\r\nOnce the self-signed certificates are generated, you can encode them in the following way for the sample apps:\r\n\r\n_frontend_\r\n```\r\n{\r\n    \"app\": {\r\n        \"ca\": \"RAW_PUBLIC_CERT_KEY_OF_FRONTEND_CA\",\r\n        \"crt\": \"RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND\",\r\n        \"key\": \"RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND\"\r\n    },\r\n    \"services\": {\r\n        \"backend\": \"RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA\"\r\n    }\r\n}\r\n```\r\n\r\n_backend_\r\n```\r\n{\r\n    \"app\": {\r\n        \"ca\": \"RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA\",\r\n        \"crt\": \"RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND\",\r\n        \"key\": \"RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND\"\r\n    }\r\n}\r\n```\r\n\r\n---\r\n\r\nSide note: At this time, we are not granting access to the `terraform-aws-architecture-catalog` where the templates for the Reference Architecture are hosted, and thus you will not be able to use the autogen vars directly to create a new environment. Please refer to [the reference architecture docs on adding a new account](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/docs/06-adding-a-new-account.md) for instructions on how to do this without the templates.","bodyHTML":"<p dir=\"auto\">The Reference Architecture generates the following secrets, all of which are specific to the sample app:</p>\n<p dir=\"auto\"><strong>RDS Database config</strong>: a JSON structure containing the database engine, port, username, and password information. The password is a random 32 character string. You can use any process to generate this. Once the password is generated, you can encode the information in the following JSON, and then upload it to Secrets Manager:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;engine&quot;: &quot;mysql&quot;,\n    &quot;port&quot;: 3306,\n    &quot;username&quot;: &quot;USERNAME&quot;,\n    &quot;password&quot;: &quot;PASSWORD&quot;,\n    &quot;dbname&quot;: &quot;DATABASE&quot;\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">{\n    \"engine\": \"mysql\",\n    \"port\": 3306,\n    \"username\": \"USERNAME\",\n    \"password\": \"PASSWORD\",\n    \"dbname\": \"DATABASE\"\n}\n</code></pre></div>\n<p dir=\"auto\"><strong>TLS secrets</strong>: a JSON structure containing a self-signed TLS certificate. You can use any process to generate the self-signed TLS certificates. If you would like a streamlined process, you can use the <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/tls-scripts\">tls-scripts</a> module in the Service Catalog. Note that the sample app expects two sets of self-signed certificates: one for the backend, and another for the frontend.</p>\n<p dir=\"auto\">Once the self-signed certificates are generated, you can encode them in the following way for the sample apps:</p>\n<p dir=\"auto\"><em>frontend</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;app&quot;: {\n        &quot;ca&quot;: &quot;RAW_PUBLIC_CERT_KEY_OF_FRONTEND_CA&quot;,\n        &quot;crt&quot;: &quot;RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND&quot;,\n        &quot;key&quot;: &quot;RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND&quot;\n    },\n    &quot;services&quot;: {\n        &quot;backend&quot;: &quot;RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA&quot;\n    }\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">{\n    \"app\": {\n        \"ca\": \"RAW_PUBLIC_CERT_KEY_OF_FRONTEND_CA\",\n        \"crt\": \"RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND\",\n        \"key\": \"RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_FRONTEND\"\n    },\n    \"services\": {\n        \"backend\": \"RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA\"\n    }\n}\n</code></pre></div>\n<p dir=\"auto\"><em>backend</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;app&quot;: {\n        &quot;ca&quot;: &quot;RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA&quot;,\n        &quot;crt&quot;: &quot;RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND&quot;,\n        &quot;key&quot;: &quot;RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND&quot;\n    }\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">{\n    \"app\": {\n        \"ca\": \"RAW_PUBLIC_CERT_KEY_OF_BACKEND_CA\",\n        \"crt\": \"RAW_PUBLIC_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND\",\n        \"key\": \"RAW_PRIVATE_CERT_KEY_OF_SELF_SIGNED_CERT_FOR_BACKEND\"\n    }\n}\n</code></pre></div>\n<hr>\n<p dir=\"auto\">Side note: At this time, we are not granting access to the <code class=\"notranslate\">terraform-aws-architecture-catalog</code> where the templates for the Reference Architecture are hosted, and thus you will not be able to use the autogen vars directly to create a new environment. Please refer to <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/examples/for-production/infrastructure-live/docs/06-adding-a-new-account.md\">the reference architecture docs on adding a new account</a> for instructions on how to do this without the templates.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "3152bed6f26b5e6ac798c24117b3787d"
}
##DOCS-SOURCER-END -->
