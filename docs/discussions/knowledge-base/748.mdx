---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/748" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Updates regarding the role trust policy evaluation change when a role assumes itself</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AUbwv","number":748,"author":{"login":"erictompkins"},"title":"Updates regarding the role trust policy evaluation change when a role assumes itself","body":"\nI received an email from AWS that I'm not sure what to do. Here is the email:\r\n\r\n```\r\nWe contacted you previously regarding an AWS Identity and Access Management (IAM) change delivered on September 21, 2022 that updated an aspect of how role trust policy evaluation behaves when a role assumes itself. With this change, role assumption always requires an explicit role trust policy grant. At that time, we identified one or more roles in this account relying on implicit trust when the role assumes itself. These roles were placed on a temporary allow list to prevent AssumeRole calls from being denied due to the new trust policy evaluation behavior. We advised you to make any necessary changes to your existing processes, code, or configurations to prepare for elimination of the implicit trust behavior. For more information about this behavior change in your account, please review additional details in the blog post \"Announcing an Update to IAM Role Trust Policy Behavior\" [1].\r\n\r\nOn February 3, 2023, we announced that starting June 30, 2023, all roles, regardless of allow list status, that attempt to assume themselves will fail with an access denied error unless the role trust policy explicitly grants the permission and the conditions and actions are satisfied.\r\n\r\nWe are contacting you again to announce that rather than enforcing an explicit trust grant for all roles regardless of allow list status starting June 30, 2023, we will instead automatically remove roles from the allow list based on observed role assumption behavior. Roles on the allow list that we observe either not performing role self-assumption or whose trust policy grants explicit trust with every role assumption over the previous 90 days or more are candidates for removal. A role that performs self-assumption without granting explicit trust at least once over the previous 90 days will be retained on the allow list to give you additional time to make the necessary code or configuration changes. As we announced on December 20, 2022, you can verify whether a specific role self-assumption call by an allow-listed role grants explicit trust by reviewing the corresponding CloudTrail entry and observing a value of “true” for the “explicitTrustGrant” flag.\r\n\r\nAutomatic removal of candidate roles from the allow list that match the criteria defined above begins on June 30, 2023. You may choose to remove a role from the allow list prior to its identification as a removal candidate if its role assumption behavior matches your use case expectations. For assistance with removing such roles from the allow list, please contact AWS Support [2].\r\n\r\nOnce a role is removed from the allow list, its role assumption calls will always require an explicit trust grant.\r\n```\r\nThey listed off a few IAM roles. One is an ECS role that was created with the terraform-aws-ecs modules/ecs-service library. \r\n\r\nThe ECS role has a permission policy called \"assume-role\"\r\n```\r\n{\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Sid\": \"\",\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": \"sts:AssumeRole\",\r\n            \"Resource\": \"arn:aws:iam::XXXXXXXXX:role/xxx-xxx-task\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nIt also has a trust policy:\r\n```\r\n{\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Sid\": \"\",\r\n            \"Effect\": \"Allow\",\r\n            \"Principal\": {\r\n                \"Service\": \"ecs-tasks.amazonaws.com\"\r\n            },\r\n            \"Action\": \"sts:AssumeRole\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nIs there something more that we need to do to explicitly allow the role to assume itself?\r\n\r\nThank you for your help.\n\n---\n\n<ins datetime=\"2023-06-30T19:36:04Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/110314\">Tracked in ticket #110314</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">I received an email from AWS that I'm not sure what to do. Here is the email:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"We contacted you previously regarding an AWS Identity and Access Management (IAM) change delivered on September 21, 2022 that updated an aspect of how role trust policy evaluation behaves when a role assumes itself. With this change, role assumption always requires an explicit role trust policy grant. At that time, we identified one or more roles in this account relying on implicit trust when the role assumes itself. These roles were placed on a temporary allow list to prevent AssumeRole calls from being denied due to the new trust policy evaluation behavior. We advised you to make any necessary changes to your existing processes, code, or configurations to prepare for elimination of the implicit trust behavior. For more information about this behavior change in your account, please review additional details in the blog post &quot;Announcing an Update to IAM Role Trust Policy Behavior&quot; [1].\n\nOn February 3, 2023, we announced that starting June 30, 2023, all roles, regardless of allow list status, that attempt to assume themselves will fail with an access denied error unless the role trust policy explicitly grants the permission and the conditions and actions are satisfied.\n\nWe are contacting you again to announce that rather than enforcing an explicit trust grant for all roles regardless of allow list status starting June 30, 2023, we will instead automatically remove roles from the allow list based on observed role assumption behavior. Roles on the allow list that we observe either not performing role self-assumption or whose trust policy grants explicit trust with every role assumption over the previous 90 days or more are candidates for removal. A role that performs self-assumption without granting explicit trust at least once over the previous 90 days will be retained on the allow list to give you additional time to make the necessary code or configuration changes. As we announced on December 20, 2022, you can verify whether a specific role self-assumption call by an allow-listed role grants explicit trust by reviewing the corresponding CloudTrail entry and observing a value of “true” for the “explicitTrustGrant” flag.\n\nAutomatic removal of candidate roles from the allow list that match the criteria defined above begins on June 30, 2023. You may choose to remove a role from the allow list prior to its identification as a removal candidate if its role assumption behavior matches your use case expectations. For assistance with removing such roles from the allow list, please contact AWS Support [2].\n\nOnce a role is removed from the allow list, its role assumption calls will always require an explicit trust grant.\"><pre class=\"notranslate\"><code class=\"notranslate\">We contacted you previously regarding an AWS Identity and Access Management (IAM) change delivered on September 21, 2022 that updated an aspect of how role trust policy evaluation behaves when a role assumes itself. With this change, role assumption always requires an explicit role trust policy grant. At that time, we identified one or more roles in this account relying on implicit trust when the role assumes itself. These roles were placed on a temporary allow list to prevent AssumeRole calls from being denied due to the new trust policy evaluation behavior. We advised you to make any necessary changes to your existing processes, code, or configurations to prepare for elimination of the implicit trust behavior. For more information about this behavior change in your account, please review additional details in the blog post \"Announcing an Update to IAM Role Trust Policy Behavior\" [1].\n\nOn February 3, 2023, we announced that starting June 30, 2023, all roles, regardless of allow list status, that attempt to assume themselves will fail with an access denied error unless the role trust policy explicitly grants the permission and the conditions and actions are satisfied.\n\nWe are contacting you again to announce that rather than enforcing an explicit trust grant for all roles regardless of allow list status starting June 30, 2023, we will instead automatically remove roles from the allow list based on observed role assumption behavior. Roles on the allow list that we observe either not performing role self-assumption or whose trust policy grants explicit trust with every role assumption over the previous 90 days or more are candidates for removal. A role that performs self-assumption without granting explicit trust at least once over the previous 90 days will be retained on the allow list to give you additional time to make the necessary code or configuration changes. As we announced on December 20, 2022, you can verify whether a specific role self-assumption call by an allow-listed role grants explicit trust by reviewing the corresponding CloudTrail entry and observing a value of “true” for the “explicitTrustGrant” flag.\n\nAutomatic removal of candidate roles from the allow list that match the criteria defined above begins on June 30, 2023. You may choose to remove a role from the allow list prior to its identification as a removal candidate if its role assumption behavior matches your use case expectations. For assistance with removing such roles from the allow list, please contact AWS Support [2].\n\nOnce a role is removed from the allow list, its role assumption calls will always require an explicit trust grant.\n</code></pre></div>\n<p dir=\"auto\">They listed off a few IAM roles. One is an ECS role that was created with the terraform-aws-ecs modules/ecs-service library.</p>\n<p dir=\"auto\">The ECS role has a permission policy called \"assume-role\"</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;Version&quot;: &quot;2012-10-17&quot;,\n    &quot;Statement&quot;: [\n        {\n            &quot;Sid&quot;: &quot;&quot;,\n            &quot;Effect&quot;: &quot;Allow&quot;,\n            &quot;Action&quot;: &quot;sts:AssumeRole&quot;,\n            &quot;Resource&quot;: &quot;arn:aws:iam::XXXXXXXXX:role/xxx-xxx-task&quot;\n        }\n    ]\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"sts:AssumeRole\",\n            \"Resource\": \"arn:aws:iam::XXXXXXXXX:role/xxx-xxx-task\"\n        }\n    ]\n}\n</code></pre></div>\n<p dir=\"auto\">It also has a trust policy:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;Version&quot;: &quot;2012-10-17&quot;,\n    &quot;Statement&quot;: [\n        {\n            &quot;Sid&quot;: &quot;&quot;,\n            &quot;Effect&quot;: &quot;Allow&quot;,\n            &quot;Principal&quot;: {\n                &quot;Service&quot;: &quot;ecs-tasks.amazonaws.com&quot;\n            },\n            &quot;Action&quot;: &quot;sts:AssumeRole&quot;\n        }\n    ]\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"ecs-tasks.amazonaws.com\"\n            },\n            \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\n</code></pre></div>\n<p dir=\"auto\">Is there something more that we need to do to explicitly allow the role to assume itself?</p>\n<p dir=\"auto\">Thank you for your help.</p>\n<hr>\n<ins datetime=\"2023-06-30T19:36:04Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/110314\" rel=\"nofollow\">Tracked in ticket #110314</a></p>\n</ins>","answer":{"body":"Thank for these details! this is very helpful, I added them to [the issue I created](https://github.com/gruntwork-io/terraform-aws-ecs/issues/399), but since you aren't having any negative effects I'm not going prioritize very highly it right now. Let me know if this starts causing any access denied issues though! ","bodyHTML":"<p dir=\"auto\">Thank for these details! this is very helpful, I added them to <a href=\"https://github.com/gruntwork-io/terraform-aws-ecs/issues/399\" data-hovercard-type=\"issue\" data-hovercard-url=\"/gruntwork-io/terraform-aws-ecs/issues/399/hovercard\">the issue I created</a>, but since you aren't having any negative effects I'm not going prioritize very highly it right now. Let me know if this starts causing any access denied issues though!</p>"}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "294bec91f128930096fc3046c7d2138f"
}
##DOCS-SOURCER-END -->
