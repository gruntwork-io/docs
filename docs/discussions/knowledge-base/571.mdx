---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/571" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Help to create structure</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84ARECG","number":571,"author":{"login":"GyroGearl00se"},"title":"Help to create structure","body":"\nHi Community,\r\n\r\nI'm looking for a way to manage multiple servers (each with the same application) with a \"terragrunt run-all plan/apply\".\r\n\r\nI've written my own terraform provider which is already working quite well. At the moment I'm stuck with the conception of the path structures and the automation part :)\r\n\r\nHere the idea:\r\n\r\n.\r\n├── instance\r\n│   ├── common_vars.hcl\r\n│   ├── dev\r\n│   │   ├── serverA\r\n│   │   │   └── terragrunt.hcl\r\n│   │   ├── serverB\r\n│   │   │   └── terragrunt.hcl\r\n│   │   ├── serverC\r\n│   │   │   └── terragrunt.hcl\r\n│   ├── prod\r\n│   │   ├── serverX\r\n│   │   │   └── terragrunt.hcl\r\n│   │   ├── serverY\r\n│   │   │   └── terragrunt.hcl\r\n│   │   ├── serverZ\r\n│   │   │   └── terragrunt.hcl\r\n├── main.tf\r\n└── terragrunt.hcl\r\n\r\n\r\nI was hoping I could define in the main.tf the provider and the required resources.\r\n\r\nIn the common_vars.hcl I was thinking to define default values for the resources.\r\n\r\nIn the terragrung.hcl in the subdirectories I'd like to define variables in case I want to override any from the common_vars.\r\n\r\n\r\nCan you please advise me if this expectation is doable with the way I'm approaching ? Or do I have to set it up differently ?\n\n---\n\n<ins datetime=\"2022-10-14T08:28:34Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109371\">Tracked in ticket #109371</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Hi Community,</p>\n<p dir=\"auto\">I'm looking for a way to manage multiple servers (each with the same application) with a \"terragrunt run-all plan/apply\".</p>\n<p dir=\"auto\">I've written my own terraform provider which is already working quite well. At the moment I'm stuck with the conception of the path structures and the automation part :)</p>\n<p dir=\"auto\">Here the idea:</p>\n<p dir=\"auto\">.<br>\n├── instance<br>\n│   ├── common_vars.hcl<br>\n│   ├── dev<br>\n│   │   ├── serverA<br>\n│   │   │   └── terragrunt.hcl<br>\n│   │   ├── serverB<br>\n│   │   │   └── terragrunt.hcl<br>\n│   │   ├── serverC<br>\n│   │   │   └── terragrunt.hcl<br>\n│   ├── prod<br>\n│   │   ├── serverX<br>\n│   │   │   └── terragrunt.hcl<br>\n│   │   ├── serverY<br>\n│   │   │   └── terragrunt.hcl<br>\n│   │   ├── serverZ<br>\n│   │   │   └── terragrunt.hcl<br>\n├── main.tf<br>\n└── terragrunt.hcl</p>\n<p dir=\"auto\">I was hoping I could define in the main.tf the provider and the required resources.</p>\n<p dir=\"auto\">In the common_vars.hcl I was thinking to define default values for the resources.</p>\n<p dir=\"auto\">In the terragrung.hcl in the subdirectories I'd like to define variables in case I want to override any from the common_vars.</p>\n<p dir=\"auto\">Can you please advise me if this expectation is doable with the way I'm approaching ? Or do I have to set it up differently ?</p>\n<hr>\n<ins datetime=\"2022-10-14T08:28:34Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109371\" rel=\"nofollow\">Tracked in ticket #109371</a></p>\n</ins>","answer":{"body":"Hi,\r\nto reduce duplications, `terraform` block and default inputs can be extracted in HCL file in the root directory:\r\n\r\n```\r\n# root.hcl\r\n# common terraform module\r\nterraform {\r\n  source = \"${get_terragrunt_dir()}/../module\"\r\n}\r\n\r\n# default input\r\ninputs = {\r\n  file = \"${get_terragrunt_dir()}/file.txt\"\r\n}\r\n\r\n# server1/terragrunt.hcl\r\n\r\ninclude \"root\" {\r\n  path = find_in_parent_folders(\"root.hcl\")\r\n}\r\n\r\ninputs = {\r\n  content = \"server1\"\r\n}\r\n\r\n# server2/terragrunt.hcl\r\n\r\ninclude \"root\" {\r\n  path = find_in_parent_folders(\"root.hcl\")\r\n}\r\n\r\ninputs = {\r\n  content = \"server2\"\r\n}\r\n\r\n```\r\nCreated simplified example in:  https://github.com/denis256/terragrunt-tests/tree/master/common-module\r\n","bodyHTML":"<p dir=\"auto\">Hi,<br>\nto reduce duplications, <code class=\"notranslate\">terraform</code> block and default inputs can be extracted in HCL file in the root directory:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# root.hcl\n# common terraform module\nterraform {\n  source = &quot;${get_terragrunt_dir()}/../module&quot;\n}\n\n# default input\ninputs = {\n  file = &quot;${get_terragrunt_dir()}/file.txt&quot;\n}\n\n# server1/terragrunt.hcl\n\ninclude &quot;root&quot; {\n  path = find_in_parent_folders(&quot;root.hcl&quot;)\n}\n\ninputs = {\n  content = &quot;server1&quot;\n}\n\n# server2/terragrunt.hcl\n\ninclude &quot;root&quot; {\n  path = find_in_parent_folders(&quot;root.hcl&quot;)\n}\n\ninputs = {\n  content = &quot;server2&quot;\n}\n\"><pre class=\"notranslate\"><code class=\"notranslate\"># root.hcl\n# common terraform module\nterraform {\n  source = \"${get_terragrunt_dir()}/../module\"\n}\n\n# default input\ninputs = {\n  file = \"${get_terragrunt_dir()}/file.txt\"\n}\n\n# server1/terragrunt.hcl\n\ninclude \"root\" {\n  path = find_in_parent_folders(\"root.hcl\")\n}\n\ninputs = {\n  content = \"server1\"\n}\n\n# server2/terragrunt.hcl\n\ninclude \"root\" {\n  path = find_in_parent_folders(\"root.hcl\")\n}\n\ninputs = {\n  content = \"server2\"\n}\n\n</code></pre></div>\n<p dir=\"auto\">Created simplified example in:  <a href=\"https://github.com/denis256/terragrunt-tests/tree/master/common-module\">https://github.com/denis256/terragrunt-tests/tree/master/common-module</a></p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "387a4b835ff4f6c38b0bd33106d78b67"
}
##DOCS-SOURCER-END -->
