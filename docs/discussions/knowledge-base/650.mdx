---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/650" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Bad GITHUB_OAUTH_TOKEN value error in Gruntwork CI/CD Pipelines or ECS Deploy Runner</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84ASTgW","number":650,"author":{"login":"zackproser"},"title":"Bad GITHUB_OAUTH_TOKEN value error in Gruntwork CI/CD Pipelines or ECS Deploy Runner","body":"A customer asked: \r\n> Hello There! We're getting this error on the CI/CD workflow:\r\n> \r\n```bash\r\n2023-01-27 16:18:51 [INFO] [gruntwork-install] Repository is not public. GITHUB_OAUTH_TOKEN environment variable is required.\r\n2023-01-27 16:18:51 [INFO] [gruntwork-install] Installing infrastructure-deployer...\r\n[fetch] time=\"2023-01-27T16:18:51Z\" level=error msg=\"\\nReceived an HTTP 401 Response when attempting to query the repo for its tags.\\n\\nThis means that either your GitHub oAuth Token is invalid, or that the token is valid but is being used to request access\\nto either a public repo or a private repo to which you don't have access.\\n\\nUnderlying error message:\\nReceived HTTP Response 401 while fetching releases for GitHub URL https://api.github.com/repos/gruntwork-io/terraform-aws-ci/tags?per_page=100. Full HTTP response: {\\\"message\\\":\\\"Bad credentials\\\",\\\"documentation_url\\\":\\\"https://docs.github.com/rest\\\"}\\n\\n\"\r\nError: Process completed with exit code 1.\r\n```\r\n> Does anyone have any idea what might be going on?\r\n> Thanks!","bodyHTML":"<p dir=\"auto\">A customer asked:</p>\n<blockquote>\n<p dir=\"auto\">Hello There! We're getting this error on the CI/CD workflow:</p>\n</blockquote>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"2023-01-27 16:18:51 [INFO] [gruntwork-install] Repository is not public. GITHUB_OAUTH_TOKEN environment variable is required.\n2023-01-27 16:18:51 [INFO] [gruntwork-install] Installing infrastructure-deployer...\n[fetch] time=&quot;2023-01-27T16:18:51Z&quot; level=error msg=&quot;\\nReceived an HTTP 401 Response when attempting to query the repo for its tags.\\n\\nThis means that either your GitHub oAuth Token is invalid, or that the token is valid but is being used to request access\\nto either a public repo or a private repo to which you don't have access.\\n\\nUnderlying error message:\\nReceived HTTP Response 401 while fetching releases for GitHub URL https://api.github.com/repos/gruntwork-io/terraform-aws-ci/tags?per_page=100. Full HTTP response: {\\&quot;message\\&quot;:\\&quot;Bad credentials\\&quot;,\\&quot;documentation_url\\&quot;:\\&quot;https://docs.github.com/rest\\&quot;}\\n\\n&quot;\nError: Process completed with exit code 1.\"><pre class=\"notranslate\">2023-01-27 16:18:51 [INFO] [gruntwork-install] Repository is not public. GITHUB_OAUTH_TOKEN environment variable is required.\n2023-01-27 16:18:51 [INFO] [gruntwork-install] Installing infrastructure-deployer...\n[fetch] time=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>2023-01-27T16:18:51Z<span class=\"pl-pds\">\"</span></span> level=error msg=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>\\nReceived an HTTP 401 Response when attempting to query the repo for its tags.\\n\\nThis means that either your GitHub oAuth Token is invalid, or that the token is valid but is being used to request access\\nto either a public repo or a private repo to which you don't have access.\\n\\nUnderlying error message:\\nReceived HTTP Response 401 while fetching releases for GitHub URL https://api.github.com/repos/gruntwork-io/terraform-aws-ci/tags?per_page=100. Full HTTP response: {<span class=\"pl-cce\">\\\"</span>message<span class=\"pl-cce\">\\\"</span>:<span class=\"pl-cce\">\\\"</span>Bad credentials<span class=\"pl-cce\">\\\"</span>,<span class=\"pl-cce\">\\\"</span>documentation_url<span class=\"pl-cce\">\\\"</span>:<span class=\"pl-cce\">\\\"</span>https://docs.github.com/rest<span class=\"pl-cce\">\\\"</span>}\\n\\n<span class=\"pl-pds\">\"</span></span>\nError: Process completed with <span class=\"pl-c1\">exit</span> code 1.</pre></div>\n<blockquote>\n<p dir=\"auto\">Does anyone have any idea what might be going on?<br>\nThanks!</p>\n</blockquote>","answer":{"body":"The following Gruntworks products use the same general pattern for securely accessing your GitHub repositories when performing a CI/CD job, without dangerously including your secrets in your Docker images or version control: \r\n\r\n* [ECS Deploy Runner](https://docs.gruntwork.io/reference/services/ci-cd-pipeline/ecs-deploy-runner)\r\n* [Pipelines](https://gruntwork.io/pipelines/)\r\n\r\n# General access pattern leveraging a GitHub Personal Access Token\r\n\r\n1. Your machine user's (CI/CD user's) GitHub Personal Access Token (PAT) is stored in AWS Secrets Manager within your Reference Architecture's shared account \r\n2. At runtime, ECS Deploy Runner / Pipelines fetches your GitHub PAT from Secrets Manager and makes it available to the running ECS task. In this way, we load your secret \"just in time\" and it only exists ephemerally within the volatile memory of the running ECS container. \r\n3. The GitHub PAT is used to perform `git` operations such as cloning your infrastructure-live repository into your running task's ECS container so that can be operated on by your pipeline\r\n\r\nTherefore, if you're encountering this error, it means that you need to ensure two different things about your token: \r\n1. [Ensure that your GitHub PAT is valid](https://github.com/gruntwork-io/knowledge-base/discussions/642)\r\n2. [Ensure that your GitHub PAT has the correct scopes attached to it](https://github.com/gruntwork-io/knowledge-base/discussions/643)\r\n\r\nPlease see the linked KB posts to each for guides and demos on how to quickly confirm if either situation applies to your token. ","bodyHTML":"<p dir=\"auto\">The following Gruntworks products use the same general pattern for securely accessing your GitHub repositories when performing a CI/CD job, without dangerously including your secrets in your Docker images or version control:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://docs.gruntwork.io/reference/services/ci-cd-pipeline/ecs-deploy-runner\" rel=\"nofollow\">ECS Deploy Runner</a></li>\n<li><a href=\"https://gruntwork.io/pipelines/\" rel=\"nofollow\">Pipelines</a></li>\n</ul>\n<h1 dir=\"auto\">General access pattern leveraging a GitHub Personal Access Token</h1>\n<ol dir=\"auto\">\n<li>Your machine user's (CI/CD user's) GitHub Personal Access Token (PAT) is stored in AWS Secrets Manager within your Reference Architecture's shared account</li>\n<li>At runtime, ECS Deploy Runner / Pipelines fetches your GitHub PAT from Secrets Manager and makes it available to the running ECS task. In this way, we load your secret \"just in time\" and it only exists ephemerally within the volatile memory of the running ECS container.</li>\n<li>The GitHub PAT is used to perform <code class=\"notranslate\">git</code> operations such as cloning your infrastructure-live repository into your running task's ECS container so that can be operated on by your pipeline</li>\n</ol>\n<p dir=\"auto\">Therefore, if you're encountering this error, it means that you need to ensure two different things about your token:</p>\n<ol dir=\"auto\">\n<li><a href=\"https://github.com/gruntwork-io/knowledge-base/discussions/642\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/gruntwork-io/knowledge-base/discussions/642/hovercard\">Ensure that your GitHub PAT is valid</a></li>\n<li><a href=\"https://github.com/gruntwork-io/knowledge-base/discussions/643\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/gruntwork-io/knowledge-base/discussions/643/hovercard\">Ensure that your GitHub PAT has the correct scopes attached to it</a></li>\n</ol>\n<p dir=\"auto\">Please see the linked KB posts to each for guides and demos on how to quickly confirm if either situation applies to your token.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "aa834c541a32ae63738a3aa96db0fa5d"
}
##DOCS-SOURCER-END -->
