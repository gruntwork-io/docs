---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/232" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Error with empty `skip-ci-flag` argument</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AO50w","number":232,"author":{"login":"marinalimeira"},"title":"Error with empty `skip-ci-flag` argument","body":"We're trying to use some of the ecs deploy runner set pieces to update our lambda versions by their s3 object tag. We're using very similar `update_args` as we'd find in our scripts that update our ecs applications:\r\n```bash\r\n# Invoke the ECS deploy runner using infrastructure-deployer to commit an update to the terragrunt configuration to\r\n# deploy the newly built image. This commit will trigger the infrastructure CI/CD workflow to deploy the image.\r\nfunction deploy_lambda_image {\r\n  local -r lambda_version=\"$1\"\r\n  local -r deploy_path=\"$2\"\r\n  local -r lambda_tag_varname=\"$3\"\r\n\r\n  local -a update_args=(--aws-region \"$REGION\" --)\r\n  update_args+=(terraform-applier terraform-update-variable)\r\n  update_args+=(--git-branch-name \"$DEFAULT_INFRA_LIVE_BRANCH\")\r\n  update_args+=(--vars-path \"$deploy_path/terragrunt.hcl\")\r\n  update_args+=(--name \"$lambda_tag_varname\" --value \"\\\"$lambda_version\\\"\")\r\n  update_args+=(--skip-ci-flag \"\")\r\n  (eval infrastructure-deployer \"${update_args[@]}\")\r\n}\r\n```\r\nSomething is odd with `skip-ci-flag` I believe. We get this error when the value is empty string:\r\n```ERROR: IndexError: pop from an empty deque```\r\nOnce we add some arbitrary string, it works, but in our other scripts, that field is not set. can anyone shed light on what we're missing? Thanks!\r\nThe error is coming from the python ecs runner invoker lambda.\r\nSecondly, when we get past the skip-ci-flag error, it seems that the quotes around our lambda s3 object version are being stripped off. We're investigating whether this could be a script issue on our side...","bodyHTML":"<p dir=\"auto\">We're trying to use some of the ecs deploy runner set pieces to update our lambda versions by their s3 object tag. We're using very similar <code class=\"notranslate\">update_args</code> as we'd find in our scripts that update our ecs applications:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Invoke the ECS deploy runner using infrastructure-deployer to commit an update to the terragrunt configuration to\n# deploy the newly built image. This commit will trigger the infrastructure CI/CD workflow to deploy the image.\nfunction deploy_lambda_image {\n  local -r lambda_version=&quot;$1&quot;\n  local -r deploy_path=&quot;$2&quot;\n  local -r lambda_tag_varname=&quot;$3&quot;\n\n  local -a update_args=(--aws-region &quot;$REGION&quot; --)\n  update_args+=(terraform-applier terraform-update-variable)\n  update_args+=(--git-branch-name &quot;$DEFAULT_INFRA_LIVE_BRANCH&quot;)\n  update_args+=(--vars-path &quot;$deploy_path/terragrunt.hcl&quot;)\n  update_args+=(--name &quot;$lambda_tag_varname&quot; --value &quot;\\&quot;$lambda_version\\&quot;&quot;)\n  update_args+=(--skip-ci-flag &quot;&quot;)\n  (eval infrastructure-deployer &quot;${update_args[@]}&quot;)\n}\"><pre class=\"notranslate\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> Invoke the ECS deploy runner using infrastructure-deployer to commit an update to the terragrunt configuration to</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> deploy the newly built image. This commit will trigger the infrastructure CI/CD workflow to deploy the image.</span>\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">deploy_lambda_image</span> {\n  <span class=\"pl-k\">local</span> -r lambda_version=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$1</span><span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-k\">local</span> -r deploy_path=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$2</span><span class=\"pl-pds\">\"</span></span>\n  <span class=\"pl-k\">local</span> -r lambda_tag_varname=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$3</span><span class=\"pl-pds\">\"</span></span>\n\n  <span class=\"pl-k\">local</span> -a update_args=(--aws-region <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$REGION</span><span class=\"pl-pds\">\"</span></span> --)\n  update_args+=(terraform-applier terraform-update-variable)\n  update_args+=(--git-branch-name <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$DEFAULT_INFRA_LIVE_BRANCH</span><span class=\"pl-pds\">\"</span></span>)\n  update_args+=(--vars-path <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$deploy_path</span>/terragrunt.hcl<span class=\"pl-pds\">\"</span></span>)\n  update_args+=(--name <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$lambda_tag_varname</span><span class=\"pl-pds\">\"</span></span> --value <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-cce\">\\\"</span><span class=\"pl-smi\">$lambda_version</span><span class=\"pl-cce\">\\\"</span><span class=\"pl-pds\">\"</span></span>)\n  update_args+=(--skip-ci-flag <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>)\n  (eval infrastructure-deployer <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${update_args[@]}</span><span class=\"pl-pds\">\"</span></span>)\n}</pre></div>\n<p dir=\"auto\">Something is odd with <code class=\"notranslate\">skip-ci-flag</code> I believe. We get this error when the value is empty string:<br>\n<code class=\"notranslate\">ERROR: IndexError: pop from an empty deque</code><br>\nOnce we add some arbitrary string, it works, but in our other scripts, that field is not set. can anyone shed light on what we're missing? Thanks!<br>\nThe error is coming from the python ecs runner invoker lambda.<br>\nSecondly, when we get past the skip-ci-flag error, it seems that the quotes around our lambda s3 object version are being stripped off. We're investigating whether this could be a script issue on our side...</p>","answer":{"body":"The `[ci skip]` is a feature [from CircleCI to skip the build](https://circleci.com/docs/2.0/skip-build/). Is that what you what? Do you need to skip the build or not?","bodyHTML":"<p dir=\"auto\">The <code class=\"notranslate\">[ci skip]</code> is a feature <a href=\"https://circleci.com/docs/2.0/skip-build/\" rel=\"nofollow\">from CircleCI to skip the build</a>. Is that what you what? Do you need to skip the build or not?</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "abe4d48649b12b00bdc97a8889040a1c"
}
##DOCS-SOURCER-END -->
