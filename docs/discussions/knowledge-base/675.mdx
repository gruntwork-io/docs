---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/675" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How do I prevent gruntwork pipelines from running in specific folders or modules?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84ASyGF","number":675,"author":{"login":"ellisonc"},"title":"How do I prevent gruntwork pipelines from running in specific folders or modules?","body":"\nIs there a supported way of skipping Gruntwork Pipeline runs to a specific account, folder, or module?  For example if I add an account that I want to manage outside of pipelines it will try to run and error out since the new account has no ECS Deploy Runner.\r\n\n\n---\n\n<ins datetime=\"2023-03-03T18:15:25Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109950\">Tracked in ticket #109950</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Is there a supported way of skipping Gruntwork Pipeline runs to a specific account, folder, or module?  For example if I add an account that I want to manage outside of pipelines it will try to run and error out since the new account has no ECS Deploy Runner.</p>\n<hr>\n<ins datetime=\"2023-03-03T18:15:25Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109950\" rel=\"nofollow\">Tracked in ticket #109950</a></p>\n</ins>","answer":{"body":"If you're using the default setup you should have a script located at `_ci/scripts/deploy-infra.sh` It's responsible for detecting changes and deciding which deployer commands to run.  You should be able to add a new condition to the `route` function to skip specific modules.  By default this feature is used to exclude the `ecs-deploy-runner` from updating itself as shown below:\r\n\r\n```\r\nfunction route {\r\n  local -r updated_folder=\"$1\"\r\n\r\n  # Add to this condition if you have other modules you do not want to manage with ECS deploy runner.\r\n  if [[ \"$updated_folder\" == \".\" ]]; then\r\n    echo \"WARNING: A configuration in the repository root has changed. Because this could potentially impact many configurations, an operator must run a plan-all or apply-all manually in each account.\"\r\n  # As of bash 3.2, do not use double quotes around regular expressions.\r\n  elif [[ \"$updated_folder\" =~ ^.+/ecs-deploy-runner(/.+)?$ ]]; then\r\n    echo \"No action defined for changes to $updated_folder.\"\r\n  elif [[ \"$updated_folder\" =~ ^_envcommon/mgmt/ecs-deploy-runner.hcl$ ]]; then\r\n    echo \"No action defined for changes to $updated_folder.\"\r\n  else\r\n    invoke_infrastructure_deployer \"$@\"\r\n  fi\r\n}\r\n```\r\n\r\nFor example, you might add the following elif statement to prevent running plan and apply on any folders including `my-excluded-module`\r\n```\r\nelif [[ \"$updated_folder\" =~ ^.+/my-excluded-module(/.+)?$ ]]; then\r\n  echo \"No action\"\r\n```","bodyHTML":"<p dir=\"auto\">If you're using the default setup you should have a script located at <code class=\"notranslate\">_ci/scripts/deploy-infra.sh</code> It's responsible for detecting changes and deciding which deployer commands to run.  You should be able to add a new condition to the <code class=\"notranslate\">route</code> function to skip specific modules.  By default this feature is used to exclude the <code class=\"notranslate\">ecs-deploy-runner</code> from updating itself as shown below:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"function route {\n  local -r updated_folder=&quot;$1&quot;\n\n  # Add to this condition if you have other modules you do not want to manage with ECS deploy runner.\n  if [[ &quot;$updated_folder&quot; == &quot;.&quot; ]]; then\n    echo &quot;WARNING: A configuration in the repository root has changed. Because this could potentially impact many configurations, an operator must run a plan-all or apply-all manually in each account.&quot;\n  # As of bash 3.2, do not use double quotes around regular expressions.\n  elif [[ &quot;$updated_folder&quot; =~ ^.+/ecs-deploy-runner(/.+)?$ ]]; then\n    echo &quot;No action defined for changes to $updated_folder.&quot;\n  elif [[ &quot;$updated_folder&quot; =~ ^_envcommon/mgmt/ecs-deploy-runner.hcl$ ]]; then\n    echo &quot;No action defined for changes to $updated_folder.&quot;\n  else\n    invoke_infrastructure_deployer &quot;$@&quot;\n  fi\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">function route {\n  local -r updated_folder=\"$1\"\n\n  # Add to this condition if you have other modules you do not want to manage with ECS deploy runner.\n  if [[ \"$updated_folder\" == \".\" ]]; then\n    echo \"WARNING: A configuration in the repository root has changed. Because this could potentially impact many configurations, an operator must run a plan-all or apply-all manually in each account.\"\n  # As of bash 3.2, do not use double quotes around regular expressions.\n  elif [[ \"$updated_folder\" =~ ^.+/ecs-deploy-runner(/.+)?$ ]]; then\n    echo \"No action defined for changes to $updated_folder.\"\n  elif [[ \"$updated_folder\" =~ ^_envcommon/mgmt/ecs-deploy-runner.hcl$ ]]; then\n    echo \"No action defined for changes to $updated_folder.\"\n  else\n    invoke_infrastructure_deployer \"$@\"\n  fi\n}\n</code></pre></div>\n<p dir=\"auto\">For example, you might add the following elif statement to prevent running plan and apply on any folders including <code class=\"notranslate\">my-excluded-module</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"elif [[ &quot;$updated_folder&quot; =~ ^.+/my-excluded-module(/.+)?$ ]]; then\n  echo &quot;No action&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">elif [[ \"$updated_folder\" =~ ^.+/my-excluded-module(/.+)?$ ]]; then\n  echo \"No action\"\n</code></pre></div>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "5fc769f13154495ebc046a5b68e251d6"
}
##DOCS-SOURCER-END -->
