---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/303" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Upgrading Kubernetes and Terraform</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84APDJ-","number":303,"author":{"login":"pete0emerson"},"title":"Upgrading Kubernetes and Terraform","body":"<!-- slack:https://gruntwork-io.slack.com/archives/C0164GRE0RW/p1647539603977229 -->\r\nWe are plotting our course through kubernetes upgrades from `v1.18` to `v1.21` to catch ourselves up before AWS EKS support ends and are currently using `v0.30.0` of the terraform-aws-eks module. What do you recommend for our approach?\r\n\r\n1. Should we stay lock-step in line with the module's default kubernetes version and handle the TF upgrades along the way to `0.14`, `0.15`, `1.0.x`..\r\n2. E.g.\r\n3. k8s `v1.19` TF >= `0.12.0` module `v0.33.0`\r\n4. k8s `v1.20` TF >= `0.15.0` module `v0.40.0`\r\n5. k8s `v1.21` TF >= `1.0.0` module `v0.44.0`\r\n6. Or is there some support for a more flexible approach where we override the module's default kubernetes version to `v1.21` while remaining on the older module version and handle the module + TF upgrades separately afterwards?\r\n","bodyHTML":"\n<p dir=\"auto\">We are plotting our course through kubernetes upgrades from <code class=\"notranslate\">v1.18</code> to <code class=\"notranslate\">v1.21</code> to catch ourselves up before AWS EKS support ends and are currently using <code class=\"notranslate\">v0.30.0</code> of the terraform-aws-eks module. What do you recommend for our approach?</p>\n<ol dir=\"auto\">\n<li>Should we stay lock-step in line with the module's default kubernetes version and handle the TF upgrades along the way to <code class=\"notranslate\">0.14</code>, <code class=\"notranslate\">0.15</code>, <code class=\"notranslate\">1.0.x</code>..</li>\n<li>E.g.</li>\n<li>k8s <code class=\"notranslate\">v1.19</code> TF &gt;= <code class=\"notranslate\">0.12.0</code> module <code class=\"notranslate\">v0.33.0</code></li>\n<li>k8s <code class=\"notranslate\">v1.20</code> TF &gt;= <code class=\"notranslate\">0.15.0</code> module <code class=\"notranslate\">v0.40.0</code></li>\n<li>k8s <code class=\"notranslate\">v1.21</code> TF &gt;= <code class=\"notranslate\">1.0.0</code> module <code class=\"notranslate\">v0.44.0</code></li>\n<li>Or is there some support for a more flexible approach where we override the module's default kubernetes version to <code class=\"notranslate\">v1.21</code> while remaining on the older module version and handle the module + TF upgrades separately afterwards?</li>\n</ol>","answer":{"body":"`terraform-aws-eks` version `v0.30.0` is known to work with Terraform `1.0.x` and Kubernetes `v1.21` (provided you have `kubergrunt` version `v0.8.0` installed and available on the machine deploying). Given that, we recommend updating each in isolation, starting with `terraform` version and then moving on to upgrading the kubernetes version, before ending with upgrading the module versions.\r\n\r\nSince you are already on `terraform-aws-eks` version `v0.30.0`, upgrading the Terraform version should be fairly straight forward. Note that you will need to upgrade the `terraform` version one minor version at a time. That is, you will need to update your local CLI to terraform `0.13.x`, run `terraform apply`, and only after `apply` is successful do you update the CLI to version `0.14.x` and so on.\r\n\r\nFor upgrading Kubernetes versions, you can refer to our docs, [How do I upgrade the Kubernetes Version of the cluster?](https://github.com/gruntwork-io/terraform-aws-eks/tree/v0.30.0/modules/eks-cluster-control-plane#how-do-i-upgrade-the-kubernetes-version-of-the-cluster).\r\n\r\nFinally, when upgrading the module versions, refer to our docs, [Updating to new versions](https://docs.gruntwork.io/guides/working-with-code/versioning/#updating-to-new-versions).","bodyHTML":"<p dir=\"auto\"><code class=\"notranslate\">terraform-aws-eks</code> version <code class=\"notranslate\">v0.30.0</code> is known to work with Terraform <code class=\"notranslate\">1.0.x</code> and Kubernetes <code class=\"notranslate\">v1.21</code> (provided you have <code class=\"notranslate\">kubergrunt</code> version <code class=\"notranslate\">v0.8.0</code> installed and available on the machine deploying). Given that, we recommend updating each in isolation, starting with <code class=\"notranslate\">terraform</code> version and then moving on to upgrading the kubernetes version, before ending with upgrading the module versions.</p>\n<p dir=\"auto\">Since you are already on <code class=\"notranslate\">terraform-aws-eks</code> version <code class=\"notranslate\">v0.30.0</code>, upgrading the Terraform version should be fairly straight forward. Note that you will need to upgrade the <code class=\"notranslate\">terraform</code> version one minor version at a time. That is, you will need to update your local CLI to terraform <code class=\"notranslate\">0.13.x</code>, run <code class=\"notranslate\">terraform apply</code>, and only after <code class=\"notranslate\">apply</code> is successful do you update the CLI to version <code class=\"notranslate\">0.14.x</code> and so on.</p>\n<p dir=\"auto\">For upgrading Kubernetes versions, you can refer to our docs, <a href=\"https://github.com/gruntwork-io/terraform-aws-eks/tree/v0.30.0/modules/eks-cluster-control-plane#how-do-i-upgrade-the-kubernetes-version-of-the-cluster\">How do I upgrade the Kubernetes Version of the cluster?</a>.</p>\n<p dir=\"auto\">Finally, when upgrading the module versions, refer to our docs, <a href=\"https://docs.gruntwork.io/guides/working-with-code/versioning/#updating-to-new-versions\" rel=\"nofollow\">Updating to new versions</a>.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "ec8d56a464ebc93ac0f2f226d1c6ddad"
}
##DOCS-SOURCER-END -->
