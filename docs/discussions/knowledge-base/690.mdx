---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/690" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How to configure terragrunt when terraform modules are in individual repos?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84ATHRk","number":690,"author":{"login":"dsantanu"},"title":"How to configure terragrunt when terraform modules are in individual repos?","body":"\r\nDear all,\r\nI had a single terraform repo with all of the modules in there. but now I have started seperatring 'em inn their individual repos and terragrunt fails to run.\r\n\r\nSay, I have two modules, named: `tf-service-moda` and `tf-service-modb` as two seperate git repos and all of the terragrunt stuff in a diffrent repo, called: `tg-modules`. `modb` is dependent on `modb`. This is sample file-system:\r\n```\r\n.\r\n├── services\r\n│   ├── tf-service-moda\r\n│   │   ├── file1.tf\r\n│   │   └── file2.tf\r\n│   └── tf-service-modb\r\n│       ├── file1.tf\r\n│       └── file2.tf\r\n└── tg-modules\r\n    ├── global.yaml\r\n    ├── moda\r\n    │   ├── terragrunt.hcl\r\n    │   └── variables.yaml\r\n    └── modb\r\n        ├── terragrunt.hcl\r\n        └── variables.yaml\r\n```\r\nBelow are the sample config files....\r\n#### global.yaml:\r\n```\r\n---\r\nmodule_branch: master\r\ntf_repo_pfx: \"https://git-codecommit.us-west-2.amazonaws.com/v1/repos/tf-service\"\r\n```\r\n#### moda/terragrunt.hcl:\r\n```\r\ninclude {\r\n  path = find_in_parent_folders()\r\n}\r\n\r\nlocals {\r\n  module_name = \"moda\"\r\n\r\n  values = merge(\r\n    yamldecode(file(find_in_parent_folders(\"global.yaml\"))),\r\n    yamldecode(file(\"variables.yaml\")),\r\n  )\r\n}\r\n\r\ninputs = merge(\r\n  local.values,\r\n)\r\n\r\nterraform {\r\n  source = \"${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}\"\r\n}\r\n```\r\n#### modb/terragrunt.hcl:\r\n```\r\ninclude {\r\n  path = find_in_parent_folders()\r\n}\r\n\r\nlocals {\r\n  module_name = \"modb\"\r\n\r\n  values = merge(\r\n    yamldecode(file(find_in_parent_folders(\"global.yaml\"))),\r\n    yamldecode(file(\"variables.yaml\")),\r\n  )\r\n}\r\n\r\ndependency \"moda\" {\r\n  config_path = \"../moda\"\r\n}\r\n\r\ndependencies {\r\n  paths = [\"../moda\"]\r\n}\r\n\r\nterraform {\r\n  source = \"${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}\"\r\n}\r\n```\r\n\r\nwith this, if I run terragrunt with ~~--terragrunt-source /repos/services//modb~~ `-terragrunt-source /repos/services//tf-service-modb`  all work okay but fit I do just `terragrunt plan` to let it downloaded directly from git, it fails with this:\r\n\r\n```\r\nSantanu Dasd83436b64af6142517947f0b26bb5772d0ab810bWARN[0000] No double-slash (//) found in source URL /v1/repos/tf-service-moda. Relative paths in downloaded Terraform code may not work.  prefix=[/home/santanu/repos/tg-modules/moda]\r\n ERRO[0001] 1 error occurred:\r\n \t* bad response code: 401\r\n \r\n ERRO[0001] Unable to determine underlying exit code, so Terragrunt will exit with error code 1\r\n```\r\nHow do I fix this? What am I missing here? really appreciate any help.\r\n\r\n-S\r\n\r\n---\r\n\r\n<ins datetime=\"2023-03-27T19:03:50Z\">\r\n  <p><a href=\"https://support.gruntwork.io/hc/requests/110029\">Tracked in ticket #110029</a></p>\r\n</ins>\r\n","bodyHTML":"<p dir=\"auto\">Dear all,<br>\nI had a single terraform repo with all of the modules in there. but now I have started seperatring 'em inn their individual repos and terragrunt fails to run.</p>\n<p dir=\"auto\">Say, I have two modules, named: <code class=\"notranslate\">tf-service-moda</code> and <code class=\"notranslate\">tf-service-modb</code> as two seperate git repos and all of the terragrunt stuff in a diffrent repo, called: <code class=\"notranslate\">tg-modules</code>. <code class=\"notranslate\">modb</code> is dependent on <code class=\"notranslate\">modb</code>. This is sample file-system:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\".\n├── services\n│   ├── tf-service-moda\n│   │   ├── file1.tf\n│   │   └── file2.tf\n│   └── tf-service-modb\n│       ├── file1.tf\n│       └── file2.tf\n└── tg-modules\n    ├── global.yaml\n    ├── moda\n    │   ├── terragrunt.hcl\n    │   └── variables.yaml\n    └── modb\n        ├── terragrunt.hcl\n        └── variables.yaml\"><pre class=\"notranslate\"><code class=\"notranslate\">.\n├── services\n│   ├── tf-service-moda\n│   │   ├── file1.tf\n│   │   └── file2.tf\n│   └── tf-service-modb\n│       ├── file1.tf\n│       └── file2.tf\n└── tg-modules\n    ├── global.yaml\n    ├── moda\n    │   ├── terragrunt.hcl\n    │   └── variables.yaml\n    └── modb\n        ├── terragrunt.hcl\n        └── variables.yaml\n</code></pre></div>\n<p dir=\"auto\">Below are the sample config files....</p>\n<h4 dir=\"auto\">global.yaml:</h4>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"---\nmodule_branch: master\ntf_repo_pfx: &quot;https://git-codecommit.us-west-2.amazonaws.com/v1/repos/tf-service&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">---\nmodule_branch: master\ntf_repo_pfx: \"https://git-codecommit.us-west-2.amazonaws.com/v1/repos/tf-service\"\n</code></pre></div>\n<h4 dir=\"auto\">moda/terragrunt.hcl:</h4>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"include {\n  path = find_in_parent_folders()\n}\n\nlocals {\n  module_name = &quot;moda&quot;\n\n  values = merge(\n    yamldecode(file(find_in_parent_folders(&quot;global.yaml&quot;))),\n    yamldecode(file(&quot;variables.yaml&quot;)),\n  )\n}\n\ninputs = merge(\n  local.values,\n)\n\nterraform {\n  source = &quot;${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}&quot;\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">include {\n  path = find_in_parent_folders()\n}\n\nlocals {\n  module_name = \"moda\"\n\n  values = merge(\n    yamldecode(file(find_in_parent_folders(\"global.yaml\"))),\n    yamldecode(file(\"variables.yaml\")),\n  )\n}\n\ninputs = merge(\n  local.values,\n)\n\nterraform {\n  source = \"${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}\"\n}\n</code></pre></div>\n<h4 dir=\"auto\">modb/terragrunt.hcl:</h4>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"include {\n  path = find_in_parent_folders()\n}\n\nlocals {\n  module_name = &quot;modb&quot;\n\n  values = merge(\n    yamldecode(file(find_in_parent_folders(&quot;global.yaml&quot;))),\n    yamldecode(file(&quot;variables.yaml&quot;)),\n  )\n}\n\ndependency &quot;moda&quot; {\n  config_path = &quot;../moda&quot;\n}\n\ndependencies {\n  paths = [&quot;../moda&quot;]\n}\n\nterraform {\n  source = &quot;${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}&quot;\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">include {\n  path = find_in_parent_folders()\n}\n\nlocals {\n  module_name = \"modb\"\n\n  values = merge(\n    yamldecode(file(find_in_parent_folders(\"global.yaml\"))),\n    yamldecode(file(\"variables.yaml\")),\n  )\n}\n\ndependency \"moda\" {\n  config_path = \"../moda\"\n}\n\ndependencies {\n  paths = [\"../moda\"]\n}\n\nterraform {\n  source = \"${local.values.tf_repo_pfx}-${local.module_name}?ref=${local.values.module_branch}\"\n}\n</code></pre></div>\n<p dir=\"auto\">with this, if I run terragrunt with <del>--terragrunt-source /repos/services//modb</del> <code class=\"notranslate\">-terragrunt-source /repos/services//tf-service-modb</code>  all work okay but fit I do just <code class=\"notranslate\">terragrunt plan</code> to let it downloaded directly from git, it fails with this:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Santanu Dasd83436b64af6142517947f0b26bb5772d0ab810bWARN[0000] No double-slash (//) found in source URL /v1/repos/tf-service-moda. Relative paths in downloaded Terraform code may not work.  prefix=[/home/santanu/repos/tg-modules/moda]\n ERRO[0001] 1 error occurred:\n \t* bad response code: 401\n \n ERRO[0001] Unable to determine underlying exit code, so Terragrunt will exit with error code 1\"><pre class=\"notranslate\"><code class=\"notranslate\">Santanu Dasd83436b64af6142517947f0b26bb5772d0ab810bWARN[0000] No double-slash (//) found in source URL /v1/repos/tf-service-moda. Relative paths in downloaded Terraform code may not work.  prefix=[/home/santanu/repos/tg-modules/moda]\n ERRO[0001] 1 error occurred:\n \t* bad response code: 401\n \n ERRO[0001] Unable to determine underlying exit code, so Terragrunt will exit with error code 1\n</code></pre></div>\n<p dir=\"auto\">How do I fix this? What am I missing here? really appreciate any help.</p>\n<p dir=\"auto\">-S</p>\n<hr>\n<ins datetime=\"2023-03-27T19:03:50Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/110029\" rel=\"nofollow\">Tracked in ticket #110029</a></p>\n</ins>","answer":{"body":"okay, finally figured out what was overlooked: The value for `tf_repo_pfx` MUST be prefixed with `git::`, for Terraform to process arbitrary Git repositories\r\n```\r\ntf_repo_pfx: \"git::https://github.com/dsantanu/tf-sample\"\r\n```\r\nThe above repo works just fine, if `tf_repo_pfx`(in global.yaml) is updated with `git::` prefix.","bodyHTML":"<p dir=\"auto\">okay, finally figured out what was overlooked: The value for <code class=\"notranslate\">tf_repo_pfx</code> MUST be prefixed with <code class=\"notranslate\">git::</code>, for Terraform to process arbitrary Git repositories</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"tf_repo_pfx: &quot;git::https://github.com/dsantanu/tf-sample&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">tf_repo_pfx: \"git::https://github.com/dsantanu/tf-sample\"\n</code></pre></div>\n<p dir=\"auto\">The above repo works just fine, if <code class=\"notranslate\">tf_repo_pfx</code>(in global.yaml) is updated with <code class=\"notranslate\">git::</code> prefix.</p>"}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "5e1941c4bf73dcdf65407ecc7ac9cbff"
}
##DOCS-SOURCER-END -->
