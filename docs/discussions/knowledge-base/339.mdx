---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/339" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Spinning up an EKS cluster - Inconsistent conditional result types</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84APN8Y","number":339,"author":{"login":"pete0emerson"},"title":"Spinning up an EKS cluster - Inconsistent conditional result types","body":"Using terraform 1.1.0 and service-catalog v0.68.8:\r\n\r\n```\r\n│ Error: Inconsistent conditional result types\r\n│\r\n│   on .terraform/modules/eks.eks_workers.self_managed_workers/modules/eks-cluster-workers/main.tf line 336, in locals:\r\n│  335:     length(data.aws_iam_role.existing) > 0\r\n│  336:     ? data.aws_iam_role.existing[0]\r\n│  337:     : (\r\n│  338:       length(aws_iam_role.eks_worker) > 0\r\n│  339:       ? aws_iam_role.eks_worker[0]\r\n│  340:       : null\r\n│  341:     )\r\n│     ├────────────────\r\n│     │ aws_iam_role.eks_worker is a list of object, known only after apply\r\n│     │ aws_iam_role.eks_worker[0] is a object, known only after apply\r\n│     │ data.aws_iam_role.existing is a list of object, known only after apply\r\n│     │ data.aws_iam_role.existing[0] is a object, known only after apply\r\n│\r\n│ The true and false result expressions must have consistent types. The given\r\n│ expressions are object and object, respectively.\r\n╵\r\nERRO[0051] 1 error occurred:\r\n        * exit status 1\r\n```\r\n\r\nIs there something I should be passing in to declare there isn't an existing cluster? It looks like these should get picked up by checking for roles and workers, but it doesn't seem to be happening.\r\n\r\n","bodyHTML":"<p dir=\"auto\">Using terraform 1.1.0 and service-catalog v0.68.8:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"│ Error: Inconsistent conditional result types\n│\n│   on .terraform/modules/eks.eks_workers.self_managed_workers/modules/eks-cluster-workers/main.tf line 336, in locals:\n│  335:     length(data.aws_iam_role.existing) &gt; 0\n│  336:     ? data.aws_iam_role.existing[0]\n│  337:     : (\n│  338:       length(aws_iam_role.eks_worker) &gt; 0\n│  339:       ? aws_iam_role.eks_worker[0]\n│  340:       : null\n│  341:     )\n│     ├────────────────\n│     │ aws_iam_role.eks_worker is a list of object, known only after apply\n│     │ aws_iam_role.eks_worker[0] is a object, known only after apply\n│     │ data.aws_iam_role.existing is a list of object, known only after apply\n│     │ data.aws_iam_role.existing[0] is a object, known only after apply\n│\n│ The true and false result expressions must have consistent types. The given\n│ expressions are object and object, respectively.\n╵\nERRO[0051] 1 error occurred:\n        * exit status 1\"><pre class=\"notranslate\"><code class=\"notranslate\">│ Error: Inconsistent conditional result types\n│\n│   on .terraform/modules/eks.eks_workers.self_managed_workers/modules/eks-cluster-workers/main.tf line 336, in locals:\n│  335:     length(data.aws_iam_role.existing) &gt; 0\n│  336:     ? data.aws_iam_role.existing[0]\n│  337:     : (\n│  338:       length(aws_iam_role.eks_worker) &gt; 0\n│  339:       ? aws_iam_role.eks_worker[0]\n│  340:       : null\n│  341:     )\n│     ├────────────────\n│     │ aws_iam_role.eks_worker is a list of object, known only after apply\n│     │ aws_iam_role.eks_worker[0] is a object, known only after apply\n│     │ data.aws_iam_role.existing is a list of object, known only after apply\n│     │ data.aws_iam_role.existing[0] is a object, known only after apply\n│\n│ The true and false result expressions must have consistent types. The given\n│ expressions are object and object, respectively.\n╵\nERRO[0051] 1 error occurred:\n        * exit status 1\n</code></pre></div>\n<p dir=\"auto\">Is there something I should be passing in to declare there isn't an existing cluster? It looks like these should get picked up by checking for roles and workers, but it doesn't seem to be happening.</p>","answer":{"body":"This is a regression in Terraform `v1.1.0`. Upgrading to Terraform `>=1.1.1` should fix this.","bodyHTML":"<p dir=\"auto\">This is a regression in Terraform <code class=\"notranslate\">v1.1.0</code>. Upgrading to Terraform <code class=\"notranslate\">&gt;=1.1.1</code> should fix this.</p>"}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "233a666b194eccf2d3a4793a044b188b"
}
##DOCS-SOURCER-END -->
