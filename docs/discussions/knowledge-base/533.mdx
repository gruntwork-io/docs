---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/533" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How do I consolidate application logs across accounts?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AQXzR","number":533,"author":{"login":"yorinasub17"},"title":"How do I consolidate application logs across accounts?","body":"\nI am trying to consolidate our app logs in to the `logs` account and could use some guidance on how Gruntwork proposes I do that.\r\n\r\nWe have EKS clusters in various accounts and have `fluent-bit` installed in the cluster which ships the logs to a CloudWatch Log Group in the account itself. We would want these logs be available in the centralized logs account, so we can look at exposing the logs to developers.\n\n---\n\n<ins datetime=\"2022-08-09T19:08:27Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109119\">Tracked in ticket #109119</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">I am trying to consolidate our app logs in to the <code class=\"notranslate\">logs</code> account and could use some guidance on how Gruntwork proposes I do that.</p>\n<p dir=\"auto\">We have EKS clusters in various accounts and have <code class=\"notranslate\">fluent-bit</code> installed in the cluster which ships the logs to a CloudWatch Log Group in the account itself. We would want these logs be available in the centralized logs account, so we can look at exposing the logs to developers.</p>\n<hr>\n<ins datetime=\"2022-08-09T19:08:27Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109119\" rel=\"nofollow\">Tracked in ticket #109119</a></p>\n</ins>","answer":{"body":"This is actually a bit tricky to do since CloudWatch Logs doesn’t natively support cross account access, making it a bit of a headache to consolidate the logs. There are a couple of workarounds, but none of them are particularly easy to implement, and we don't really have modules that make the process any easier.\r\n\r\n- **Use Lambda and CloudWatch Log Subscription Filters**. In this approach, you can create a Lambda function that does the cross account migration process for you. You will want to define a new Lambda function that is able to assume a role in the `logs` account to push the logs from the app account to a CloudWatch Log Group in the `logs` account. You can then hook this up to the source Log Group in the app account to stream the logs every time a new entry is pushed to the app account log group.\r\n\r\n- **Use Kinesis to ship log data to the logs account**. In this approach, you can configure `fluent-bit` to ship the logs to an AWS Kinesis stream instead of CloudWatch Logs. This works because Kinesis natively supports [cross account streaming](https://aws.amazon.com/blogs/architecture/field-notes-how-to-enable-cross-account-access-for-amazon-kinesis-data-streams-using-kinesis-client-library-2-x/), unlike CloudWatch Log Groups, so you can define the Kinesis stream in the `logs` account without deploying any additional infrastructure in the app accounts. You can then stream the log entries from Kinesis out to a CloudWatch Log Group in the `logs` account for searching and indexing.\r\n\r\n- **Use Elasticsearch as your log monitoring solution instead of CloudWatch Logs**. In this approach, you would deploy a managed OpenSearch instance in the logs account that is available to each of the app environments (either using a public OpenSearch instance, or via VPC peering across accounts). You can then configure `fluent-bit` to ship the logs to the single OpenSearch instance in the `logs` account from each of the app accounts. From there, your developers can access the Kibana interface deployed with the OpenSearch interface to view the logs. You can stand up an OpenSearch instance using our [service module](https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/data-stores/elasticsearch).","bodyHTML":"<p dir=\"auto\">This is actually a bit tricky to do since CloudWatch Logs doesn’t natively support cross account access, making it a bit of a headache to consolidate the logs. There are a couple of workarounds, but none of them are particularly easy to implement, and we don't really have modules that make the process any easier.</p>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\"><strong>Use Lambda and CloudWatch Log Subscription Filters</strong>. In this approach, you can create a Lambda function that does the cross account migration process for you. You will want to define a new Lambda function that is able to assume a role in the <code class=\"notranslate\">logs</code> account to push the logs from the app account to a CloudWatch Log Group in the <code class=\"notranslate\">logs</code> account. You can then hook this up to the source Log Group in the app account to stream the logs every time a new entry is pushed to the app account log group.</p>\n</li>\n<li>\n<p dir=\"auto\"><strong>Use Kinesis to ship log data to the logs account</strong>. In this approach, you can configure <code class=\"notranslate\">fluent-bit</code> to ship the logs to an AWS Kinesis stream instead of CloudWatch Logs. This works because Kinesis natively supports <a href=\"https://aws.amazon.com/blogs/architecture/field-notes-how-to-enable-cross-account-access-for-amazon-kinesis-data-streams-using-kinesis-client-library-2-x/\" rel=\"nofollow\">cross account streaming</a>, unlike CloudWatch Log Groups, so you can define the Kinesis stream in the <code class=\"notranslate\">logs</code> account without deploying any additional infrastructure in the app accounts. You can then stream the log entries from Kinesis out to a CloudWatch Log Group in the <code class=\"notranslate\">logs</code> account for searching and indexing.</p>\n</li>\n<li>\n<p dir=\"auto\"><strong>Use Elasticsearch as your log monitoring solution instead of CloudWatch Logs</strong>. In this approach, you would deploy a managed OpenSearch instance in the logs account that is available to each of the app environments (either using a public OpenSearch instance, or via VPC peering across accounts). You can then configure <code class=\"notranslate\">fluent-bit</code> to ship the logs to the single OpenSearch instance in the <code class=\"notranslate\">logs</code> account from each of the app accounts. From there, your developers can access the Kibana interface deployed with the OpenSearch interface to view the logs. You can stand up an OpenSearch instance using our <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/data-stores/elasticsearch\">service module</a>.</p>\n</li>\n</ul>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "a0bc54ef311f268fa347d7d2fbb36a71"
}
##DOCS-SOURCER-END -->
