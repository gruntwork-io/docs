---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/135" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How to debug Security Hub checks failing in the CIS Reference Architecture?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOesk","number":135,"author":{"login":"zackproser"},"title":"How to debug Security Hub checks failing in the CIS Reference Architecture?","body":"A customer asked: \r\n> How do I debug Security Hub check that is failing for my CIS Reference Architecture?","bodyHTML":"<p dir=\"auto\">A customer asked:</p>\n<blockquote>\n<p dir=\"auto\">How do I debug Security Hub check that is failing for my CIS Reference Architecture?</p>\n</blockquote>","answer":{"body":"[The Gruntwork CIS Reference Architecture](https://gruntwork.io/achieve-compliance/) implements a configuration that is compliant with [the CIS AWS Foundations Benchmark](https://www.cisecurity.org/benchmark/amazon_web_services/).\r\n\r\nIf you need to debug why a particular Security Hub check is failing for your CIS Reference Architecture, start by opening [the official AWS whitepaper on the CIS Foundations Benchmark](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf) and looking for the section that maps to the failing check. \r\n\r\nFor example, let's say your `Ensure a log metric filter and alarm exist for unauthorized API calls` securityhub check is failing with `CLOUDTRAIL_METRIC_FILTER_NOT_VALID`. \r\n\r\n`Ensure a log metric filter and alarm exist for unauthorized API calls` is the relevant section in the whitepaper to review. Within that section is an **Audit** subheader, which lays out exactly how to perform the check manually, with a combination of AWS console tasks and AWS CLI calls. \r\n\r\nPerform the steps outlined in the Audit and take note of the exact command or step that fails or can't be completed successfully. This provides clues as to which of the CIS service catalog modules might have an issue. \r\n\r\nPlease provide this information as feedback to Gruntwork when opening tickets or sending inquiries to support, as it will greatly assist us in narrowing down the problem.\r\n\r\n**Additional resources**\r\n- [AWS Security Hub Core Concepts ](https://gruntwork.io/repos/v0.3.0/cis-compliance-aws/modules/aws-securityhub/core-concepts.md)- Gruntwork guide detailing how the checks run, how they behave with cross-account architectures, etc.\r\n- [Official AWS Whitepaper on CIS Foundations Benchmark](https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf)\r\n","bodyHTML":"<p dir=\"auto\"><a href=\"https://gruntwork.io/achieve-compliance/\" rel=\"nofollow\">The Gruntwork CIS Reference Architecture</a> implements a configuration that is compliant with <a href=\"https://www.cisecurity.org/benchmark/amazon_web_services/\" rel=\"nofollow\">the CIS AWS Foundations Benchmark</a>.</p>\n<p dir=\"auto\">If you need to debug why a particular Security Hub check is failing for your CIS Reference Architecture, start by opening <a href=\"https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf\" rel=\"nofollow\">the official AWS whitepaper on the CIS Foundations Benchmark</a> and looking for the section that maps to the failing check.</p>\n<p dir=\"auto\">For example, let's say your <code class=\"notranslate\">Ensure a log metric filter and alarm exist for unauthorized API calls</code> securityhub check is failing with <code class=\"notranslate\">CLOUDTRAIL_METRIC_FILTER_NOT_VALID</code>.</p>\n<p dir=\"auto\"><code class=\"notranslate\">Ensure a log metric filter and alarm exist for unauthorized API calls</code> is the relevant section in the whitepaper to review. Within that section is an <strong>Audit</strong> subheader, which lays out exactly how to perform the check manually, with a combination of AWS console tasks and AWS CLI calls.</p>\n<p dir=\"auto\">Perform the steps outlined in the Audit and take note of the exact command or step that fails or can't be completed successfully. This provides clues as to which of the CIS service catalog modules might have an issue.</p>\n<p dir=\"auto\">Please provide this information as feedback to Gruntwork when opening tickets or sending inquiries to support, as it will greatly assist us in narrowing down the problem.</p>\n<p dir=\"auto\"><strong>Additional resources</strong></p>\n<ul dir=\"auto\">\n<li><a href=\"https://gruntwork.io/repos/v0.3.0/cis-compliance-aws/modules/aws-securityhub/core-concepts.md\" rel=\"nofollow\">AWS Security Hub Core Concepts </a>- Gruntwork guide detailing how the checks run, how they behave with cross-account architectures, etc.</li>\n<li><a href=\"https://d1.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf\" rel=\"nofollow\">Official AWS Whitepaper on CIS Foundations Benchmark</a></li>\n</ul>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "0ab823e08acaaf890356f8bb1cd79514"
}
##DOCS-SOURCER-END -->
