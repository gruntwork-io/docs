---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/514" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Use several secrets ARNs with run-lambda-entrypoint</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AQJy_","number":514,"author":{"login":"justos-br-aws-machine-user-data"},"title":"Use several secrets ARNs with run-lambda-entrypoint","body":"\nHi, \r\n\r\nWe have started to use `run-lambda-entrypoint` for lambda containers and we found it really useful but with one important missing thing (or at least we weren't able to find how to do it). \r\n\r\nThe feature missing is that we can't add several secrets, it looks like only one ARN secret can be added, and when you're working with hundreds of key/values you need to have some kind of hierarchical organisation with several secrets and you need to select which ARNs you want to pass to the lambda. \r\n\r\nIs there any workaround for this situation or are we missing something? (we weren't able to find anything in the docs https://github.com/gruntwork-io/terraform-aws-lambda/tree/master/modules/run-lambda-entrypoint)\r\n\r\nThanks!\r\n\r\n\n\n---\n\n<ins datetime=\"2022-07-21T08:49:45Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109028\">Tracked in ticket #109028</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Hi,</p>\n<p dir=\"auto\">We have started to use <code class=\"notranslate\">run-lambda-entrypoint</code> for lambda containers and we found it really useful but with one important missing thing (or at least we weren't able to find how to do it).</p>\n<p dir=\"auto\">The feature missing is that we can't add several secrets, it looks like only one ARN secret can be added, and when you're working with hundreds of key/values you need to have some kind of hierarchical organisation with several secrets and you need to select which ARNs you want to pass to the lambda.</p>\n<p dir=\"auto\">Is there any workaround for this situation or are we missing something? (we weren't able to find anything in the docs <a href=\"https://github.com/gruntwork-io/terraform-aws-lambda/tree/master/modules/run-lambda-entrypoint\">https://github.com/gruntwork-io/terraform-aws-lambda/tree/master/modules/run-lambda-entrypoint</a>)</p>\n<p dir=\"auto\">Thanks!</p>\n<hr>\n<ins datetime=\"2022-07-21T08:49:45Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109028\" rel=\"nofollow\">Tracked in ticket #109028</a></p>\n</ins>","answer":{"body":"Hello @justos-br-aws-machine-user-data! At first I was going to say that ARN passed to the module is not the arn of a single secret, but the arn of your _secrets manager_, because the docs makes references to the manager itself. But after some digging, it seems that it is indeed a [single secret arn](https://github.com/gruntwork-io/terraform-aws-lambda/blob/5d9d04c699ae5297026a5ccb395d93b1a1ab60c8/test/lambda_docker_test.go#L91) that is being passed, instead of the manager holding multiple secrets. I'm not even sure if it is possible to refer the arn of the whole manager. I had a look at terraform resources right now and it only has references to the [entries](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret) themselves. \r\n\r\nThis is quite confusing, so I'll create an issue at the repo to discuss what's the best way to resolve this. But it is possible to have [multiple key/pairs in a single secret](https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_CreateSecret.html#API_CreateSecret_Example_1_Request), by passing a json string as the secret string, so this is the best workaround at the moment to access multiple secret values.\r\n","bodyHTML":"<p dir=\"auto\">Hello <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/justos-br-aws-machine-user-data/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/justos-br-aws-machine-user-data\">@justos-br-aws-machine-user-data</a>! At first I was going to say that ARN passed to the module is not the arn of a single secret, but the arn of your <em>secrets manager</em>, because the docs makes references to the manager itself. But after some digging, it seems that it is indeed a <a href=\"https://github.com/gruntwork-io/terraform-aws-lambda/blob/5d9d04c699ae5297026a5ccb395d93b1a1ab60c8/test/lambda_docker_test.go#L91\">single secret arn</a> that is being passed, instead of the manager holding multiple secrets. I'm not even sure if it is possible to refer the arn of the whole manager. I had a look at terraform resources right now and it only has references to the <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret\" rel=\"nofollow\">entries</a> themselves.</p>\n<p dir=\"auto\">This is quite confusing, so I'll create an issue at the repo to discuss what's the best way to resolve this. But it is possible to have <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_CreateSecret.html#API_CreateSecret_Example_1_Request\" rel=\"nofollow\">multiple key/pairs in a single secret</a>, by passing a json string as the secret string, so this is the best workaround at the moment to access multiple secret values.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "42a8fde9463d593fbab2d2cff01b7b40"
}
##DOCS-SOURCER-END -->
