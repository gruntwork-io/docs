---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/227" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Single vs Multiple Repos for Ref Architecture</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AO5nA","number":227,"author":{"login":"AMMullan"},"title":"Single vs Multiple Repos for Ref Architecture","body":"We've just started using the Reference Architecture and it seems very dependent on having the one repository for everything but this goes against everything that I've ever known - from my experience, repositories should be purposeful and not monolithic. Is there a way to have the Reference Architecture used with multiple repostories?","bodyHTML":"<p dir=\"auto\">We've just started using the Reference Architecture and it seems very dependent on having the one repository for everything but this goes against everything that I've ever known - from my experience, repositories should be purposeful and not monolithic. Is there a way to have the Reference Architecture used with multiple repostories?</p>","answer":{"body":"You can reorganize the reference architecture in any way you like. E.g., you can create multiple `infrastructure-live` repos and copy paste the folder and common files to the new repos to split it out.\r\n\r\nNote that migrating to multi-repo has a few gotchas that you will want to keep in mind:\r\n\r\n- `terragrunt` currently doesn't support remote dependencies. What this means is that if a `terragrunt` module depends on anothe resource (e.g., EKS depending on VPC), then you will need to make sure that the repo contains both the code for VPC and EKS so that the dependency references can work. If you want to further split off, then just be aware that you will no longer be able to use `dependency` blocks to link the two, requiring either hard coding or a look up with the AWS CLI.\r\n- `terragrunt` currently doesn't support remote includes. What this means is that depending on how you split off the `infrastructure-live` repo, you may end up with code duplication as you will no longer be able to include common values via the `_envcommon` pattern.\r\n- The current state file path is dependent on relative paths between the root `terragrunt.hcl` and the child `terragrunt.hcl`. What this means is that depending on how you split the `infrastructure-live` repo, you may inadvertently update the path of the state file. You can fix this by doing a state migration to the new path, following https://github.com/gruntwork-io/knowledge-base/discussions/229\r\n\r\nYou may also want to take a look at https://github.com/gruntwork-io/terragrunt-infrastructure-modules-example#monorepo-vs-polyrepo to understand the tradeoffs between a monorepo setup and polyrepo setup.","bodyHTML":"<p dir=\"auto\">You can reorganize the reference architecture in any way you like. E.g., you can create multiple <code class=\"notranslate\">infrastructure-live</code> repos and copy paste the folder and common files to the new repos to split it out.</p>\n<p dir=\"auto\">Note that migrating to multi-repo has a few gotchas that you will want to keep in mind:</p>\n<ul dir=\"auto\">\n<li><code class=\"notranslate\">terragrunt</code> currently doesn't support remote dependencies. What this means is that if a <code class=\"notranslate\">terragrunt</code> module depends on anothe resource (e.g., EKS depending on VPC), then you will need to make sure that the repo contains both the code for VPC and EKS so that the dependency references can work. If you want to further split off, then just be aware that you will no longer be able to use <code class=\"notranslate\">dependency</code> blocks to link the two, requiring either hard coding or a look up with the AWS CLI.</li>\n<li><code class=\"notranslate\">terragrunt</code> currently doesn't support remote includes. What this means is that depending on how you split off the <code class=\"notranslate\">infrastructure-live</code> repo, you may end up with code duplication as you will no longer be able to include common values via the <code class=\"notranslate\">_envcommon</code> pattern.</li>\n<li>The current state file path is dependent on relative paths between the root <code class=\"notranslate\">terragrunt.hcl</code> and the child <code class=\"notranslate\">terragrunt.hcl</code>. What this means is that depending on how you split the <code class=\"notranslate\">infrastructure-live</code> repo, you may inadvertently update the path of the state file. You can fix this by doing a state migration to the new path, following <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3906542\" data-permission-text=\"Title is private\" data-url=\"https://github.com/gruntwork-io/knowledge-base/discussions/229\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/gruntwork-io/knowledge-base/discussions/229/hovercard\" href=\"https://github.com/orgs/gruntwork-io/discussions/229\">#229</a></li>\n</ul>\n<p dir=\"auto\">You may also want to take a look at <a href=\"https://github.com/gruntwork-io/terragrunt-infrastructure-modules-example#monorepo-vs-polyrepo\">https://github.com/gruntwork-io/terragrunt-infrastructure-modules-example#monorepo-vs-polyrepo</a> to understand the tradeoffs between a monorepo setup and polyrepo setup.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "062452ec3b9052507f32d1dcacb5cbc9"
}
##DOCS-SOURCER-END -->
