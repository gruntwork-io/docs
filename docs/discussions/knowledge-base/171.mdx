---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/171" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>What’s the correct way of making the shared account AMIs available to other regions?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOtJk","number":171,"author":{"login":"yorinasub17"},"title":"What’s the correct way of making the shared account AMIs available to other regions?","body":"We have the amis we need for the dev account in us-east-2, but we need them in sa-east-1 (same account). We’re using the ref arch.","bodyHTML":"<p dir=\"auto\">We have the amis we need for the dev account in us-east-2, but we need them in sa-east-1 (same account). We’re using the ref arch.</p>","answer":{"body":"Here are the steps to unlock a new region for the AMI:\r\n\r\n1. Create a new `ami-encryption` KMS key in the shared account for the target region. This can be done through the `account-baseline` module in the shared account. In this case, you want to copy paste [this entry](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/_global/account-baseline/terragrunt.hcl#L64-L81) under a new key name with the `region` set to the target region. For the purpose of making these instructions clear, we will assume the KMS key was named `ami-encryption-sa-east-1`.\r\n\r\n1. To deploy the key, open a PR with your changes and have it flow through the pipeline to be applied.\r\n\r\n1. Once the KMS key is created, you want to modify the AMI build script to copy the AMI in the new region. This can be done by adding the region to the `COPY_REGIONS` array in the ami build script (e.g., for bastion host https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/us-west-2/_regional/amis/build_bastion_host.sh#L21).\r\n\r\n1. Also make sure the KMS key name referenced for the region matches what you created in step (1), [here](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/us-west-2/_regional/amis/build_bastion_host.sh#L62)\r\n\r\n1. Once the script is updated, check it in and open a PR. The ECS Deploy Runner should automatically create the new AMI and replicate it to the target region.","bodyHTML":"<p dir=\"auto\">Here are the steps to unlock a new region for the AMI:</p>\n<ol dir=\"auto\">\n<li>\n<p dir=\"auto\">Create a new <code class=\"notranslate\">ami-encryption</code> KMS key in the shared account for the target region. This can be done through the <code class=\"notranslate\">account-baseline</code> module in the shared account. In this case, you want to copy paste <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/_global/account-baseline/terragrunt.hcl#L64-L81\">this entry</a> under a new key name with the <code class=\"notranslate\">region</code> set to the target region. For the purpose of making these instructions clear, we will assume the KMS key was named <code class=\"notranslate\">ami-encryption-sa-east-1</code>.</p>\n</li>\n<li>\n<p dir=\"auto\">To deploy the key, open a PR with your changes and have it flow through the pipeline to be applied.</p>\n</li>\n<li>\n<p dir=\"auto\">Once the KMS key is created, you want to modify the AMI build script to copy the AMI in the new region. This can be done by adding the region to the <code class=\"notranslate\">COPY_REGIONS</code> array in the ami build script (e.g., for bastion host <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/us-west-2/_regional/amis/build_bastion_host.sh#L21\">https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/us-west-2/_regional/amis/build_bastion_host.sh#L21</a>).</p>\n</li>\n<li>\n<p dir=\"auto\">Also make sure the KMS key name referenced for the region matches what you created in step (1), <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/v0.73.1/examples/for-production/infrastructure-live/shared/us-west-2/_regional/amis/build_bastion_host.sh#L62\">here</a></p>\n</li>\n<li>\n<p dir=\"auto\">Once the script is updated, check it in and open a PR. The ECS Deploy Runner should automatically create the new AMI and replicate it to the target region.</p>\n</li>\n</ol>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "7c81a5126c89e6156fd58cda05ead289"
}
##DOCS-SOURCER-END -->
