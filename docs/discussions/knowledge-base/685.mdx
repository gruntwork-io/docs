---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/685" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Upgrading terraform-aws-lambda past version v0.21.0</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AS-ze","number":685,"author":{"login":"erictompkins"},"title":"Upgrading terraform-aws-lambda past version v0.21.0","body":"\nI'm trying to upgrade our Lambda edge code that uses terraform-aws-lambda to v0.21.0 but I'm having issues with the new requirements for `log_regions`.  The [example code](https://github.com/gruntwork-io/terraform-aws-lambda/blob/main/examples/lambda-edge/main.tf) shows all of the log regions enabled. \r\n\r\n```\r\nlocals {\r\n  log_regions = [\r\n    \"us-east-1\",\r\n    \"us-east-2\",\r\n    \"us-west-1\",\r\n    \"us-west-2\",\r\n    \"ap-south-1\",\r\n    \"ap-northeast-2\",\r\n    \"ap-southeast-1\",\r\n    \"ap-southeast-2\",\r\n    \"ap-northeast-1\",\r\n    \"eu-central-1\",\r\n    \"eu-west-1\",\r\n    \"eu-west-2\",\r\n    \"sa-east-1\"\r\n  ]\r\n}\r\n```\r\n\r\nHowever, when I do that I get errors deploying stating that ` Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.`. \r\n\r\nHere is the full output of the error. \r\n\r\n\r\n\r\n```\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\nReleasing state lock. This may take a few moments...\r\nERRO[0090] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \r\nERRO[0090] 1 error occurred:\r\n        * exit status 1\r\n```\r\n\r\n\r\nPreviously I had my own log group that was created. I removed that with Terraform even though it had a different name.\r\nI also comment out all of the `log_region` values to destroy those log groups before trying to create them again. \r\n\r\nI looked in [modules/lambda-edge-multi-region-log-groups/main.tf](https://github.com/gruntwork-io/terraform-aws-lambda/blob/main/modules/lambda-edge-multi-region-log-groups/main.tf) and it looks like all of the log groups have the same name.\r\n\r\nIf I comment out all but one of the log group regions it still fails. \r\n\r\n\r\nBelow is my module code.\r\nI also created a `providers.tf` file just like https://github.com/gruntwork-io/terraform-aws-lambda/blob/v0.21.0/examples/lambda-edge/providers.tf.\r\n\r\n```\r\nmodule \"lambda_s3\" {\r\n  source = \"git::git@github.com:gruntwork-io/terraform-aws-lambda.git//modules/lambda-edge?ref=v0.21.7\"\r\n\r\n  name        = var.name\r\n  description = var.description\r\n\r\n  s3_bucket = data.terraform_remote_state.s3_lambda_bucket.outputs.bucket_name\r\n  s3_key    = \"cloudfront-site-files-origin-request/${var.app_version}/source.zip\"\r\n  runtime   = \"nodejs16.x\"\r\n  handler   = \"index.handler\"\r\n\r\n  timeout     = var.timeout\r\n  memory_size = var.memory_size\r\n\r\n  providers = {\r\n    # Regions that have Regional Edge Caches\r\n    aws.ap_northeast_1 = aws.ap_northeast_1\r\n    aws.ap_northeast_2 = aws.ap_northeast_2\r\n    aws.ap_south_1     = aws.ap_south_1\r\n    aws.ap_southeast_1 = aws.ap_southeast_1\r\n    aws.ap_southeast_2 = aws.ap_southeast_2\r\n    aws.eu_central_1   = aws.eu_central_1\r\n    aws.eu_west_1      = aws.eu_west_1\r\n    aws.eu_west_2      = aws.eu_west_2\r\n    aws.sa_east_1      = aws.sa_east_1\r\n    aws.us_east_1      = aws.us_east_1\r\n    aws.us_east_2      = aws.us_east_2\r\n    aws.us_west_1      = aws.us_west_1\r\n    aws.us_west_2      = aws.us_west_2\r\n  }\r\n\r\n  cloudwatch_log_group_retention_in_days = var.cloudwatch_log_group_retention\r\n\r\n  # Regions that have Regional Edge Caches\r\n  log_regions = local.log_regions\r\n}\r\n\r\n# Regions that have Regional Edge Caches\r\n# If you completely disabled one of these regions in your AWS account, you can remove them\r\n# here, but their respective providers still need to be passed to the lambda-edge module.\r\nlocals {\r\n  log_regions = [\r\n    \"us-east-1\",\r\n    # \"us-east-2\",\r\n    # \"us-west-1\",\r\n    # \"us-west-2\",\r\n    # \"ap-south-1\",\r\n    # \"ap-northeast-2\",\r\n    # \"ap-southeast-1\",\r\n    # \"ap-southeast-2\",\r\n    # \"ap-northeast-1\",\r\n    # \"eu-central-1\",\r\n    # \"eu-west-1\",\r\n    # \"eu-west-2\",\r\n    # \"sa-east-1\"\r\n  ]\r\n}\r\n```\r\n\r\nThis ends up with this Terraform plan:\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0] will be created\r\n  + resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n      + arn               = (known after apply)\r\n      + id                = (known after apply)\r\n      + name              = \"/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request\"\r\n      + retention_in_days = 14\r\n      + tags_all          = (known after apply)\r\n    }\r\n\r\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0] will be created\r\n  + resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n      + arn               = (known after apply)\r\n      + id                = (known after apply)\r\n      + name              = \"/aws/lambda/BranchCMS-CloudFront-Origin-Request\"\r\n      + retention_in_days = 14\r\n      + tags_all          = (known after apply)\r\n    }\r\n\r\nPlan: 2 to add, 0 to change, 0 to destroy.\r\n\r\nDo you want to perform these actions?\r\n  Terraform will perform the actions described above.\r\n  Only 'yes' will be accepted to approve.\r\n\r\n  Enter a value: yes\r\n```\r\n\r\nBut I still get the following errors:\r\n\r\n```\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\r\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\r\n╷\r\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\r\n│ \r\n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\r\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\r\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\r\n│ \r\n╵\r\nReleasing state lock. This may take a few moments...\r\nERRO[0088] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \r\nERRO[0088] 1 error occurred:\r\n        * exit status 1\r\n```\n\n---\n\n<ins datetime=\"2023-03-17T23:04:48Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109999\">Tracked in ticket #109999</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">I'm trying to upgrade our Lambda edge code that uses terraform-aws-lambda to v0.21.0 but I'm having issues with the new requirements for <code class=\"notranslate\">log_regions</code>.  The <a href=\"https://github.com/gruntwork-io/terraform-aws-lambda/blob/main/examples/lambda-edge/main.tf\">example code</a> shows all of the log regions enabled.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"locals {\n  log_regions = [\n    &quot;us-east-1&quot;,\n    &quot;us-east-2&quot;,\n    &quot;us-west-1&quot;,\n    &quot;us-west-2&quot;,\n    &quot;ap-south-1&quot;,\n    &quot;ap-northeast-2&quot;,\n    &quot;ap-southeast-1&quot;,\n    &quot;ap-southeast-2&quot;,\n    &quot;ap-northeast-1&quot;,\n    &quot;eu-central-1&quot;,\n    &quot;eu-west-1&quot;,\n    &quot;eu-west-2&quot;,\n    &quot;sa-east-1&quot;\n  ]\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">locals {\n  log_regions = [\n    \"us-east-1\",\n    \"us-east-2\",\n    \"us-west-1\",\n    \"us-west-2\",\n    \"ap-south-1\",\n    \"ap-northeast-2\",\n    \"ap-southeast-1\",\n    \"ap-southeast-2\",\n    \"ap-northeast-1\",\n    \"eu-central-1\",\n    \"eu-west-1\",\n    \"eu-west-2\",\n    \"sa-east-1\"\n  ]\n}\n</code></pre></div>\n<p dir=\"auto\">However, when I do that I get errors deploying stating that <code class=\"notranslate\"> Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.</code>.</p>\n<p dir=\"auto\">Here is the full output of the error.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\nReleasing state lock. This may take a few moments...\nERRO[0090] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \nERRO[0090] 1 error occurred:\n        * exit status 1\"><pre class=\"notranslate\"><code class=\"notranslate\">module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_sa_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_2.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 2s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_west_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_south_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_northeast_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_west_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_ap_southeast_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_eu_central_1.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_2.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\nReleasing state lock. This may take a few moments...\nERRO[0090] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \nERRO[0090] 1 error occurred:\n        * exit status 1\n</code></pre></div>\n<p dir=\"auto\">Previously I had my own log group that was created. I removed that with Terraform even though it had a different name.<br>\nI also comment out all of the <code class=\"notranslate\">log_region</code> values to destroy those log groups before trying to create them again.</p>\n<p dir=\"auto\">I looked in <a href=\"https://github.com/gruntwork-io/terraform-aws-lambda/blob/main/modules/lambda-edge-multi-region-log-groups/main.tf\">modules/lambda-edge-multi-region-log-groups/main.tf</a> and it looks like all of the log groups have the same name.</p>\n<p dir=\"auto\">If I comment out all but one of the log group regions it still fails.</p>\n<p dir=\"auto\">Below is my module code.<br>\nI also created a <code class=\"notranslate\">providers.tf</code> file just like <a href=\"https://github.com/gruntwork-io/terraform-aws-lambda/blob/v0.21.0/examples/lambda-edge/providers.tf\">https://github.com/gruntwork-io/terraform-aws-lambda/blob/v0.21.0/examples/lambda-edge/providers.tf</a>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module &quot;lambda_s3&quot; {\n  source = &quot;git::git@github.com:gruntwork-io/terraform-aws-lambda.git//modules/lambda-edge?ref=v0.21.7&quot;\n\n  name        = var.name\n  description = var.description\n\n  s3_bucket = data.terraform_remote_state.s3_lambda_bucket.outputs.bucket_name\n  s3_key    = &quot;cloudfront-site-files-origin-request/${var.app_version}/source.zip&quot;\n  runtime   = &quot;nodejs16.x&quot;\n  handler   = &quot;index.handler&quot;\n\n  timeout     = var.timeout\n  memory_size = var.memory_size\n\n  providers = {\n    # Regions that have Regional Edge Caches\n    aws.ap_northeast_1 = aws.ap_northeast_1\n    aws.ap_northeast_2 = aws.ap_northeast_2\n    aws.ap_south_1     = aws.ap_south_1\n    aws.ap_southeast_1 = aws.ap_southeast_1\n    aws.ap_southeast_2 = aws.ap_southeast_2\n    aws.eu_central_1   = aws.eu_central_1\n    aws.eu_west_1      = aws.eu_west_1\n    aws.eu_west_2      = aws.eu_west_2\n    aws.sa_east_1      = aws.sa_east_1\n    aws.us_east_1      = aws.us_east_1\n    aws.us_east_2      = aws.us_east_2\n    aws.us_west_1      = aws.us_west_1\n    aws.us_west_2      = aws.us_west_2\n  }\n\n  cloudwatch_log_group_retention_in_days = var.cloudwatch_log_group_retention\n\n  # Regions that have Regional Edge Caches\n  log_regions = local.log_regions\n}\n\n# Regions that have Regional Edge Caches\n# If you completely disabled one of these regions in your AWS account, you can remove them\n# here, but their respective providers still need to be passed to the lambda-edge module.\nlocals {\n  log_regions = [\n    &quot;us-east-1&quot;,\n    # &quot;us-east-2&quot;,\n    # &quot;us-west-1&quot;,\n    # &quot;us-west-2&quot;,\n    # &quot;ap-south-1&quot;,\n    # &quot;ap-northeast-2&quot;,\n    # &quot;ap-southeast-1&quot;,\n    # &quot;ap-southeast-2&quot;,\n    # &quot;ap-northeast-1&quot;,\n    # &quot;eu-central-1&quot;,\n    # &quot;eu-west-1&quot;,\n    # &quot;eu-west-2&quot;,\n    # &quot;sa-east-1&quot;\n  ]\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">module \"lambda_s3\" {\n  source = \"git::git@github.com:gruntwork-io/terraform-aws-lambda.git//modules/lambda-edge?ref=v0.21.7\"\n\n  name        = var.name\n  description = var.description\n\n  s3_bucket = data.terraform_remote_state.s3_lambda_bucket.outputs.bucket_name\n  s3_key    = \"cloudfront-site-files-origin-request/${var.app_version}/source.zip\"\n  runtime   = \"nodejs16.x\"\n  handler   = \"index.handler\"\n\n  timeout     = var.timeout\n  memory_size = var.memory_size\n\n  providers = {\n    # Regions that have Regional Edge Caches\n    aws.ap_northeast_1 = aws.ap_northeast_1\n    aws.ap_northeast_2 = aws.ap_northeast_2\n    aws.ap_south_1     = aws.ap_south_1\n    aws.ap_southeast_1 = aws.ap_southeast_1\n    aws.ap_southeast_2 = aws.ap_southeast_2\n    aws.eu_central_1   = aws.eu_central_1\n    aws.eu_west_1      = aws.eu_west_1\n    aws.eu_west_2      = aws.eu_west_2\n    aws.sa_east_1      = aws.sa_east_1\n    aws.us_east_1      = aws.us_east_1\n    aws.us_east_2      = aws.us_east_2\n    aws.us_west_1      = aws.us_west_1\n    aws.us_west_2      = aws.us_west_2\n  }\n\n  cloudwatch_log_group_retention_in_days = var.cloudwatch_log_group_retention\n\n  # Regions that have Regional Edge Caches\n  log_regions = local.log_regions\n}\n\n# Regions that have Regional Edge Caches\n# If you completely disabled one of these regions in your AWS account, you can remove them\n# here, but their respective providers still need to be passed to the lambda-edge module.\nlocals {\n  log_regions = [\n    \"us-east-1\",\n    # \"us-east-2\",\n    # \"us-west-1\",\n    # \"us-west-2\",\n    # \"ap-south-1\",\n    # \"ap-northeast-2\",\n    # \"ap-southeast-1\",\n    # \"ap-southeast-2\",\n    # \"ap-northeast-1\",\n    # \"eu-central-1\",\n    # \"eu-west-1\",\n    # \"eu-west-2\",\n    # \"sa-east-1\"\n  ]\n}\n</code></pre></div>\n<p dir=\"auto\">This ends up with this Terraform plan:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Terraform will perform the following actions:\n\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0] will be created\n  + resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n      + arn               = (known after apply)\n      + id                = (known after apply)\n      + name              = &quot;/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request&quot;\n      + retention_in_days = 14\n      + tags_all          = (known after apply)\n    }\n\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0] will be created\n  + resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n      + arn               = (known after apply)\n      + id                = (known after apply)\n      + name              = &quot;/aws/lambda/BranchCMS-CloudFront-Origin-Request&quot;\n      + retention_in_days = 14\n      + tags_all          = (known after apply)\n    }\n\nPlan: 2 to add, 0 to change, 0 to destroy.\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only 'yes' will be accepted to approve.\n\n  Enter a value: yes\"><pre class=\"notranslate\"><code class=\"notranslate\">Terraform will perform the following actions:\n\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0] will be created\n  + resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n      + arn               = (known after apply)\n      + id                = (known after apply)\n      + name              = \"/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request\"\n      + retention_in_days = 14\n      + tags_all          = (known after apply)\n    }\n\n  # module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0] will be created\n  + resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n      + arn               = (known after apply)\n      + id                = (known after apply)\n      + name              = \"/aws/lambda/BranchCMS-CloudFront-Origin-Request\"\n      + retention_in_days = 14\n      + tags_all          = (known after apply)\n    }\n\nPlan: 2 to add, 0 to change, 0 to destroy.\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only 'yes' will be accepted to approve.\n\n  Enter a value: yes\n</code></pre></div>\n<p dir=\"auto\">But I still get the following errors:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot;:\n│   23: resource &quot;aws_cloudwatch_log_group&quot; &quot;log_aggregation&quot; {\n│ \n╵\nReleasing state lock. This may take a few moments...\nERRO[0088] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \nERRO[0088] 1 error occurred:\n        * exit status 1\"><pre class=\"notranslate\"><code class=\"notranslate\">module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]: Creating...\nmodule.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1.aws_cloudwatch_log_group.log_aggregation[0]: Creation complete after 1s [id=/aws/lambda/us-east-1.BranchCMS-CloudFront-Origin-Request]\n╷\n│ Error: Creating CloudWatch Log Group failed: ResourceAlreadyExistsException: The specified log group already exists:  The CloudWatch Log Group '/aws/lambda/BranchCMS-CloudFront-Origin-Request' already exists.\n│ \n│   with module.lambda_s3.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0],\n│   on .terraform/modules/lambda_s3/modules/lambda-edge-log-group/main.tf line 23, in resource \"aws_cloudwatch_log_group\" \"log_aggregation\":\n│   23: resource \"aws_cloudwatch_log_group\" \"log_aggregation\" {\n│ \n╵\nReleasing state lock. This may take a few moments...\nERRO[0088] Terraform invocation failed in /Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request/.terragrunt-cache/PduoGpqUSJbQMFTXvMvjBTZeEG8/KDSNrMH_m9Kj00IaSiBgDwGf9Fk  prefix=[/Users/erictompkins/Sites/BranchCMS/AWS/Infrastructure-Live/dev/us-east-1/dev/cms-public-site-files/lambda-cloudfront-origin-request] \nERRO[0088] 1 error occurred:\n        * exit status 1\n</code></pre></div>\n<hr>\n<ins datetime=\"2023-03-17T23:04:48Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109999\" rel=\"nofollow\">Tracked in ticket #109999</a></p>\n</ins>","answer":{"body":"Hi @erictompkins, could you try this and let me know if it will apply without errors?\r\n\r\nReplace YOUR_FUNCTION_NAME below. You might also have to replace `module.lambda_edge` according to how your module is named. If you have more \"log group already exists\" errors, you can follow this pattern to import the remaining log groups according to the error message you get.\r\n\r\n```\r\nterraform import 'module.lambda_edge.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]' /aws/lambda/YOUR_FUNCTION_NAME\r\n```\r\n","bodyHTML":"<p dir=\"auto\">Hi <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/erictompkins/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/erictompkins\">@erictompkins</a>, could you try this and let me know if it will apply without errors?</p>\n<p dir=\"auto\">Replace YOUR_FUNCTION_NAME below. You might also have to replace <code class=\"notranslate\">module.lambda_edge</code> according to how your module is named. If you have more \"log group already exists\" errors, you can follow this pattern to import the remaining log groups according to the error message you get.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"terraform import 'module.lambda_edge.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]' /aws/lambda/YOUR_FUNCTION_NAME\"><pre class=\"notranslate\"><code class=\"notranslate\">terraform import 'module.lambda_edge.module.log_groups.module.lambda_edge_log_group_us_east_1_direct.aws_cloudwatch_log_group.log_aggregation[0]' /aws/lambda/YOUR_FUNCTION_NAME\n</code></pre></div>"}}} />

</CenterLayout>
  

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "efdad3673311e00461556c18978caf32"
}
##DOCS-SOURCER-END -->
