---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/620" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Reference Architecture: sample-app-frontend ecs - how to change desired number of tasks?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84ARz8P","number":620,"author":{"login":"drafie"},"title":"Reference Architecture: sample-app-frontend ecs - how to change desired number of tasks?","body":"\nI am following the Getting Started guide in our RA deployment and I am at 03-configure-gw-pipelines.md. \r\n\r\nThe guide says:\r\n\r\n> You can try out the pipeline by making a change to one of the modules. For example, try extending the number of replicas in the sample app:\r\n> \r\n> Create a new branch in the infrastructure-live repo. git checkout -B add-replica-to-sample-app.\r\n> **Open the file dev/us-east-1/dev/services/sample-app-frontend in your editor**.\r\n> Change the input variable desired_number_of_tasks to 2.\r\n> Commit the change. git commit -a.\r\n> Push the branch to GitHub and open a PR. git push add-replica-to-sample-app\r\n> Verify the plan. Make sure that the change corresponds to adding a new replica to the ECS service.\r\n> When satisfied with the plan, merge the PR into main.\r\n> Go back to the project and verify that a new build is started on the main branch.\r\n> Wait for the plan to finish.\r\n> Wait for the apply to finish.\r\n> Login to the AWS console and verify the ECS service now has 2 replicas.\r\n\r\nThe reference to **Open the file dev/us-east-1/dev/services/sample-app-frontend in your editor** doesn't seem accurate as it is a directory, not a file.   The directory contains a terragrunt.hcl file, nothing more.    \r\n\r\nThere is no input variable that I can find called \"desired_number_of_tasks\".   In fact, I grepped my entire infrastructure-live repo and did not find a match for it. \r\n\r\nI looked into https://github.com/gruntwork-io/terraform-aws-service-catalog and found it in modules/services/ecs-service/variables.tf. \r\n\r\nThe closest thing I can find to that ecs-services/variables.tf in the deployed RA repo is _envcommon/services/ecs-sample-app-frontend.hcl, but inside it I do not see a specification for the number of tasks. \r\n\r\nI am confused as to how desired_number_of_tasks is being defined and where to go about changing it.   Perhaps it defaults to one and I need to add variables.tf somewhere under /dev or /stage? \n\n---\n\n<ins datetime=\"2022-12-16T07:02:03Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/109737\">Tracked in ticket #109737</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">I am following the Getting Started guide in our RA deployment and I am at 03-configure-gw-pipelines.md.</p>\n<p dir=\"auto\">The guide says:</p>\n<blockquote>\n<p dir=\"auto\">You can try out the pipeline by making a change to one of the modules. For example, try extending the number of replicas in the sample app:</p>\n<p dir=\"auto\">Create a new branch in the infrastructure-live repo. git checkout -B add-replica-to-sample-app.<br>\n<strong>Open the file dev/us-east-1/dev/services/sample-app-frontend in your editor</strong>.<br>\nChange the input variable desired_number_of_tasks to 2.<br>\nCommit the change. git commit -a.<br>\nPush the branch to GitHub and open a PR. git push add-replica-to-sample-app<br>\nVerify the plan. Make sure that the change corresponds to adding a new replica to the ECS service.<br>\nWhen satisfied with the plan, merge the PR into main.<br>\nGo back to the project and verify that a new build is started on the main branch.<br>\nWait for the plan to finish.<br>\nWait for the apply to finish.<br>\nLogin to the AWS console and verify the ECS service now has 2 replicas.</p>\n</blockquote>\n<p dir=\"auto\">The reference to <strong>Open the file dev/us-east-1/dev/services/sample-app-frontend in your editor</strong> doesn't seem accurate as it is a directory, not a file.   The directory contains a terragrunt.hcl file, nothing more.</p>\n<p dir=\"auto\">There is no input variable that I can find called \"desired_number_of_tasks\".   In fact, I grepped my entire infrastructure-live repo and did not find a match for it.</p>\n<p dir=\"auto\">I looked into <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog\">https://github.com/gruntwork-io/terraform-aws-service-catalog</a> and found it in modules/services/ecs-service/variables.tf.</p>\n<p dir=\"auto\">The closest thing I can find to that ecs-services/variables.tf in the deployed RA repo is _envcommon/services/ecs-sample-app-frontend.hcl, but inside it I do not see a specification for the number of tasks.</p>\n<p dir=\"auto\">I am confused as to how desired_number_of_tasks is being defined and where to go about changing it.   Perhaps it defaults to one and I need to add variables.tf somewhere under /dev or /stage?</p>\n<hr>\n<ins datetime=\"2022-12-16T07:02:03Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/109737\" rel=\"nofollow\">Tracked in ticket #109737</a></p>\n</ins>","answer":{"body":"It turns out that you need to edit the dev/us-east-1/dev/services/sample-app-frontend/**terragrunt.hcl** file.\r\n\r\nUnder inputs you can pass in variables that override the defaults. \r\n\r\nAt the bottom of the file, within the Module Parameters to pass in, you can drop this in the inputs.\r\n\r\n```\r\n  #\r\n  # Number of tasks to run\r\n  #\r\n  desired_number_of_tasks = 2\r\n```","bodyHTML":"<p dir=\"auto\">It turns out that you need to edit the dev/us-east-1/dev/services/sample-app-frontend/<strong>terragrunt.hcl</strong> file.</p>\n<p dir=\"auto\">Under inputs you can pass in variables that override the defaults.</p>\n<p dir=\"auto\">At the bottom of the file, within the Module Parameters to pass in, you can drop this in the inputs.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  #\n  # Number of tasks to run\n  #\n  desired_number_of_tasks = 2\"><pre class=\"notranslate\"><code class=\"notranslate\">  #\n  # Number of tasks to run\n  #\n  desired_number_of_tasks = 2\n</code></pre></div>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "abbc7cb2c7bf66d23ff36b8b121e232b"
}
##DOCS-SOURCER-END -->
