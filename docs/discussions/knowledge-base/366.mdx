---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/366" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>ALB service catalog module does not handle Target Group / Rules</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84APVJ7","number":366,"author":{"login":"chambodn"},"title":"ALB service catalog module does not handle Target Group / Rules","body":"Hi Gruntworkers!\r\n\r\nI looked at the [ALB service module](https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/networking/alb) and realized that this module is *only* creating an ALB + Listener and does not provide the capability to create rules/target groups. Looking at the `lb-listener-rules` module in the [terraform-aws-load-balancer repository](https://github.com/gruntwork-io/terraform-aws-load-balancer/tree/master/modules/lb-listener-rules), I noticed that target group creation is not handled either. \r\n\r\nIs there a particular reason to keep this granularity? What would be your recommendation between:\r\n- wrapping ALB service + lb-listener-rules in one single module\r\n- keeping the segmentation between Listener and Target Group by using a second \"service module\" for Rules + TG.\r\n\r\nThanks in advance for your help!!","bodyHTML":"<p dir=\"auto\">Hi Gruntworkers!</p>\n<p dir=\"auto\">I looked at the <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/tree/master/modules/networking/alb\">ALB service module</a> and realized that this module is <em>only</em> creating an ALB + Listener and does not provide the capability to create rules/target groups. Looking at the <code class=\"notranslate\">lb-listener-rules</code> module in the <a href=\"https://github.com/gruntwork-io/terraform-aws-load-balancer/tree/master/modules/lb-listener-rules\">terraform-aws-load-balancer repository</a>, I noticed that target group creation is not handled either.</p>\n<p dir=\"auto\">Is there a particular reason to keep this granularity? What would be your recommendation between:</p>\n<ul dir=\"auto\">\n<li>wrapping ALB service + lb-listener-rules in one single module</li>\n<li>keeping the segmentation between Listener and Target Group by using a second \"service module\" for Rules + TG.</li>\n</ul>\n<p dir=\"auto\">Thanks in advance for your help!!</p>","answer":{"body":"This is intentionally done by design. The listener rules and target groups are typically dependent on the service having already been deployed. For example, you typically need to link a Target Group to the underlying ASG so that the ASG can update it with instances as they are deployed. This leads to a situation where the TG and listener rules share the same lifecycle as the underlying service. \r\n\r\nGiven that, it makes much more sense to create and manage the listener rules and TGs with the underlying service, and our service modules for the various services handles this. Check out the [ecs-service](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/services/ecs-service/main.tf#L282-L301) service module for example, where we make a call to the `lb-listener-rules` module.\r\n\r\nIf this design doesn't suit your need and you would like to manage the ALB + listener + TG separately from the services, then I recommend creating [a wrapper module](https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog#extend-gruntwork-services) to extend the existing module, or [your own service catalog](https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog#create-totally-new-services) to implement the needed changes.","bodyHTML":"<p dir=\"auto\">This is intentionally done by design. The listener rules and target groups are typically dependent on the service having already been deployed. For example, you typically need to link a Target Group to the underlying ASG so that the ASG can update it with instances as they are deployed. This leads to a situation where the TG and listener rules share the same lifecycle as the underlying service.</p>\n<p dir=\"auto\">Given that, it makes much more sense to create and manage the listener rules and TGs with the underlying service, and our service modules for the various services handles this. Check out the <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/services/ecs-service/main.tf#L282-L301\">ecs-service</a> service module for example, where we make a call to the <code class=\"notranslate\">lb-listener-rules</code> module.</p>\n<p dir=\"auto\">If this design doesn't suit your need and you would like to manage the ALB + listener + TG separately from the services, then I recommend creating <a href=\"https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog#extend-gruntwork-services\" rel=\"nofollow\">a wrapper module</a> to extend the existing module, or <a href=\"https://docs.gruntwork.io/reference/services/intro/create-your-own-service-catalog#create-totally-new-services\" rel=\"nofollow\">your own service catalog</a> to implement the needed changes.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "fa673075f012ce8983ab643d8c39613d"
}
##DOCS-SOURCER-END -->
