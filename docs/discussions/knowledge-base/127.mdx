---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/127" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>modules/eks-cluster - desired_size value not being picked up by EKS</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOdh4","number":127,"author":{"login":"zackproser"},"title":"modules/eks-cluster - desired_size value not being picked up by EKS","body":"A customer asked: \r\n> Hi all - we are noticed that when using the modules/eks-cluster, the desired_size value is not getting picked up by EKS\r\n```\r\nexample:\r\nnode_group_default_desired_size = ${value0}\r\nmanaged_node_groups_configurations = { \r\n  ngroup1 = { \r\n    desired_size = ${value1} \r\n    ... ...\r\n  } ... \r\n}\r\n```\r\nas shown here:\r\nhttps://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/services/eks-cluster/variables.tf#L693-L709\r\n\r\n**UNLESS**:\r\nits the FIRST time running `tg apply` (initial creation of cluster)\r\nwith `node_group_default_desired_size` set\r\nwithOUT `desired_size` set in `group_config(s)`\r\nthe name(s) of the `node_group(s)` have changed\r\nWITH `desired_size` set in `group_config(s)` under a new name\r\n\r\nIs this expected behavior?","bodyHTML":"<p dir=\"auto\">A customer asked:</p>\n<blockquote>\n<p dir=\"auto\">Hi all - we are noticed that when using the modules/eks-cluster, the desired_size value is not getting picked up by EKS</p>\n</blockquote>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"example:\nnode_group_default_desired_size = ${value0}\nmanaged_node_groups_configurations = { \n  ngroup1 = { \n    desired_size = ${value1} \n    ... ...\n  } ... \n}\"><pre class=\"notranslate\"><code class=\"notranslate\">example:\nnode_group_default_desired_size = ${value0}\nmanaged_node_groups_configurations = { \n  ngroup1 = { \n    desired_size = ${value1} \n    ... ...\n  } ... \n}\n</code></pre></div>\n<p dir=\"auto\">as shown here:<br>\n<a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/services/eks-cluster/variables.tf#L693-L709\">https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/master/modules/services/eks-cluster/variables.tf#L693-L709</a></p>\n<p dir=\"auto\"><strong>UNLESS</strong>:<br>\nits the FIRST time running <code class=\"notranslate\">tg apply</code> (initial creation of cluster)<br>\nwith <code class=\"notranslate\">node_group_default_desired_size</code> set<br>\nwithOUT <code class=\"notranslate\">desired_size</code> set in <code class=\"notranslate\">group_config(s)</code><br>\nthe name(s) of the <code class=\"notranslate\">node_group(s)</code> have changed<br>\nWITH <code class=\"notranslate\">desired_size</code> set in <code class=\"notranslate\">group_config(s)</code> under a new name</p>\n<p dir=\"auto\">Is this expected behavior?</p>","answer":{"body":"Yes this is expected. The desired size attribute is setup in this manner so that it can avoid inadvertent terraform drift when using with the cluster autoscale. If you are going for a manual scaling system and not using the cluster autoscaler, the recommendation is to set the `min_size` and `max_size` to the same value and scale that way.","bodyHTML":"<p dir=\"auto\">Yes this is expected. The desired size attribute is setup in this manner so that it can avoid inadvertent terraform drift when using with the cluster autoscale. If you are going for a manual scaling system and not using the cluster autoscaler, the recommendation is to set the <code class=\"notranslate\">min_size</code> and <code class=\"notranslate\">max_size</code> to the same value and scale that way.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "8e9c8ea40e3267c6b69d66148c55de00"
}
##DOCS-SOURCER-END -->
