---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/197" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>MissingEndpoint: &apos;Endpoint&apos; configuration is required for this service</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOyZj","number":197,"author":{"login":"lee5i3"},"title":"MissingEndpoint: 'Endpoint' configuration is required for this service","body":"I'm having issues getting terratest to communicate to AWS, it creates the resources via terraform but terratest is says its missing the endpoint configuration\r\n\r\nMy terraform module creates RDS, my scenario returns the entire RDS object back so I can look into it\r\n```\r\noutput \"rds\" {\r\n  value = module.main\r\n}\r\n```\r\nMy test looks like the following\r\n```\r\nfunc Test_Defaults(t *testing.T) {\r\n\tt.Parallel()\r\n\r\n\tworkingDir := \"./scenarios/postgres\"\r\n\r\n\t// At the end of the test, undeploy the web app using Terraform\r\n\tdefer test_structure.RunTestStage(t, \"cleanup_terraform\", func() {\r\n                // Temporarily commented out to keep resource around while testing verify code\r\n\t\t// Remove(t, workingDir)\r\n\t})\r\n\r\n\t// Deploy the web app using Terraform\r\n\ttest_structure.RunTestStage(t, \"deploy_terraform\", func() {\r\n\t\tDeploy(t, workingDir, nil)\r\n\t})\r\n\r\n\ttest_structure.RunTestStage(t, \"validate\", func() {\r\n\t\tValidateAddressAndPort(t, workingDir, 5432)\r\n\t})\r\n}\r\n```\r\n\r\nI am deploying my code with the following\r\n```\r\nfunc Deploy(t *testing.T, workingDir string, vars map[string]interface{}) {\r\n\t// Construct the terraform options with default retryable errors to handle the most common retryable errors in\r\n\t// terraform testing.\r\n\tterraformOptions := terraform.WithDefaultRetryableErrors(t, &terraform.Options{\r\n\t\t// The path to where our Terraform code is located\r\n\t\tTerraformDir: workingDir,\r\n\r\n\t\t// Variables to pass to our Terraform code using -var options\r\n\t\tVars: vars,\r\n\t})\r\n\r\n\t// Save the Terraform Options struct, instance name, and instance text so future test stages can use it\r\n\ttest_structure.SaveTerraformOptions(t, workingDir, terraformOptions)\r\n\r\n\t// This will run `terraform init` and `terraform apply` and fail the test if there are any errors\r\n\tterraform.InitAndApply(t, terraformOptions)\r\n}\r\n```\r\n\r\nMy validate looks like this\r\n```\r\nfunc ValidateAddressAndPort(t *testing.T, workingDir string, expectedPort int64) {\r\n\toptions := test_structure.LoadTerraformOptions(t, workingDir)\r\n\r\n\t// Get Output\r\n\toutput := terraform.OutputAll(t, options)\r\n\r\n\t// RDS output\r\n\tresult := output[\"rds\"].(map[string]interface{})\r\n\r\n\t// Variables\r\n\tregion := fmt.Sprintf(\"%v\", result[\"aws_region\"])\r\n\tid := fmt.Sprintf(\"%v\", result[\"id\"])\r\n\r\n\t// Look up the endpoint address and port of the RDS instance\r\n\taddress := aws.GetAddressOfRdsInstance(t, id, region)\r\n\tport := aws.GetPortOfRdsInstance(t, id, region)\r\n\r\n\t// Verify that the address is not null\r\n\tassert.NotNil(t, address)\r\n\r\n\t// Verify that the DB instance is listening on the port mentioned\r\n\tassert.Equal(t, expectedPort, port)\r\n}\r\n```\r\n\r\nI'm getting an error while running says `    rds.go:18: MissingEndpoint: 'Endpoint' configuration is required for this service\r\n`\r\nI've tried using the aws.NewRDSClient but getting same error.. I'm not sure whats going on but maybe something to do with my AWS_PROFILE, I'm not using a default profile\r\n\r\nI'm able to get to AWS via AWS CLI, and terraform can create the resources","bodyHTML":"<p dir=\"auto\">I'm having issues getting terratest to communicate to AWS, it creates the resources via terraform but terratest is says its missing the endpoint configuration</p>\n<p dir=\"auto\">My terraform module creates RDS, my scenario returns the entire RDS object back so I can look into it</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"output &quot;rds&quot; {\n  value = module.main\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">output \"rds\" {\n  value = module.main\n}\n</code></pre></div>\n<p dir=\"auto\">My test looks like the following</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"func Test_Defaults(t *testing.T) {\n\tt.Parallel()\n\n\tworkingDir := &quot;./scenarios/postgres&quot;\n\n\t// At the end of the test, undeploy the web app using Terraform\n\tdefer test_structure.RunTestStage(t, &quot;cleanup_terraform&quot;, func() {\n                // Temporarily commented out to keep resource around while testing verify code\n\t\t// Remove(t, workingDir)\n\t})\n\n\t// Deploy the web app using Terraform\n\ttest_structure.RunTestStage(t, &quot;deploy_terraform&quot;, func() {\n\t\tDeploy(t, workingDir, nil)\n\t})\n\n\ttest_structure.RunTestStage(t, &quot;validate&quot;, func() {\n\t\tValidateAddressAndPort(t, workingDir, 5432)\n\t})\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">func Test_Defaults(t *testing.T) {\n\tt.Parallel()\n\n\tworkingDir := \"./scenarios/postgres\"\n\n\t// At the end of the test, undeploy the web app using Terraform\n\tdefer test_structure.RunTestStage(t, \"cleanup_terraform\", func() {\n                // Temporarily commented out to keep resource around while testing verify code\n\t\t// Remove(t, workingDir)\n\t})\n\n\t// Deploy the web app using Terraform\n\ttest_structure.RunTestStage(t, \"deploy_terraform\", func() {\n\t\tDeploy(t, workingDir, nil)\n\t})\n\n\ttest_structure.RunTestStage(t, \"validate\", func() {\n\t\tValidateAddressAndPort(t, workingDir, 5432)\n\t})\n}\n</code></pre></div>\n<p dir=\"auto\">I am deploying my code with the following</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"func Deploy(t *testing.T, workingDir string, vars map[string]interface{}) {\n\t// Construct the terraform options with default retryable errors to handle the most common retryable errors in\n\t// terraform testing.\n\tterraformOptions := terraform.WithDefaultRetryableErrors(t, &amp;terraform.Options{\n\t\t// The path to where our Terraform code is located\n\t\tTerraformDir: workingDir,\n\n\t\t// Variables to pass to our Terraform code using -var options\n\t\tVars: vars,\n\t})\n\n\t// Save the Terraform Options struct, instance name, and instance text so future test stages can use it\n\ttest_structure.SaveTerraformOptions(t, workingDir, terraformOptions)\n\n\t// This will run `terraform init` and `terraform apply` and fail the test if there are any errors\n\tterraform.InitAndApply(t, terraformOptions)\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">func Deploy(t *testing.T, workingDir string, vars map[string]interface{}) {\n\t// Construct the terraform options with default retryable errors to handle the most common retryable errors in\n\t// terraform testing.\n\tterraformOptions := terraform.WithDefaultRetryableErrors(t, &amp;terraform.Options{\n\t\t// The path to where our Terraform code is located\n\t\tTerraformDir: workingDir,\n\n\t\t// Variables to pass to our Terraform code using -var options\n\t\tVars: vars,\n\t})\n\n\t// Save the Terraform Options struct, instance name, and instance text so future test stages can use it\n\ttest_structure.SaveTerraformOptions(t, workingDir, terraformOptions)\n\n\t// This will run `terraform init` and `terraform apply` and fail the test if there are any errors\n\tterraform.InitAndApply(t, terraformOptions)\n}\n</code></pre></div>\n<p dir=\"auto\">My validate looks like this</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"func ValidateAddressAndPort(t *testing.T, workingDir string, expectedPort int64) {\n\toptions := test_structure.LoadTerraformOptions(t, workingDir)\n\n\t// Get Output\n\toutput := terraform.OutputAll(t, options)\n\n\t// RDS output\n\tresult := output[&quot;rds&quot;].(map[string]interface{})\n\n\t// Variables\n\tregion := fmt.Sprintf(&quot;%v&quot;, result[&quot;aws_region&quot;])\n\tid := fmt.Sprintf(&quot;%v&quot;, result[&quot;id&quot;])\n\n\t// Look up the endpoint address and port of the RDS instance\n\taddress := aws.GetAddressOfRdsInstance(t, id, region)\n\tport := aws.GetPortOfRdsInstance(t, id, region)\n\n\t// Verify that the address is not null\n\tassert.NotNil(t, address)\n\n\t// Verify that the DB instance is listening on the port mentioned\n\tassert.Equal(t, expectedPort, port)\n}\"><pre class=\"notranslate\"><code class=\"notranslate\">func ValidateAddressAndPort(t *testing.T, workingDir string, expectedPort int64) {\n\toptions := test_structure.LoadTerraformOptions(t, workingDir)\n\n\t// Get Output\n\toutput := terraform.OutputAll(t, options)\n\n\t// RDS output\n\tresult := output[\"rds\"].(map[string]interface{})\n\n\t// Variables\n\tregion := fmt.Sprintf(\"%v\", result[\"aws_region\"])\n\tid := fmt.Sprintf(\"%v\", result[\"id\"])\n\n\t// Look up the endpoint address and port of the RDS instance\n\taddress := aws.GetAddressOfRdsInstance(t, id, region)\n\tport := aws.GetPortOfRdsInstance(t, id, region)\n\n\t// Verify that the address is not null\n\tassert.NotNil(t, address)\n\n\t// Verify that the DB instance is listening on the port mentioned\n\tassert.Equal(t, expectedPort, port)\n}\n</code></pre></div>\n<p dir=\"auto\">I'm getting an error while running says <code class=\"notranslate\">   rds.go:18: MissingEndpoint: 'Endpoint' configuration is required for this service</code><br>\nI've tried using the aws.NewRDSClient but getting same error.. I'm not sure whats going on but maybe something to do with my AWS_PROFILE, I'm not using a default profile</p>\n<p dir=\"auto\">I'm able to get to AWS via AWS CLI, and terraform can create the resources</p>","answer":{"body":"I found the issue, region was not in my outputs.. so it was passing in null, was causing issues with the session","bodyHTML":"<p dir=\"auto\">I found the issue, region was not in my outputs.. so it was passing in null, was causing issues with the session</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "6becc3833f2015b4bcd9fd665206f226"
}
##DOCS-SOURCER-END -->
