---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/144" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How do I destroy a module that has errors?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AOh1i","number":144,"author":{"login":"yorinasub17"},"title":"How do I destroy a module that has errors?","body":"I am trying to destroy a module, and am running into an error that is preventing me from destroy that appears to be a code issue. For example:\r\n\r\n```\r\nError: Invalid index\r\n\r\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output \"public_ip\":\r\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\r\n    |----------------\r\n    | aws_eip.instance is empty tuple\r\n\r\nThe given key does not identify an element in this collection value.Error: Invalid index\r\n\r\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output \"public_ip\":\r\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\r\n    |----------------\r\n    | aws_eip.instance is empty tuple\r\n\r\nThe given key does not identify an element in this collection value.\r\n```\r\n\r\nChanging the `attach_eip` input has no effect. Is there anything I can do to destroy the resources in the state?","bodyHTML":"<p dir=\"auto\">I am trying to destroy a module, and am running into an error that is preventing me from destroy that appears to be a code issue. For example:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Error: Invalid index\n\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output &quot;public_ip&quot;:\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\n    |----------------\n    | aws_eip.instance is empty tuple\n\nThe given key does not identify an element in this collection value.Error: Invalid index\n\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output &quot;public_ip&quot;:\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\n    |----------------\n    | aws_eip.instance is empty tuple\n\nThe given key does not identify an element in this collection value.\"><pre class=\"notranslate\"><code class=\"notranslate\">Error: Invalid index\n\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output \"public_ip\":\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\n    |----------------\n    | aws_eip.instance is empty tuple\n\nThe given key does not identify an element in this collection value.Error: Invalid index\n\n  on .terraform/modules/server/modules/single-server/outputs.tf line 10, in output \"public_ip\":\n  10:   value = var.attach_eip ? aws_eip.instance.*.public_ip[0] : aws_instance.instance.public_ip\n    |----------------\n    | aws_eip.instance is empty tuple\n\nThe given key does not identify an element in this collection value.\n</code></pre></div>\n<p dir=\"auto\">Changing the <code class=\"notranslate\">attach_eip</code> input has no effect. Is there anything I can do to destroy the resources in the state?</p>","answer":{"body":"In some cases, you can avoid all code errors in `terraform` and trigger a `destroy` of all resources by creating a new `empty` module:\r\n\r\n- Create a new module called `empty` with a single `main.tf` file that is empty.\r\n- Ensure the `empty` module points to the state file of the module you are trying to destroy\r\n    - If you are using `terragrunt`, update the `terraform.source` attribute in `terragrunt.hcl` to point to the empty module.\r\n    - If you are using `terraform`, update the `empty` module to have a `terraform.backend` config that points to the state file of your original module.\r\n- Now run `terragrunt init && terragrunt plan` (or `terraform init && terraform plan`). If you don't have nested providers (`provider` blocks nested in a terraform `module` call), this should create a valid plan to destroy all the resources. You can now run `terragrunt apply` or `terragrunt destroy` to destroy all the associated resources.","bodyHTML":"<p dir=\"auto\">In some cases, you can avoid all code errors in <code class=\"notranslate\">terraform</code> and trigger a <code class=\"notranslate\">destroy</code> of all resources by creating a new <code class=\"notranslate\">empty</code> module:</p>\n<ul dir=\"auto\">\n<li>Create a new module called <code class=\"notranslate\">empty</code> with a single <code class=\"notranslate\">main.tf</code> file that is empty.</li>\n<li>Ensure the <code class=\"notranslate\">empty</code> module points to the state file of the module you are trying to destroy\n<ul dir=\"auto\">\n<li>If you are using <code class=\"notranslate\">terragrunt</code>, update the <code class=\"notranslate\">terraform.source</code> attribute in <code class=\"notranslate\">terragrunt.hcl</code> to point to the empty module.</li>\n<li>If you are using <code class=\"notranslate\">terraform</code>, update the <code class=\"notranslate\">empty</code> module to have a <code class=\"notranslate\">terraform.backend</code> config that points to the state file of your original module.</li>\n</ul>\n</li>\n<li>Now run <code class=\"notranslate\">terragrunt init &amp;&amp; terragrunt plan</code> (or <code class=\"notranslate\">terraform init &amp;&amp; terraform plan</code>). If you don't have nested providers (<code class=\"notranslate\">provider</code> blocks nested in a terraform <code class=\"notranslate\">module</code> call), this should create a valid plan to destroy all the resources. You can now run <code class=\"notranslate\">terragrunt apply</code> or <code class=\"notranslate\">terragrunt destroy</code> to destroy all the associated resources.</li>\n</ul>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "1c9ba3fb002548fea841234b37993edd"
}
##DOCS-SOURCER-END -->
