---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/215" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Ref Arch - Specified ReservedConcurrentExecutions for function decreases account&apos;s UnreservedConcurrentExecution below its minimum value of [50]</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AO23D","number":215,"author":{"login":"zackproser"},"title":"Ref Arch - Specified ReservedConcurrentExecutions for function decreases account's UnreservedConcurrentExecution below its minimum value of [50]","body":"A customer asked: \r\n> When attempting to run `terragrunt run-all apply` on the Ref Arch, I'm getting the following error message. What does it mean and how can I fix it? \r\n\r\n```\r\n╷\r\n│ Error: error setting Lambda Function (cleanup-expired-iam-certs) concurrency: InvalidParameterValueException: Specified ReservedConcurrentExecutions for function decreases account's Unreser\r\nvedConcurrentExecution below its minimum value of [50].\r\n│ {\r\n│   RespMetadata: {\r\n│     StatusCode: 400,\r\n│     RequestID: \"c9f4bdee-fd4e-461f-a20a-38ce05bf6862\"\r\n│   },\r\n│   Message_: \"Specified ReservedConcurrentExecutions for function decreases account's UnreservedConcurrentExecution below its minimum value of [50].\"\r\n│ }\r\n│ \r\n│   with module.cleanup_expired_iam_certs.module.cleanup_expired_iam_certs.aws_lambda_function.function[0],\r\n│   on .terraform/modules/cleanup_expired_iam_certs.cleanup_expired_iam_certs/modules/lambda/main.tf line 35, in resource \"aws_lambda_function\" \"function\":\r\n│   35: resource \"aws_lambda_function\" \"function\" {\r\n│\r\n```","bodyHTML":"<p dir=\"auto\">A customer asked:</p>\n<blockquote>\n<p dir=\"auto\">When attempting to run <code class=\"notranslate\">terragrunt run-all apply</code> on the Ref Arch, I'm getting the following error message. What does it mean and how can I fix it?</p>\n</blockquote>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"╷\n│ Error: error setting Lambda Function (cleanup-expired-iam-certs) concurrency: InvalidParameterValueException: Specified ReservedConcurrentExecutions for function decreases account's Unreser\nvedConcurrentExecution below its minimum value of [50].\n│ {\n│   RespMetadata: {\n│     StatusCode: 400,\n│     RequestID: &quot;c9f4bdee-fd4e-461f-a20a-38ce05bf6862&quot;\n│   },\n│   Message_: &quot;Specified ReservedConcurrentExecutions for function decreases account's UnreservedConcurrentExecution below its minimum value of [50].&quot;\n│ }\n│ \n│   with module.cleanup_expired_iam_certs.module.cleanup_expired_iam_certs.aws_lambda_function.function[0],\n│   on .terraform/modules/cleanup_expired_iam_certs.cleanup_expired_iam_certs/modules/lambda/main.tf line 35, in resource &quot;aws_lambda_function&quot; &quot;function&quot;:\n│   35: resource &quot;aws_lambda_function&quot; &quot;function&quot; {\n│\"><pre class=\"notranslate\"><code class=\"notranslate\">╷\n│ Error: error setting Lambda Function (cleanup-expired-iam-certs) concurrency: InvalidParameterValueException: Specified ReservedConcurrentExecutions for function decreases account's Unreser\nvedConcurrentExecution below its minimum value of [50].\n│ {\n│   RespMetadata: {\n│     StatusCode: 400,\n│     RequestID: \"c9f4bdee-fd4e-461f-a20a-38ce05bf6862\"\n│   },\n│   Message_: \"Specified ReservedConcurrentExecutions for function decreases account's UnreservedConcurrentExecution below its minimum value of [50].\"\n│ }\n│ \n│   with module.cleanup_expired_iam_certs.module.cleanup_expired_iam_certs.aws_lambda_function.function[0],\n│   on .terraform/modules/cleanup_expired_iam_certs.cleanup_expired_iam_certs/modules/lambda/main.tf line 35, in resource \"aws_lambda_function\" \"function\":\n│   35: resource \"aws_lambda_function\" \"function\" {\n│\n</code></pre></div>","answer":{"body":"This error message is stating that the target AWS account's reserved concurrency setting is currently `50`, which is quite low. \r\n\r\nThe[ default value for `Concurrent executions` is usually 1,000](https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html), but for new AWS accounts, such as the ones we require for a Gruntwork Reference Architecture deployment, AWS will often throttle this down to `50`. \r\n\r\nUnfortunately, this is too low of a value to allow the lambda function we include in CIS Reference Architectures, which is tasked with cleaning up expired IAM certificates. In order to fix this error and unblock your `terragrunt run-all apply`, you'll need to request a service quota increase from AWS, within the account that is returning this error message. \r\n\r\nYou can find the quotas console by logging into the AWS console and searching for \"Service quotas\". Next look for Lambda quotas and then finally find the `Concurrent executions` quota and request that its value be raised to 1,000. \r\n\r\nNote that, if you are receiving this error message need to do this in all AWS accounts you provisioned for the Gruntwork Reference Architecture. \r\n\r\nNote that the amount of time it takes AWS to see and (hopefully) grant your quota increase request can vary from a few hours to several days, and Gruntwork unfortunately has no ability to influence or speed up this process, as it's a limit imposed at the AWS account level. ","bodyHTML":"<p dir=\"auto\">This error message is stating that the target AWS account's reserved concurrency setting is currently <code class=\"notranslate\">50</code>, which is quite low.</p>\n<p dir=\"auto\">The<a href=\"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html\" rel=\"nofollow\"> default value for <code class=\"notranslate\">Concurrent executions</code> is usually 1,000</a>, but for new AWS accounts, such as the ones we require for a Gruntwork Reference Architecture deployment, AWS will often throttle this down to <code class=\"notranslate\">50</code>.</p>\n<p dir=\"auto\">Unfortunately, this is too low of a value to allow the lambda function we include in CIS Reference Architectures, which is tasked with cleaning up expired IAM certificates. In order to fix this error and unblock your <code class=\"notranslate\">terragrunt run-all apply</code>, you'll need to request a service quota increase from AWS, within the account that is returning this error message.</p>\n<p dir=\"auto\">You can find the quotas console by logging into the AWS console and searching for \"Service quotas\". Next look for Lambda quotas and then finally find the <code class=\"notranslate\">Concurrent executions</code> quota and request that its value be raised to 1,000.</p>\n<p dir=\"auto\">Note that, if you are receiving this error message need to do this in all AWS accounts you provisioned for the Gruntwork Reference Architecture.</p>\n<p dir=\"auto\">Note that the amount of time it takes AWS to see and (hopefully) grant your quota increase request can vary from a few hours to several days, and Gruntwork unfortunately has no ability to influence or speed up this process, as it's a limit imposed at the AWS account level.</p>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "1c574e44151ee06db5ffe9bf461ed841"
}
##DOCS-SOURCER-END -->
