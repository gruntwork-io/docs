---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/475" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>Reference Architecture: Gruntwork Pipelines on ECS Fargate?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AP1fD","number":475,"author":{"login":"iantybo"},"title":"Reference Architecture: Gruntwork Pipelines on ECS Fargate?","body":"\nIs it possible to launch my Reference Architecture's Gruntwork Pipelines on ECS Fargate? I see it is an `m5.2xl` and my company only does a few Terraform runs a week. If it's not, is it easy to switch once Gruntwork has given me the code?\n\n---\n\n<ins datetime=\"2022-06-16T18:27:06Z\">\n  <p><a href=\"https://support.gruntwork.io/hc/requests/108793\">Tracked in ticket #108793</a></p>\n</ins>\n","bodyHTML":"<p dir=\"auto\">Is it possible to launch my Reference Architecture's Gruntwork Pipelines on ECS Fargate? I see it is an <code class=\"notranslate\">m5.2xl</code> and my company only does a few Terraform runs a week. If it's not, is it easy to switch once Gruntwork has given me the code?</p>\n<hr>\n<ins datetime=\"2022-06-16T18:27:06Z\">\n  <p dir=\"auto\"><a href=\"https://support.gruntwork.io/hc/requests/108793\" rel=\"nofollow\">Tracked in ticket #108793</a></p>\n</ins>","answer":{"body":"Yes you can use Fargate for the ECS Deploy Runner in the Reference Architecture. We set up the Reference Architecture with EC2 instances in the initial deployment due to the number of resources that need to be deployed, but after the Reference Architecture is deployed, you can switch over to Fargate provided that you are only making incremental updates to handful of resources at a time.\r\n\r\nTo switch over to Fargate mode, you can perform the following steps:\r\n\r\n- Remove the `ec2_worker_pool_configuration` block in [the _envcommon/mgmt/ecs-deploy-runner.hcl file](https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/d66801d971c9bf79b630c319f5668161688c252a/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L195-L211)\r\n- Run `terragrunt apply` in each accounts' `ecs-deploy-runner` folder. Note that you will want to run `terragrunt apply` twice due to a bug in Terraform where it does not properly replace the ECS Cluster in a single `apply` when switching from EC2 based to Fargate based.","bodyHTML":"<p dir=\"auto\">Yes you can use Fargate for the ECS Deploy Runner in the Reference Architecture. We set up the Reference Architecture with EC2 instances in the initial deployment due to the number of resources that need to be deployed, but after the Reference Architecture is deployed, you can switch over to Fargate provided that you are only making incremental updates to handful of resources at a time.</p>\n<p dir=\"auto\">To switch over to Fargate mode, you can perform the following steps:</p>\n<ul dir=\"auto\">\n<li>Remove the <code class=\"notranslate\">ec2_worker_pool_configuration</code> block in <a href=\"https://github.com/gruntwork-io/terraform-aws-service-catalog/blob/d66801d971c9bf79b630c319f5668161688c252a/examples/for-production/infrastructure-live/_envcommon/mgmt/ecs-deploy-runner.hcl#L195-L211\">the _envcommon/mgmt/ecs-deploy-runner.hcl file</a></li>\n<li>Run <code class=\"notranslate\">terragrunt apply</code> in each accounts' <code class=\"notranslate\">ecs-deploy-runner</code> folder. Note that you will want to run <code class=\"notranslate\">terragrunt apply</code> twice due to a bug in Terraform where it does not properly replace the ECS Cluster in a single <code class=\"notranslate\">apply</code> when switching from EC2 based to Fargate based.</li>\n</ul>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "d1670f827ce8603d619b53ed9f8943d3"
}
##DOCS-SOURCER-END -->
