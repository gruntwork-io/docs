---
hide_table_of_contents: true
hide_title: true
custom_edit_url: null
---

import CenterLayout from "/src/components/CenterLayout"
import GitHub from "/src/components/GitHub"

<head>
  <link rel="canonical" href="https://github.com/gruntwork-io/knowledge-base/discussions/45" />
</head>

<CenterLayout>
<span className="searchCategory">Knowledge Base</span>
<h1>How do I rebuild the Elastic Deploy Runner (EDR) and Kaniko Images for Gruntwork Pipelines?</h1>
<GitHub discussion={{"id":"D_kwDOF8slf84AN-XU","number":45,"author":{"login":"zackproser"},"title":"How do I rebuild the Elastic Deploy Runner (EDR) and Kaniko Images for Gruntwork Pipelines?","body":"A customer asked, \"How can I rebuild the Docker images for Elastic Deploy Runner (EDR) and Kaniko?\"\r\n\r\n","bodyHTML":"<p dir=\"auto\">A customer asked, \"How can I rebuild the Docker images for Elastic Deploy Runner (EDR) and Kaniko?\"</p>","answer":{"body":"1. Git clone `terraform-aws-ci`: `git clone git@github.com:gruntwork-io/terraform-aws-ci.git`\r\n1. In `terraform-aws-ci`, checkout the version to use (might as well update to latest while you are at it, which is `git checkout v0.39.3`)\r\n1. Switch dir to the `ecs-deploy-runner` docker folder: `cd modules/ecs-deploy-runner/docker/deploy-runner`\r\n1. Run docker build to build the image, passing the vars: `docker build --build-arg GITHUB_OAUTH_TOKEN --tag 241595741642.dkr.ecr.us-east-1.amazonaws.com/ecs-deploy-runner:v0.39.3 --build-arg terraform_version=1.0.4 --build-arg terragrunt_version=v0.31.8` .\r\n    - NOTE: If you are running on an M1 mac, you must pass in the `--platform=linux/amd64` argument to build an amd64 based image instead of an arm64 based image.\r\n1. Authenticate to ECR: `aws ecr get-login-password --region \"us-west-2\"  | docker login --username AWS --password-stdin 241595741642.dkr.ecr.us-east-1.amazonaws.com`\r\n1. Push the image: `docker push 241595741642.dkr.ecr.us-east-1.amazonaws.com/ecs-deploy-runner:v0.39.3`\r\n1. Repeat for the kaniko folder: `cd modules/ecs-deploy-runner/docker/kaniko and run docker build --build-arg GITHUB_OAUTH_TOKEN --tag 241595741642.dkr.ecr.us-east-1.amazonaws.com/kaniko:v0.39.3 .`\r\n1. Update the image tags to v0.39.3 in common.hcl\r\n1. Deploy the new image by running `terragrunt apply` in each accounts’ `ecs-deploy-runner` folder.","bodyHTML":"<ol dir=\"auto\">\n<li>Git clone <code class=\"notranslate\">terraform-aws-ci</code>: <code class=\"notranslate\">git clone git@github.com:gruntwork-io/terraform-aws-ci.git</code></li>\n<li>In <code class=\"notranslate\">terraform-aws-ci</code>, checkout the version to use (might as well update to latest while you are at it, which is <code class=\"notranslate\">git checkout v0.39.3</code>)</li>\n<li>Switch dir to the <code class=\"notranslate\">ecs-deploy-runner</code> docker folder: <code class=\"notranslate\">cd modules/ecs-deploy-runner/docker/deploy-runner</code></li>\n<li>Run docker build to build the image, passing the vars: <code class=\"notranslate\">docker build --build-arg GITHUB_OAUTH_TOKEN --tag 241595741642.dkr.ecr.us-east-1.amazonaws.com/ecs-deploy-runner:v0.39.3 --build-arg terraform_version=1.0.4 --build-arg terragrunt_version=v0.31.8</code> .\n<ul dir=\"auto\">\n<li>NOTE: If you are running on an M1 mac, you must pass in the <code class=\"notranslate\">--platform=linux/amd64</code> argument to build an amd64 based image instead of an arm64 based image.</li>\n</ul>\n</li>\n<li>Authenticate to ECR: <code class=\"notranslate\">aws ecr get-login-password --region \"us-west-2\"  | docker login --username AWS --password-stdin 241595741642.dkr.ecr.us-east-1.amazonaws.com</code></li>\n<li>Push the image: <code class=\"notranslate\">docker push 241595741642.dkr.ecr.us-east-1.amazonaws.com/ecs-deploy-runner:v0.39.3</code></li>\n<li>Repeat for the kaniko folder: <code class=\"notranslate\">cd modules/ecs-deploy-runner/docker/kaniko and run docker build --build-arg GITHUB_OAUTH_TOKEN --tag 241595741642.dkr.ecr.us-east-1.amazonaws.com/kaniko:v0.39.3 .</code></li>\n<li>Update the image tags to v0.39.3 in common.hcl</li>\n<li>Deploy the new image by running <code class=\"notranslate\">terragrunt apply</code> in each accounts’ <code class=\"notranslate\">ecs-deploy-runner</code> folder.</li>\n</ol>"}}} />

</CenterLayout>

<!-- ##DOCS-SOURCER-START
{
  "sourcePlugin": "github-discussions",
  "hash": "051a945ea6bb44308c466cf183225203"
}
##DOCS-SOURCER-END -->
