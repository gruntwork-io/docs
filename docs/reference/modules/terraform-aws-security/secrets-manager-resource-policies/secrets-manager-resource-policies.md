---
title: "Resource-based policies for Secrets Manager secrets"
hide_title: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import VersionBadge from '../../../../../src/components/VersionBadge.tsx';
import { HclListItem, HclListItemDescription, HclListItemTypeDetails, HclListItemDefaultValue, HclGeneralListItem } from '../../../../../src/components/HclListItem.tsx';
import { ModuleUsage } from "../../../../../src/components/ModuleUsage";

<VersionBadge repoTitle="Security Modules" version="0.69.3" lastModifiedVersion="0.69.2"/>

# Resource-based policies for Secrets Manager secrets

<a href="https://github.com/gruntwork-io/terraform-aws-security/tree/v0.69.3/modules/secrets-manager-resource-policies" className="link-button" title="View the source code for this module in GitHub.">View Source</a>

<a href="https://github.com/gruntwork-io/terraform-aws-security/releases/tag/v0.69.2" className="link-button" title="Release notes for only versions which impacted this module.">Release Notes</a>

This module manages [resource-based policies on AWS Secrets Manager secrets](https://docs.aws.amazon.com/secretsmanager/latest/userguide/auth-and-access_resource-based-policies.html).

The module accepts a `secret_policies` variable containing a map of objects containing the ARN and a few options for customizing the resource-based policy. These options include:

1.  To provide read only access to the secret value (e.g. the `secretsmanager:GetSecretValue` IAM action), use the `iam_entities_with_read_access` attribute.
2.  To provide full access to the secret value (e.g. `secretsmanager:*` IAM actions), use the `iam_entities_with_full_access` attribute.
3.  If neither of these canned options are desired, use the `policy_statement_json` attribute to provide a completely custom policy. The value should be a JSON string generated by the [`aws_iam_policy_document` data source](https://www.terraform.io/docs/providers/aws/d/iam_policy_document.html).

Note that `iam_entities_with_read_access` and `iam_entities_with_full_access` are convenient shortcuts. They are mutually exclusive with `policy_statement_json`, which gives you full control over the policy. If the latter is provided, the former will be ignored.

Note also that you should only manage the policy for any given secret one time. That is, do not pass the same `arn` value more than once. Doing so will result in an non-deterministic policy on that secret.

## Sample Usage

<Tabs>
<TabItem value="terraform" label="Terraform" default>

```hcl title="main.tf"

# ------------------------------------------------------------------------------------------------------
# DEPLOY GRUNTWORK'S SECRETS-MANAGER-RESOURCE-POLICIES MODULE
# ------------------------------------------------------------------------------------------------------

module "secrets_manager_resource_policies" {

  source = "git::git@github.com:gruntwork-io/terraform-aws-security.git//modules/secrets-manager-resource-policies?ref=v0.69.3"

  # ----------------------------------------------------------------------------------------------------
  # REQUIRED VARIABLES
  # ----------------------------------------------------------------------------------------------------

  secret_policies = <map(object(
    arn = string

    iam_entities_with_read_access = list(string)
    iam_entities_with_full_access = list(string)
    policy_statement_json = string
  ))>

}


```

</TabItem>
<TabItem value="terragrunt" label="Terragrunt" default>

```hcl title="terragrunt.hcl"

# ------------------------------------------------------------------------------------------------------
# DEPLOY GRUNTWORK'S SECRETS-MANAGER-RESOURCE-POLICIES MODULE
# ------------------------------------------------------------------------------------------------------

terraform {
  source = "git::git@github.com:gruntwork-io/terraform-aws-security.git//modules/secrets-manager-resource-policies?ref=v0.69.3"
}

inputs = {

  # ----------------------------------------------------------------------------------------------------
  # REQUIRED VARIABLES
  # ----------------------------------------------------------------------------------------------------

  secret_policies = <map(object(
    arn = string

    iam_entities_with_read_access = list(string)
    iam_entities_with_full_access = list(string)
    policy_statement_json = string
  ))>

}


```

</TabItem>
</Tabs>


<!-- ##DOCS-SOURCER-START
{
  "originalSources": [
    "https://github.com/gruntwork-io/terraform-aws-security/tree/v0.69.3/modules/secrets-manager-resource-policies/readme.md",
    "https://github.com/gruntwork-io/terraform-aws-security/tree/v0.69.3/modules/secrets-manager-resource-policies/variables.tf",
    "https://github.com/gruntwork-io/terraform-aws-security/tree/v0.69.3/modules/secrets-manager-resource-policies/outputs.tf"
  ],
  "sourcePlugin": "module-catalog-api",
  "hash": "072a859a8ff82fb747b471ba0f9cd11e"
}
##DOCS-SOURCER-END -->
